(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e){e.exports={BACKEND_URL:"https://api.wbeyer.com",DATA_SOURCES:[{name:"snp1kg-BRCA1",xgFile:"snp1kg-BRCA1.vg.xg",gamFile:"NA12878-BRCA1.sorted.gam",anchorTrackName:"17",useMountedPath:!1,defaultPosition:"1"},{name:"cactus",xgFile:"cactus.vg.xg",gamFile:"cactus-NA12879.sorted.gam",anchorTrackName:"ref",useMountedPath:!1,defaultPosition:"1"},{name:'vg "small" example',xgFile:"x.vg.xg",gbwtFile:"x.vg.gbwt",anchorTrackName:"x",useMountedPath:!1,defaultPosition:"1"},{name:"Human Chromosome 1",xgFile:"chr1.xg",gbwtFile:"snp1kg_1.gbwt",gamFile:"chunk_0_1_0_249250620.sorted.gam",anchorTrackName:"1",useMountedPath:!0,defaultPosition:"20000"}],vgPath:"",dataPath:"./exampleData/",internalDataPath:"./exampleData/"}},33:function(e,t,n){e.exports=n(46)},40:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var a,r,o,s,i,c,l,d,h,p,u,f,g,m=n(1),y=n.n(m),b=n(18),w=n.n(b),v=(n(38),n(17)),E=n(25),x=n(8),S=n(9),O=n(11),k=n(10),F=n(12),C=(n(40),n(16)),N=n.n(C),I=n(20),P=n(4),q={API:"API",EXAMPLE_1:"example 1",EXAMPLE_2:"example 2",EXAMPLE_3:"example 3",EXAMPLE_4:"example 4",EXAMPLE_5:"example 5",EXAMPLE_6:"example 6"},L=n(19),M=n(21),D=n(22),A=n(5),R=(n(47),!1),T=["#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],j=["#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],U=["#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],_=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],B=["#ABCCE3","#FFCFA5","#B0DBB0","#F0AEAE","#D7C6E6","#C6ABA5","#F4CCE8","#CFCFCF","#E6E6AC","#A8E7ED"],z=[],H=[],X=[],W=[],G=[],Y=[],J=[],V=[],Q=[],Z=[],K={mergeNodesFlag:!0,clickableNodesFlag:!1,showExonsFlag:!1,colorScheme:0,nodeWidthOption:0,showReads:!0,showSoftClips:!0,haplotypeColors:"greys",forwardReadColors:"reds",reverseReadColors:"blues",exonColors:"lightColors",hideLegendFlag:!1},$=[],ee=[],te=[],ne=[],ae=[],re=0,oe=0,se=0;function ie(e){Y.unshift(Y[e]),Y.splice(e+1,1),function(e){var t,n,a,r,o=[];for(a=Y[e].sequence,t=0;t<a.length;t+=1)"-"===a[t].charAt(0)&&(r=a[t].substr(1),(-1===a.indexOf(r)||a.indexOf(r)>t)&&o.push(a[t].substr(1)));for(t=0;t<Y.length;t+=1)for(a=Y[t].sequence,n=0;n<a.length;n+=1)"-"!==a[n].charAt(0)?-1!==o.indexOf(a[n])&&(a[n]="-".concat(a[n])):-1!==o.indexOf(a[n].substr(1))&&(a[n]=a[n].substr(1));G.forEach(function(e){-1!==o.indexOf(e.name)&&(e.seq=e.seq.split("").reverse().join(""))})}(0)}function ce(e,t){if(K[e]!==t){K[e]=t;de();K.hideLegendFlag||Ge()}}function le(e){0!==e&&1!==e&&2!==e||K.nodeWidthOption!==e&&(K.nodeWidthOption=e,void 0!==r&&(r=A.b(a),de()))}function de(){if($=[],ee=[],te=[],ne=[],ae=[],V=[],Q=[],Z=[],re=0,oe=0,se=0,f=void 0,(r=A.b(a)).selectAll("*").remove(),s=JSON.parse(JSON.stringify(G)),i=JSON.parse(JSON.stringify(Y)),c=JSON.parse(JSON.stringify(J)),0!==s.length&&0!==i.length){z=De(K.haplotypeColors),H=De(K.forwardReadColors),X=De(K.reverseReadColors),W=De(K.exonColors);for(var e=i.length-1;e>=0;e-=1)i[e].hasOwnProperty("type")||(i[e].type="haplo"),i[e].hasOwnProperty("hidden")&&!0===i[e].hidden&&i.splice(e,1),i[e].hasOwnProperty("indexOfFirstBase")&&(f=i[e].name);h=Ee(),we(i),c&&K.showReads&&we(c),et(),c&&(xe(),Oe(),K.showReads&&ye(),K.mergeNodesFlag&&function(){for(var e,t,n,a=[],r=[],o=0;o<s.length;o+=1)a.push(new Set),r.push(new Set);n=c&&K.showReads?i.concat(c):i;n.forEach(function(n){for(var o=0;o<n.sequence.length;o+=1)"-"!==n.sequence[o].charAt(0)?(o>0?(e=n.sequence[o-1],a[h.get(n.sequence[o])].add(e),"-"===e.charAt(0)&&a[h.get(n.sequence[o])].add(e.substr(1))):"haplo"===n.type&&a[h.get(n.sequence[o])].add("None"),o<n.sequence.length-1?(e=n.sequence[o+1],r[h.get(n.sequence[o])].add(e),"-"===e.charAt(0)&&r[h.get(n.sequence[o])].add(e.substr(1))):"haplo"===n.type&&r[h.get(n.sequence[o])].add("None")):(e=n.sequence[o].substr(1),o>0?"-"===(t=n.sequence[o-1]).charAt(0)?r[h.get(e)].add(t.substr(1)):(r[h.get(e)].add(t),r[h.get(e)].add("-".concat(t))):"haplo"===n.type&&r[h.get(e)].add("None"),o<n.sequence.length-1?"-"===(t=n.sequence[o+1]).charAt(0)?a[h.get(e)].add(t.substr(1)):(a[h.get(e)].add(t),a[h.get(e)].add("-".concat(t))):"haplo"===n.type&&a[h.get(e)].add("None"))});for(var l=0;l<s.length;l+=1)r[l]=Array.from(r[l]),a[l]=Array.from(a[l]);if(c&&K.showReads){var d=s.slice();d.sort(Me);var p=new Map,u=new Map;d.forEach(function(e){var t=at(h.get(e.name),a,r);t?(p.set(e.name,p.get(t)+s[h.get(t)].sequenceLength),u.set(e.name,u.get(t))):(p.set(e.name,0),u.set(e.name,e.name))}),c.forEach(function(e){e.firstNodeOffset+=p.get(e.sequence[0]),e.finalNodeCoverLength+=p.get(e.sequence[e.sequence.length-1]);for(var t=e.sequence.length-1;t>=0;t-=1)at(h.get(e.sequence[t]),a,r)&&function(){var n=at(h.get(e.sequence[t]),a,r);rt(h.get(n),a,r)&&(t>0?(e.sequence.splice(t,1),e.sequenceNew[t].mismatches.forEach(function(e){e.pos+=s[h.get(n)].sequenceLength}),e.sequenceNew[t-1].mismatches=e.sequenceNew[t-1].mismatches.concat(e.sequenceNew[t].mismatches),e.sequenceNew.splice(t,1)):(e.sequence[0]=u.get(e.sequence[0]),e.sequenceNew[t].mismatches.forEach(function(t){t.pos+=p.get(e.sequenceNew[0].nodeName)}),e.sequenceNew[0].nodeName=u.get(e.sequenceNew[0].nodeName)))}()})}for(var f=0;f<s.length;f+=1)if(rt(f,a,r)&&!at(f,a,r))for(var g=f;rt(g,a,r);)"-"===(g=r[g][0]).charAt(0)&&(g=g.substr(1)),g=h.get(g),s[f].hasOwnProperty("sequenceLength")?s[f].sequenceLength+=s[g].sequenceLength:s[f].width+=s[g].width,s[f].seq+=s[g].seq;i.forEach(function(t){for(var n=t.sequence.length-1;n>=0;n-=1){"-"===(e=t.sequence[n]).charAt(0)&&(e=e.substr(1));var o=h.get(e);at(o,a,r)&&t.sequence.splice(n,1)}});for(var m=s.length-1;m>=0;m-=1)at(m,a,r)&&s.splice(m,1)}(),h=Ee(),et(),we(i),K.showReads&&we(c)),l=s.length,d=i.length,xe(),s.forEach(function(e){e.tracks=[]}),i.forEach(function(e){e.indexSequence.forEach(function(t){s[Math.abs(t)].tracks.push(e.id)})}),s.forEach(function(e){e.hasOwnProperty("tracks")&&(e.degree=e.tracks.length)}),R&&console.log("".concat(l," nodes.")),Oe(),u=function(){var e=-1;return s.forEach(function(t){t.hasOwnProperty("order")&&t.order>e&&(e=t.order)}),e}(),function(){var e=!0;i.forEach(function(t){t.hasOwnProperty("freq")?t.width=Math.round(4*(Math.log(t.freq)+1)):(t.width=15,t.hasOwnProperty("type")&&"read"===t.type&&(t.width=4)),4!==t.width&&(e=!1)}),e&&i.forEach(function(e){e.hasOwnProperty("freq")&&(e.width=15)})}(),function(){for(var e,t,n,a,r,o,c=[],l=function(e){return((e=+e)||1/e)>=0},h=0;h<=u;h+=1){V[h]=[],c[h]=[];for(var p=0;p<d;p+=1)c[h][p]=null}i.forEach(function(i,d){t=Math.abs(i.indexSequence[0]),n=l(i.indexSequence[0]),a=s[t],i.path=[],i.path.push({order:a.order,lane:null,isForward:n,node:t}),Ie(a.order,t,d,0,c),e=1;for(var h=1;h<i.sequence.length;h+=1)if(r=a,o=n,t=Math.abs(i.indexSequence[h]),n=l(i.indexSequence[h]),(a=s[t]).order>r.order){o||(i.path.push({order:r.order,lane:null,isForward:!0,node:null}),Ie(r.order,null,d,e,c),e+=1);for(var p=r.order+1;p<a.order;p+=1)i.path.push({order:p,lane:null,isForward:!0,node:null}),Ie(p,null,d,e,c),e+=1;n?(i.path.push({order:a.order,lane:null,isForward:!0,node:t}),Ie(a.order,t,d,e,c),e+=1):(i.path.push({order:a.order,lane:null,isForward:!0,node:null}),Ie(a.order,null,d,e,c),e+=1,i.path.push({order:a.order,lane:null,isForward:!1,node:t}),Ie(a.order,t,d,e,c),e+=1)}else if(a.order<r.order){o&&(i.path.push({order:r.order,lane:null,isForward:!1,node:null}),Ie(r.order,null,d,e,c),e+=1);for(var u=r.order-1;u>a.order;u-=1)i.path.push({order:u,lane:null,isForward:!1,node:null}),Ie(u,null,d,e,c),e+=1;n?(i.path.push({order:a.order,lane:null,isForward:!1,node:null}),Ie(a.order,null,d,e,c),e+=1,i.path.push({order:a.order,lane:null,isForward:!0,node:t}),Ie(a.order,t,d,e,c),e+=1):(i.path.push({order:a.order,lane:null,isForward:!1,node:t}),Ie(a.order,t,d,e,c),e+=1)}else n!==o?(i.path.push({order:a.order,lane:null,isForward:n,node:t}),Ie(a.order,t,d,e,c),e+=1):(i.path.push({order:a.order,lane:null,isForward:!n,node:null}),Ie(a.order,null,d,e,c),e+=1,i.path.push({order:a.order,lane:null,isForward:n,node:t}),Ie(a.order,t,d,e,c),e+=1)});for(var f=0;f<=u;f+=1)Pe(V[f],f)}(),!0===K.showExonsFlag&&null!==g&&function(){var e,t,n={};g.forEach(function(a){for(var r=0;r<d&&i[r].name!==a.track;)r+=1;r<d&&(e=0,i[r].path.forEach(function(r){null!==r.node&&(n={},t=s[r.node].hasOwnProperty("sequenceLength")?e+s[r.node].sequenceLength-1:e+s[r.node].width-1,e>=a.start&&e<=a.end&&(n.start=0),e<a.start&&t>=a.start&&(n.start=a.start-e),t<=a.end&&t>=a.start&&(n.end=t-e,t<a.end&&(n.continue=!0)),t>a.end&&e<=a.end&&(n.end=a.end-e),n.hasOwnProperty("start")&&(n.type=a.type,n.name=a.name,r.hasOwnProperty("features")||(r.features=[]),r.features.push(n)),e=t+1)}))})}(),function(){var e=0,t=20,n=-1,a=s.slice();a.sort(Me);var r=function(){for(var e=[],t=[],n=[],a=0;a<=u;a+=1)e.push(0),t.push(0);i.forEach(function(n){for(var a=1;a<n.path.length;a+=1)n.path[a].order===n.path[a-1].order&&(!0===n.path[a].isForward?e[n.path[a].order]+=1:t[n.path[a].order]+=1)}),n.push(Math.max(0,e[0]-1));for(var r=1;r<=u;r+=1)n.push(Math.max(0,e[r]-1)+Math.max(0,t[r-1]-1));return n}();a.forEach(function(a){a.hasOwnProperty("order")&&(a.order>n&&(n=a.order,e=t+10*r[a.order]),a.x=e,t=Math.max(t,e+40+a.pixelWidth))})}(),c&&K.showReads&&(!function(){p=[];for(var e=0;e<=u;e+=1)p[e]=[];var t=new Map;s.forEach(function(e){e.hasOwnProperty("order")&&e.hasOwnProperty("y")&&he(t,e.order,e.y+e.contentHeight)}),i.forEach(function(e){"haplo"===e.type&&e.path.forEach(function(n){he(t,n.order,n.y+e.width)})}),s.forEach(function(e,n){e.hasOwnProperty("order")&&!e.hasOwnProperty("y")&&(e.y=t.get(e.order)+25,e.contentHeight=0,p[e.order].push(n))})}(),ye(),we(c),function(){(function(){var e,t,n,a,r,o=function(e){return((e=+e)||1/e)>=0};c.forEach(function(i){e=Math.abs(i.indexSequence[0]),t=o(i.indexSequence[0]),n=s[e],i.path=[],i.path.push({order:n.order,isForward:t,node:e});for(var c=1;c<i.sequence.length;c+=1)if(a=n,r=t,e=Math.abs(i.indexSequence[c]),t=o(i.indexSequence[c]),(n=s[e]).order>a.order){r||i.path.push({order:a.order,isForward:!0,node:null});for(var l=a.order+1;l<n.order;l+=1)i.path.push({order:l,isForward:!0,node:null});t?i.path.push({order:n.order,isForward:!0,node:e}):(i.path.push({order:n.order,isForward:!0,node:null}),i.path.push({order:n.order,isForward:!1,node:e}))}else if(n.order<a.order){r&&i.path.push({order:a.order,isForward:!1,node:null});for(var d=a.order-1;d>n.order;d-=1)i.path.push({order:d,isForward:!1,node:null});t?(i.path.push({order:n.order,isForward:!1,node:null}),i.path.push({order:n.order,isForward:!0,node:e})):i.path.push({order:n.order,isForward:!1,node:e})}else t!==r?i.path.push({order:n.order,isForward:t,node:e}):(i.path.push({order:n.order,isForward:!t,node:null}),i.path.push({order:n.order,isForward:t,node:e}))})})(),s.forEach(function(e){e.incomingReads=[],e.outgoingReads=[],e.internalReads=[]}),c.forEach(function(e,t){e.width=7,1===e.path.length?s[e.path[0].node].internalReads.push(t):e.path.forEach(function(n,a){0===a?s[e.path[0].node].outgoingReads.push([t,a]):null!==e.path[a].node&&s[e.path[a].node].incomingReads.push([t,a])})});var e=s.slice();e.sort(Me),e.forEach(function(e){e.incomingReads.sort(ge);var t=e.y+e.contentHeight,n=new Map;e.incomingReads.forEach(function(a){c[a[0]].path[a[1]].y=t,pe(n,c[a[0]],a[1],t,e),t+=7});var a=t;e.outgoingReads.sort(fe);var r=new Map;t=e.y+e.contentHeight,e.outgoingReads.forEach(function(o){c[o[0]].path[o[1]].y=t,r.set(t,c[o[0]].firstNodeOffset),!n.has(t)||n.get(t)+1<c[o[0]].firstNodeOffset?(t+=7,a=Math.max(a,t)):(n.set(t,0),e.incomingReads.forEach(function(a){var r=c[a[0]],o=r.path[a[1]];o.y>=t&&(o.y+=7,pe(n,r,a[1],o.y,e))}),t+=7,a+=7)}),e.internalReads.sort(me),e.internalReads.forEach(function(o){var s=c[o];for(t=e.y+e.contentHeight;s.firstNodeOffset<n.get(t)+2||s.finalNodeCoverLength>r.get(t)-3;)t+=7;s.path[0].y=t,n.set(t,s.finalNodeCoverLength),a=Math.max(a,t)});var o=a-e.y-e.contentHeight;e.contentHeight+=o,function(e,t){e.hasOwnProperty("order")&&(V[e.order].forEach(function(n){if(null!==n.node){var a=s[n.node];a!==e&&a.y>e.y&&(a.y+=t,n.tracks.forEach(function(e){i[e.trackID].path[e.segmentID].y+=t}))}else n.tracks.forEach(function(n){i[n.trackID].path[n.segmentID].y>=e.y&&(i[n.trackID].path[n.segmentID].y+=t)})}),p[e.order].length>0&&p[e.order].forEach(function(n){s[n]!==e&&s[n].y>e.y&&(s[n].y+=t)}))}(e,o)});var t=function(){for(var e=[],t=0;t<=u;t+=1)e.push(0);return s.forEach(function(t){e[t.order]=Math.max(e[t.order],t.y+t.contentHeight+20)}),i.forEach(function(t){t.path.forEach(function(n){e[n.order]=Math.max(e[n.order],n.y+t.width)})}),e}(),n=[];c.forEach(function(e,t){e.path.forEach(function(e,a){e.hasOwnProperty("y")||n.push({readIndex:t,pathIndex:a,previousY:c[t].path[a-1].y})})}),n.sort(ue),n.forEach(function(e){var n=c[e.readIndex].path[e.pathIndex];n.y=t[n.order],t[n.order]+=c[e.readIndex].width}),R&&(console.log("Reads:"),console.log(c))}(),i=i.concat(c)),function(){for(var e,t,n,a,r,o,c,l,d=0;d<=u;d+=1)Q.push(0),Z.push(0);var h=[],p=[];s.forEach(function(e){e.hasOwnProperty("order")&&(h[e.order]=e.x,void 0===p[e.order]?p[e.order]=e.x+e.pixelWidth:p[e.order]=Math.max(p[e.order],e.x+e.pixelWidth))}),i.forEach(function(i){r=Ae(i,o="plain"),n=i.path[0].y,e="read"!==i.type?"-"===i.sequence[0].charAt(0)?p[i.path[0].order]+20:h[i.path[0].order]-20:function(e){var t=s[e.path[0].node];if(e.path[0].isForward)return Re(t,e.firstNodeOffset);return Re(t,t.sequenceLength-e.firstNodeOffset)}(i);for(var d=0;d<i.path.length;d+=1)i.path[d].y===n?i.path[d].hasOwnProperty("features")&&(l=d>0&&i.path[d-1].order===i.path[d].order,c=Te(i.path[d],h[i.path[d].order],p[i.path[d].order],o,i,e,n,r,l),o=c.highlight,e=c.xStart):((t=i.path[d-1].isForward?p[i.path[d-1].order]:h[i.path[d-1].order])!==e&&(r=Ae(i,o),$.push({xStart:Math.min(e,t),yStart:n,xEnd:Math.max(e,t),yEnd:n+i.width-1,color:r,id:i.id,type:i.type})),i.path[d].order-1===i.path[d-1].order?(e=t,t=h[i.path[d].order],a=i.path[d].y,r=Ae(i,o),ee.push({xStart:e,yStart:n,xEnd:t+1,yEnd:a,width:i.width,color:r,laneChange:Math.abs(i.path[d].lane-i.path[d-1].lane),id:i.id,type:i.type}),e=t,n=a):i.path[d].order+1===i.path[d-1].order?(e=t,t=p[i.path[d].order],a=i.path[d].y,r=Ae(i,o),ee.push({xStart:e+1,yStart:n,xEnd:t,yEnd:a,width:i.width,color:r,laneChange:Math.abs(i.path[d].lane-i.path[d-1].lane),id:i.id,type:i.type}),e=t,n=a):i.path[d-1].isForward?(a=i.path[d].y,je(t,n,a,i.width,r,i.id,i.path[d].order,i.type),e=p[i.path[d].order],n=i.path[d].y):(a=i.path[d].y,Ue(t,n,a,i.width,r,i.id,i.path[d].order,i.type),e=h[i.path[d].order],n=i.path[d].y),i.path[d].hasOwnProperty("features")&&(l=i.path[d-1].order===i.path[d].order,c=Te(i.path[d],h[i.path[d].order],p[i.path[d].order],o,i,e,n,r,l),o=c.highlight,e=c.xStart));t="read"!==i.type?i.path[i.path.length-1].isForward?p[i.path[i.path.length-1].order]+20:h[i.path[i.path.length-1].order]-20:function(e){var t=s[e.path[e.path.length-1].node];if(e.path[e.path.length-1].isForward)return Re(t,e.finalNodeCoverLength);return Re(t,t.sequenceLength-e.finalNodeCoverLength)}(i),$.push({xStart:Math.min(e,t),yStart:n,xEnd:Math.max(e,t),yEnd:n+i.width-1,color:r,id:i.id,type:i.type})})}(),R&&(console.log("Tracks:"),console.log(i),console.log("Nodes:"),console.log(s),console.log("Lane assignment:"),console.log(V)),se=-99,oe=99,re=-99,s.forEach(function(e){e.hasOwnProperty("x")&&(se=Math.max(se,e.x+20+e.pixelWidth)),e.hasOwnProperty("y")&&(oe=Math.min(oe,e.y-10),re=Math.max(re,e.y+e.contentHeight+10))}),i.forEach(function(e){e.path.forEach(function(t){re=Math.max(re,t.y+e.width),oe=Math.min(oe,t.y)})}),function(){r.attr("height",re-oe+50),r.attr("width",document.getElementById(a.substring(1)).parentNode.offsetWidth);var e=Math.min(1,document.getElementById(a.substring(1)).parentNode.offsetWidth/(se+10));o=A.d().scaleExtent([e,8]).translateExtent([[-1,oe-25],[se+2,re+25]]).on("zoom",function(){var e=A.a.transform;e.y=(25-oe)*e.k,r.attr("transform",e);var t=A.b(a);t.attr("height",(re-oe+50)*A.a.transform.k),t.attr("width",document.getElementById("tubeMapSVG").clientWidth)}),r=r.call(o).on("dblclick.zoom",null).append("g");var t=document.getElementById(a.substring(1)).parentNode.offsetWidth,n=se+10<t?(t-se-10)/2:0;A.b(a).call(o.transform,A.e.translate(n,25-oe))}(),function(){var e=r.append("defs"),t=e.append("pattern").attrs({id:"patternA",width:"7",height:"7",patternUnits:"userSpaceOnUse",patternTransform:"rotate(45)"});t.append("rect").attrs({x:"0",y:"0",width:"7",height:"7",fill:"#FFFFFF"}),t.append("rect").attrs({x:"0",y:"0",width:"3",height:"3",fill:"#505050"}),t.append("rect").attrs({x:"0",y:"4",width:"3",height:"3",fill:"#505050"}),t.append("rect").attrs({x:"4",y:"0",width:"3",height:"3",fill:"#505050"}),t.append("rect").attrs({x:"4",y:"4",width:"3",height:"3",fill:"#505050"}),(t=e.append("pattern").attrs({id:"patternB",width:"8",height:"8",patternUnits:"userSpaceOnUse",patternTransform:"rotate(45)"})).append("rect").attrs({x:"0",y:"0",width:"8",height:"8",fill:"#FFFFFF"}),t.append("rect").attrs({x:"0",y:"0",width:"3",height:"3",fill:"#1f77b4"}),t.append("rect").attrs({x:"0",y:"5",width:"3",height:"3",fill:"#1f77b4"}),t.append("rect").attrs({x:"5",y:"0",width:"3",height:"3",fill:"#1f77b4"}),t.append("rect").attrs({x:"5",y:"5",width:"3",height:"3",fill:"#1f77b4"}),(t=e.append("pattern").attrs({id:"plaid0",width:"6",height:"6",patternUnits:"userSpaceOnUse",patternTransform:"rotate(45)"})).append("rect").attrs({x:"0",y:"0",width:"6",height:"6",fill:"#FFFFFF"}),t.append("rect").attrs({x:"0",y:"0",width:"2",height:"2",fill:"#1f77b4"}),t.append("rect").attrs({x:"0",y:"4",width:"2",height:"2",fill:"#1f77b4"}),t.append("rect").attrs({x:"4",y:"0",width:"2",height:"2",fill:"#1f77b4"}),t.append("rect").attrs({x:"4",y:"4",width:"2",height:"2",fill:"#1f77b4"}),(t=e.append("pattern").attrs({id:"plaid1",width:"6",height:"6",patternUnits:"userSpaceOnUse",patternTransform:"rotate(45)"})).append("rect").attrs({x:"0",y:"0",width:"6",height:"6",fill:"#FFFFFF"}),t.append("rect").attrs({x:"0",y:"0",width:"2",height:"2",fill:"#ff7f0e"}),t.append("rect").attrs({x:"0",y:"4",width:"2",height:"2",fill:"#ff7f0e"}),t.append("rect").attrs({x:"4",y:"0",width:"2",height:"2",fill:"#ff7f0e"}),t.append("rect").attrs({x:"4",y:"4",width:"2",height:"2",fill:"#ff7f0e"}),(t=e.append("pattern").attrs({id:"plaid2",width:"6",height:"6",patternUnits:"userSpaceOnUse",patternTransform:"rotate(45)"})).append("rect").attrs({x:"0",y:"0",width:"6",height:"6",fill:"#FFFFFF"}),t.append("rect").attrs({x:"0",y:"0",width:"2",height:"2",fill:"#2ca02c"}),t.append("rect").attrs({x:"0",y:"4",width:"2",height:"2",fill:"#2ca02c"}),t.append("rect").attrs({x:"4",y:"0",width:"2",height:"2",fill:"#2ca02c"}),t.append("rect").attrs({x:"4",y:"4",width:"2",height:"2",fill:"#2ca02c"}),(t=e.append("pattern").attrs({id:"plaid3",width:"6",height:"6",patternUnits:"userSpaceOnUse",patternTransform:"rotate(45)"})).append("rect").attrs({x:"0",y:"0",width:"6",height:"6",fill:"#FFFFFF"}),t.append("rect").attrs({x:"0",y:"0",width:"2",height:"2",fill:"#d62728"}),t.append("rect").attrs({x:"0",y:"4",width:"2",height:"2",fill:"#d62728"}),t.append("rect").attrs({x:"4",y:"0",width:"2",height:"2",fill:"#d62728"}),t.append("rect").attrs({x:"4",y:"4",width:"2",height:"2",fill:"#d62728"}),(t=e.append("pattern").attrs({id:"plaid4",width:"6",height:"6",patternUnits:"userSpaceOnUse",patternTransform:"rotate(45)"})).append("rect").attrs({x:"0",y:"0",width:"6",height:"6",fill:"#FFFFFF"}),t.append("rect").attrs({x:"0",y:"0",width:"2",height:"2",fill:"#9467bd"}),t.append("rect").attrs({x:"0",y:"4",width:"2",height:"2",fill:"#9467bd"}),t.append("rect").attrs({x:"4",y:"0",width:"2",height:"2",fill:"#9467bd"}),t.append("rect").attrs({x:"4",y:"4",width:"2",height:"2",fill:"#9467bd"}),(t=e.append("pattern").attrs({id:"plaid5",width:"6",height:"6",patternUnits:"userSpaceOnUse",patternTransform:"rotate(45)"})).append("rect").attrs({x:"0",y:"0",width:"6",height:"6",fill:"#FFFFFF"}),t.append("rect").attrs({x:"0",y:"0",width:"2",height:"2",fill:"#8c564b"}),t.append("rect").attrs({x:"0",y:"4",width:"2",height:"2",fill:"#8c564b"}),t.append("rect").attrs({x:"4",y:"0",width:"2",height:"2",fill:"#8c564b"}),t.append("rect").attrs({x:"4",y:"4",width:"2",height:"2",fill:"#8c564b"})}(),He($),We(),_e(te,ne),He(ae),He($,"read"),We("read");var t=function(e){var t,n=e.slice(0);for(t=n.length-1;t>=0;t-=1)n[t].hasOwnProperty("x")||n.splice(t,1);return n}(s);return function(e){var t,n;e.forEach(function(e){e.d="M ".concat(e.x-9," ").concat(e.y," Q ").concat(e.x-9," ").concat(e.y-9," ").concat(e.x," ").concat(e.y-9),t=e.x,n=e.y-9,e.width>1&&(t+=e.pixelWidth,e.d+=" L ".concat(t," ").concat(n)),e.d+=" Q ".concat(t+9," ").concat(n," ").concat(t+9," ").concat(n+9),t+=9,n+=9,e.contentHeight>0&&(n+=e.contentHeight-0,e.d+=" L ".concat(t," ").concat(n)),e.d+=" Q ".concat(t," ").concat(n+9," ").concat(t-9," ").concat(n+9),t-=9,n+=9,e.width>1&&(t-=e.pixelWidth,e.d+=" L ".concat(t," ").concat(n)),e.d+=" Q ".concat(t-9," ").concat(n," ").concat(t-9," ").concat(n-9),t-=9,n-=9,e.contentHeight>0&&(n-=e.contentHeight-0,e.d+=" L ".concat(t," ").concat(n))}),r.selectAll(".node").data(e).enter().append("path").attr("id",function(e){return e.name}).attr("d",function(e){return e.d}).on("mouseover",Je).on("mouseout",Qe).on("dblclick",Ke).style("fill","#fff").style("fill-opacity",K.showExonsFlag?"0.4":"0.6").style("stroke","black").style("stroke-width","2px").append("svg:title").text(function(e){return e.name})}(t),_e(te,ne,"read"),0===K.nodeWidthOption&&function(e){0===K.nodeWidthOption&&r.selectAll("text").data(e).enter().append("text").attr("x",function(e){return e.x-4}).attr("y",function(e){return e.y+4}).text(function(e){return e.seq}).attr("font-family",'Courier, "Lucida Console", monospace').attr("font-size","14px").attr("fill","black").style("pointer-events","none")}(t),void 0!==f&&function(){var e=0;for(;i[e].name!==f;)e+=1;var t=i[e];r.append("line").attr("x1",0).attr("y1",oe-10).attr("x2",se).attr("y2",oe-10).attr("stroke-width",1).attr("stroke","black");var n=100;0===K.nodeWidthOption&&(n=20);var a=t.indexOfFirstBase,o=!1,c=-100;if(0!==K.nodeWidthOption){var l=s[t.indexSequence[0]];c=Re(l,0),Be(a,c),o=!0}t.indexSequence.forEach(function(e){for(var t=s[e],r=Math.ceil(a/n)*n;r<a+t.sequenceLength;){var i=Re(t,r-a);c+80<=i&&(Be(r,i),o=!0,c=i),r+=n}a+=s[e].sequenceLength}),o||Be(t.indexOfFirstBase,s[t.indexSequence[0]].x-4)}(),0===K.nodeWidthOption&&i.forEach(function(e,t){"read"===e.type&&e.sequenceNew.forEach(function(t,n){t.mismatches.forEach(function(a){for(var o=h.get(t.nodeName),i=s[o],c=Re(i,a.pos),l=n;e.path[l].node!==o;)l+=1;var d=e.path[l].y;if("insertion"===a.type)!K.showSoftClips&&(a.pos===e.firstNodeOffset&&0===n||a.pos===e.finalNodeCoverLength&&n===e.sequenceNew.length-1)||function(e,t,n,a){r.append("text").attr("x",e).attr("y",t).text("*").attr("font-family",'Courier, "Lucida Console", monospace').attr("font-size","12px").attr("fill","black").attr("nodeY",a).on("mouseover",ot).on("mouseout",ct).append("svg:title").text(n)}(c-3,d+7,a.seq,i.y);else if("deletion"===a.type){var p=Re(i,a.pos+a.length);!function(e,t,n,a){r.append("line").attr("x1",e).attr("y1",n-1).attr("x2",t).attr("y2",n-1).attr("stroke-width",7).attr("stroke","grey").attr("nodeY",a).on("mouseover",st).on("mouseout",lt)}(c,p,d+4,i.y)}else if("substitution"===a.type){var u=Re(i,a.pos+a.seq.length);!function(e,t,n,a,o){r.append("text").attr("x",e).attr("y",n).text(o).attr("font-family",'Courier, "Lucida Console", monospace').attr("font-size","12px").attr("fill","black").attr("nodeY",a).attr("rightX",t).on("mouseover",it).on("mouseout",dt)}(c+1,u,d+7,i.y,a.seq)}})})}),R&&(console.log("number of tracks: ".concat(d)),console.log("number of nodes: ".concat(l))),i}}function he(e,t,n){e.has(t)?e.set(t,Math.max(e.get(t),n)):e.set(t,n)}function pe(e,t,n,a,r){n===t.path.length-1?e.set(a,t.finalNodeCoverLength):e.set(a,r.sequenceLength)}function ue(e,t){var n=c[e.readIndex].path[e.pathIndex],a=c[t.readIndex].path[t.pathIndex];return n.order===a.order?e.previousY-t.previousY:n.order-a.order}function fe(e,t){for(var n=e[1],a=t[1],r=s[c[e[0]].path[n].node],o=s[c[t[0]].path[a].node];null!==r&&null!==o&&r===o;){if(n<c[e[0]].path.length-1){for(n+=1;null===c[e[0]].path[n].node;)n+=1;r=s[c[e[0]].path[n].node]}else r=null;if(a<c[t[0]].path.length-1){for(a+=1;null===c[t[0]].path[a].node;)a+=1;o=s[c[t[0]].path[a].node]}else o=null}if(null!==r)return null!==o?Me(r,o):1;if(null!==o)return-1;var i=c[e[0]].firstNodeOffset-c[t[0]].firstNodeOffset;return 0!==i?i:c[e[0]].finalNodeCoverLength-c[t[0]].finalNodeCoverLength}function ge(e,t){var n=c[e[0]].path[e[1]-1],a=c[t[0]].path[t[1]-1];return n.hasOwnProperty("y")?a.hasOwnProperty("y")?n.y-a.y:-1:a.hasOwnProperty("y")?1:ge([e[0],e[1]-1],[t[0],t[1]-1])}function me(e,t){var n=c[e],a=c[t];return n.firstNodeOffset<a.firstNodeOffset?-1:n.firstNodeOffset>a.firstNodeOffset?1:n.finalNodeCoverLength<a.finalNodeCoverLength?-1:n.finalNodeCoverLength>a.finalNodeCoverLength?1:0}function ye(){c.forEach(function(e){for(var t=0;t<e.sequence.length&&"-"===e.sequence[t].charAt(0);)t+=1;if(t===e.sequence.length){e.is_reverse=!0,e.sequence=e.sequence.reverse();for(var n=0;n<e.sequence.length;n+=1)e.sequence[n]=e.sequence[n].substr(1);e.sequenceNew=e.sequenceNew.reverse();for(var a=function(t){e.sequenceNew[t].nodeName=e.sequenceNew[t].nodeName.substr(1);var n=s[h.get(e.sequenceNew[t].nodeName)].width;e.sequenceNew[t].mismatches.forEach(function(e){"insertion"===e.type?(e.pos=n-e.pos,e.seq=be(e.seq)):"deletion"===e.type?e.pos=n-e.pos-e.length:"substitution"===e.type&&(e.pos=n-e.pos-e.seq.length,e.seq=be(e.seq)),e.hasOwnProperty("seq")&&(e.seq=e.seq.split("").reverse().join(""))})},r=0;r<e.sequenceNew.length;r+=1)a(r);var o=e.firstNodeOffset,i=s[h.get(e.sequence[0])].sequenceLength;e.firstNodeOffset=i-e.finalNodeCoverLength,i=s[h.get(e.sequence[e.sequence.length-1])].sequenceLength,e.finalNodeCoverLength=i-o}})}function be(e){for(var t="",n=e.length-1;n>=0;n-=1)switch(e.charAt(n)){case"A":t+="T";break;case"T":t+="A";break;case"C":t+="G";break;case"G":t+="C";break;default:t+="N"}return t}function we(e){e.forEach(function(e){e.indexSequence=[],e.sequence.forEach(function(t){"-"===t.charAt(0)?e.indexSequence.push(-h.get(t.substr(1))):e.indexSequence.push(h.get(t))})})}function ve(e){var t=Math.min(1,document.getElementById(a.substring(1)).parentNode.offsetWidth/(se+10)),n=document.getElementById(a.substring(1)).parentElement.clientWidth,r=A.f(A.b(a).node()),s=Math.min(8,Math.max(r.k*e,t)),i=n/2-(n/2-r.x)*s/r.k;i=Math.min(i,1*s),i=Math.max(i,n-(se+2)*s);var c=(25-oe)*s;A.b(a).transition().duration(750).call(o.transform,A.e.translate(i,c).scale(s))}function Ee(){return h=new Map,s.forEach(function(e,t){h.set(e.name,t)}),h}function xe(){var e,t;s.forEach(function(e){e.successors=[],e.predecessors=[]}),i.forEach(function(n){for(var a=0;a<n.indexSequence.length-1;a+=1)e=Math.abs(n.indexSequence[a]),t=Math.abs(n.indexSequence[a+1]),-1===s[e].successors.indexOf(t)&&s[e].successors.push(t),-1===s[t].predecessors.indexOf(e)&&s[t].predecessors.push(e)}),c&&K.showReads&&c.forEach(function(n){for(var a=0;a<n.indexSequence.length-1;a+=1)e=Math.abs(n.indexSequence[a]),t=Math.abs(n.indexSequence[a+1]),-1===s[e].successors.indexOf(t)&&s[e].successors.push(t),-1===s[t].predecessors.indexOf(e)&&s[t].predecessors.push(e)})}function Se(e){for(var t,n,a,r=0,o=0;r<e.length&&!s[Math.abs(e[r])].hasOwnProperty("order");)r+=1;if(r>=e.length)return null;e[r]>=0?(t=s[e[r]].order-1,a=-1):(t=s[-e[r]].order+1,a=1);for(var i=r-1;i>=0;i-=1)(n=s[Math.abs(e[i])]).hasOwnProperty("order")||(n.order=t,o=Math.min(o,t),t+=a);return o<0&&Ce(-o),r}function Oe(){var e,t,n,a,r,o,l=0;o=c&&K.showReads?i.concat(c):i,s.forEach(function(e){delete e.order}),function(e){var t,n=0,a=0,r=0;e.forEach(function(e){e<0?((t=s[Math.abs(e)]).hasOwnProperty("order")||(t.order=a),t.order<r&&(r=t.order),n=t.order,a=t.order-1):((t=s[e]).hasOwnProperty("order")||(t.order=n),n=t.order+1,a=t.order)}),r<0&&Ce(-r)}(i[0].indexSequence);for(var d=1;d<o.length;d+=1)if(R&&console.log("generating order for track ".concat(d+1)),null!==(a=Se(o[d].indexSequence)))for(e=Fe(o[d].indexSequence);a<e.length;){for(r=a,a+=1;a<e.length&&!s[e[a]].hasOwnProperty("order");)a+=1;if(a<e.length){t=s[e[r]].order+1;for(var h=r+1;h<a;h+=1)s[e[h]].order=t,t+=1;if(s[e[a]].order>s[e[r]].order)s[e[a]].order<t&&Ne(e[a],e[a-1],t);else if(o[d].indexSequence[a]>=0&&!ke(e[a],e[r]))Ne(e[a],e[a-1],t);else if(o[d].sequence[r]<0||s[e[r+1]].degree<2&&s[e[a]].order<s[e[r]].order){t=s[e[r]].order-1;for(var p=r+1;p<a;p+=1)s[e[p]].order=t,t-=1}}else if(o[d].sequence[r]>=0){t=s[e[r]].order+1;for(var u=r+1;u<e.length;u+=1)(n=s[e[u]]).hasOwnProperty("order")||(n.order=t,t+=1)}else{t=s[e[r]].order-1;for(var f=r+1;f<e.length;f+=1)(n=s[e[f]]).hasOwnProperty("order")||(n.order=t,l=Math.min(l,t),t-=1)}}else o.splice(d,1),c.splice(d-i.length,1),d-=1;l<0&&Ce(-l)}function ke(e,t){var n=new Array(l).fill(!1),a=[];for(a.push(e),n[e]=!0;a.length>0;){var r=a.pop();if(r===t)return!0;for(var o=0;o<s[r].successors.length;o+=1){var i=s[r].successors[o];n[i]||(n[i]=!0,a.push(i))}}return!1}function Fe(e){for(var t=[],n=0;n<e.length;n+=1)e[n]>=0?t.push(e[n]):t.push(-e[n]);return t}function Ce(e){s.forEach(function(t){t.hasOwnProperty("order")&&(t.order+=e)})}function Ne(e,t,n){var a=new Map,r=[];r.push([e,n]);for(var o=function(){var n=r.shift(),o=n[0],i=n[1];s[o].hasOwnProperty("order")&&s[o].order<i&&(!a.has(o)||a.get(o)<i)&&(a.set(o,i),s[o].successors.forEach(function(e){s[e].order>s[o].order&&e!==t&&r.push([e,i+1])}),o!==e&&s[o].predecessors.forEach(function(e){s[e].order>o.order&&e!==t&&r.push([e,i+1])}))};r.length>0;)o();a.forEach(function(e,t){s[t].order=e})}function Ie(e,t,n,a,r){var o=r[e][n];if(null===t)V[e].push({type:"single",node:null,tracks:[{trackID:n,segmentID:a,compareToFromSame:o}]}),r[e][n]=V[e][V[e].length-1].tracks[0];else{for(var s=0;s<V[e].length;s+=1)if(V[e][s].node===t)return V[e][s].type="multiple",V[e][s].tracks.push({trackID:n,segmentID:a,compareToFromSame:o}),void(r[e][n]=V[e][s].tracks[V[e][s].tracks.length-1]);V[e].push({type:"single",node:t,tracks:[{trackID:n,segmentID:a,compareToFromSame:o}]}),r[e][n]=V[e][V[e].length-1].tracks[0]}}function Pe(e,t){var n=0,a=new Set,r=20,o=!1,c=-1;!function(e,t){var n;e.forEach(function(e){e.idealLane=0,e.tracks.forEach(function(a){if(0===a.segmentID)a.idealLane=a.trackID,a.idealY=null;else if(i[a.trackID].path[a.segmentID-1].order===t-1)a.idealLane=i[a.trackID].path[a.segmentID-1].lane,a.idealY=i[a.trackID].path[a.segmentID-1].y;else if(a.segmentID<i[a.trackID].path.length-1&&i[a.trackID].path[a.segmentID+1].order===t-1)a.idealLane=i[a.trackID].path[a.segmentID+1].lane,a.idealY=i[a.trackID].path[a.segmentID+1].y;else{for(n=a.segmentID-1;n>=0&&i[a.trackID].path[n].order!==t-1;)n-=1;n<0?(a.idealLane=a.trackID,a.idealY=null):(a.idealLane=i[a.trackID].path[n].lane,a.idealY=i[a.trackID].path[n].y)}e.idealLane+=a.idealLane}),e.idealLane/=e.tracks.length})}(e,t),e.sort(Le),e.forEach(function(e){null!==e.node?(s[e.node].topLane=n,o&&(r-=10),s[e.node].y=r,s[e.node].contentHeight=0,o=!1):(o?r-=25:r>20&&(r-=10),o=!0),e.tracks.sort(Le),e.tracks.forEach(function(t){t.lane=n,t.trackID===c&&null===e.node&&o&&(r+=10),i[t.trackID].path[t.segmentID].lane=n,i[t.trackID].path[t.segmentID].y=r,null!==t.idealY&&a.add(t.idealY-r),n+=1,r+=i[t.trackID].width,null!==e.node&&(s[e.node].contentHeight+=i[t.trackID].width),c=t.trackID}),r+=25}),function(e,t){var n=0,a=Number.MAX_SAFE_INTEGER;t.forEach(function(t){qe(e,t)<a&&(a=qe(e,t),n=t)}),e.forEach(function(e){null!==e.node&&(s[e.node].y+=n),e.tracks.forEach(function(e){i[e.trackID].path[e.segmentID].y+=n})})}(e,a)}function qe(e,t){var n=0;return e.forEach(function(e){e.tracks.forEach(function(e){null!==e.idealY&&"read"!==i[e.trackID].type&&(n+=Math.abs(e.idealY-t-i[e.trackID].path[e.segmentID].y)*i[e.trackID].width)})}),n}function Le(e,t){return e.hasOwnProperty("idealLane")?t.hasOwnProperty("idealLane")?e.idealLane<t.idealLane?-1:e.idealLane>t.idealLane?1:0:-1:t.hasOwnProperty("idealLane")?1:0}function Me(e,t){if(null===e)return null===t?0:-1;if(null===t)return 1;if(e.hasOwnProperty("order")){if(t.hasOwnProperty("order")){if(e.order<t.order)return-1;if(e.order>t.order)return 1;if(e.hasOwnProperty("y")&&t.hasOwnProperty("y")){if(e.y<t.y)return-1;if(e.y>t.y)return 1}return 0}return-1}return t.hasOwnProperty("order")?1:0}function De(e){switch(e){case"plainColors":return _;case"reds":return U;case"blues":return j;case"greys":return T;case"lightColors":return B;default:return T}}function Ae(e,t){return"undefined"===typeof t&&(t="plain"),e.hasOwnProperty("type")&&"read"===e.type?e.hasOwnProperty("is_reverse")&&!0===e.is_reverse?X[e.id%X.length]:H[e.id%H.length]:!1===K.showExonsFlag||"plain"!==t?z[e.id%z.length]:W[e.id%W.length]}function Re(e,t){if(t>e.sequenceLength)return null;var n=e.x-4,a=e.x+e.pixelWidth+4;return n+t/e.sequenceLength*(a-n)}function Te(e,t,n,a,r,o,i,c,l){var d,h,p,u,f,g=a;return t-=8,n+=8,d=s[e.node].hasOwnProperty("sequenceLength")?s[e.node].sequenceLength:s[e.node].width,e.features.sort(function(e,t){return e.start-t.start}),e.features.forEach(function(a){g!==a.type&&(h=Ae(r,g),!0===e.isForward?(u=t+Math.round(a.start*(n-t+1)/d),l&&u<t+8&&(f=t+Math.round((a.end+1)*(n-t+1)/d)-1,p=Ae(r,a.type),ae.push({xStart:u,yStart:i,xEnd:f,yEnd:i+r.width-1,color:p,id:r.id,type:r.type})),u>o+1&&ae.push({xStart:o,yStart:i,xEnd:u-1,yEnd:i+r.width-1,color:h,id:r.id,type:r.type})):(u=n-Math.round(a.start*(n-t+1)/d),l&&u>n-8&&(f=n-Math.round((a.end+1)*(n-t+1)/d)-1,p=Ae(r,a.type),ae.push({xStart:f,yStart:i,xEnd:u,yEnd:i+r.width-1,color:p,id:r.id,type:r.type})),o>u+1&&ae.push({xStart:u+1,yStart:i,xEnd:o,yEnd:i+r.width-1,color:h,id:r.id,type:r.type})),o=u,g=a.type),(a.end<d-1||!a.hasOwnProperty("continue"))&&(h=Ae(r,g),!0===e.isForward?(f=t+Math.round((a.end+1)*(n-t+1)/d)-1,ae.push({xStart:o,yStart:i,xEnd:f,yEnd:i+r.width-1,color:h,id:r.id,type:r.type})):(f=n-Math.round((a.end+1)*(n-t+1)/d)-1,ae.push({xStart:f,yStart:i,xEnd:o,yEnd:i+r.width-1,color:h,id:r.id,type:r.type})),o=f+1,g="plain")}),{xStart:o,highlight:g}}function je(e,t,n,a,r,o,s,i){e+=10*Z[s];var c=Math.min(t,n),l=Math.max(t,n);ne.push({xStart:e-10*Z[s],yStart:t,xEnd:e+5,yEnd:t+a-1,color:r,id:o,type:i}),ne.push({xStart:e+5+7,yStart:c+a+7-1,xEnd:e+5+7+Math.min(7,a)-1,yEnd:l-7+1,color:r,id:o,type:i}),ne.push({xStart:e-10*Z[s],yStart:n,xEnd:e+5,yEnd:n+a-1,color:r,id:o,type:i});var d="M ".concat(e+5," ").concat(l);d+=" Q ".concat(e+5+7," ").concat(l," ").concat(e+5+7," ").concat(l-7),d+=" H ".concat(e+5+7+Math.min(7,a)),d+=" Q ".concat(e+5+7+Math.min(7,a)," ").concat(l+a," ").concat(e+5," ").concat(l+a),d+=" Z ",te.push({path:d,color:r,id:o,type:i}),d="M ".concat(e+5," ").concat(c),d+=" Q ".concat(e+5+7+Math.min(7,a)," ").concat(c," ").concat(e+5+7+Math.min(7,a)," ").concat(c+a+7),d+=" H ".concat(e+5+7),d+=" Q ".concat(e+5+7," ").concat(c+a," ").concat(e+5," ").concat(c+a),d+=" Z ",te.push({path:d,color:r,id:o,type:i}),Z[s]+=1}function Ue(e,t,n,a,r,o,s,i){var c=Math.min(t,n),l=Math.max(t,n);e-=10*Q[s],ne.push({xStart:e-6,yStart:t,xEnd:e+10*Q[s],yEnd:t+a-1,color:r,id:o,type:i}),ne.push({xStart:e-5-7-Math.min(7,a),yStart:c+a+7-1,xEnd:e-5-7-1,yEnd:l-7+1,color:r,id:o,type:i}),ne.push({xStart:e-6,yStart:n,xEnd:e+10*Q[s],yEnd:n+a-1,color:r,id:o,type:i});var d="M ".concat(e-5," ").concat(l);d+=" Q ".concat(e-5-7," ").concat(l," ").concat(e-5-7," ").concat(l-7),d+=" H ".concat(e-5-7-Math.min(7,a)),d+=" Q ".concat(e-5-7-Math.min(7,a)," ").concat(l+a," ").concat(e-5," ").concat(l+a),d+=" Z ",te.push({path:d,color:r,id:o,type:i}),d="M ".concat(e-5," ").concat(c),d+=" Q ".concat(e-5-7-Math.min(7,a)," ").concat(c," ").concat(e-5-7-Math.min(7,a)," ").concat(c+a+7),d+=" H ".concat(e-5-7),d+=" Q ".concat(e-5-7," ").concat(c+a," ").concat(e-5," ").concat(c+a),d+=" Z ",te.push({path:d,color:r,id:o,type:i}),Q[s]+=1}function _e(e,t,n){"undefined"===typeof n&&(n="haplo");var a=new Set;t.forEach(function(e){a.add(e.color)}),a.forEach(function(a){He(t.filter(ze("color",a)),n),function(e,t){"undefined"===typeof t&&(t="haplo");e=e.filter(ze("type",t)),r.selectAll("trackCorners").data(e).enter().append("path").attr("d",function(e){return e.path}).style("fill",function(e){return e.color}).attr("trackID",function(e){return e.id}).attr("class",function(e){return"track".concat(e.id)}).attr("color",function(e){return e.color}).on("mouseover",Ye).on("mouseout",Ve).on("dblclick",Ze)}(e.filter(ze("color",a)),n)})}function Be(e,t){r.append("text").attr("x",t).attr("y",oe-13).text("|".concat(e)).attr("font-family",'Courier, "Lucida Console", monospace').attr("font-size","12px").attr("fill","black").style("pointer-events","none")}function ze(e,t){return function(n){return n[e]===t}}function He(e,t){"undefined"===typeof t&&(t="haplo"),e=e.filter(ze("type",t)),r.selectAll("trackRectangles").data(e).enter().append("rect").attr("x",function(e){return e.xStart}).attr("y",function(e){return e.yStart}).attr("width",function(e){return e.xEnd-e.xStart+1}).attr("height",function(e){return e.yEnd-e.yStart+1}).style("fill",function(e){return e.color}).attr("trackID",function(e){return e.id}).attr("class",function(e){return"track".concat(e.id)}).attr("color",function(e){return e.color}).on("mouseover",Ye).on("mouseout",Ve).on("dblclick",Ze)}function Xe(e,t){return e[6]<t[6]?-1:e[6]>t[6]?1:0}function We(e){"undefined"===typeof e&&(e="haplo");var t=ee.filter(ze("type",e));t.sort(Xe),t.forEach(function(e){var t=(e.xStart+e.xEnd)/2,n="M ".concat(e.xStart," ").concat(e.yStart);n+=" C ".concat(t," ").concat(e.yStart," ").concat(t," ").concat(e.yEnd," ").concat(e.xEnd," ").concat(e.yEnd),n+=" V ".concat(e.yEnd+e.width),n+=" C ".concat(t," ").concat(e.yEnd+e.width," ").concat(t," ").concat(e.yStart+e.width," ").concat(e.xStart," ").concat(e.yStart+e.width),n+=" Z",e.path=n}),r.selectAll("trackCurves").data(ee).enter().append("path").attr("d",function(e){return e.path}).style("fill",function(e){return e.color}).attr("trackID",function(e){return e.id}).attr("class",function(e){return"track".concat(e.id)}).attr("color",function(e){return e.color}).on("mouseover",Ye).on("mouseout",Ve).on("dblclick",Ze)}function Ge(){for(var e='<table class="table-sm table-condensed table-nonfluid"><thead><tr><th>Color</th><th>Trackname</th><th>Show Track</th></tr></thead>',t=[],n=0;n<i.length;n+=1)"haplo"===i[n].type&&(e+='<tr><td style="text-align:right"><div class="color-box" style="background-color: '.concat(Ae(i[n],"exon"),';"></div></td>'),i[n].hasOwnProperty("name")?e+="<td>".concat(i[n].name,"</td>"):e+="<td>".concat(i[n].id,"</td>"),e+='<td><input type="checkbox" checked=true id="showTrack'.concat(n,'"></td>'),t.push(n));e+="</table",document.getElementById("legendDiv").innerHTML=e,t.forEach(function(e){document.getElementById("showTrack".concat(e)).addEventListener("click",function(){return function(e){for(var t=0;t<Y.length&&Y[t].id!==e;)t+=1;t<Y.length&&(Y[t].hasOwnProperty("hidden")?Y[t].hidden=!Y[t].hidden:Y[t].hidden=!0),de()}(e)},!1)})}function Ye(){var e=A.b(this).attr("trackID");A.c(".track".concat(e)).style("fill","url(#patternA)")}function Je(){A.b(this).style("stroke-width","4px")}function Ve(){var e=A.b(this).attr("trackID");A.c(".track".concat(e)).each(function(){var e=A.b(this).attr("color");A.b(this).style("fill",e)})}function Qe(){A.b(this).style("stroke-width","2px")}function Ze(){for(var e=A.b(this).attr("trackID"),t=0;t<Y.length&&Y[t].id!==Number(e);)t+=1;t>=Y.length||(R&&console.log("moving index: ".concat(t)),ie(t),de())}function Ke(){var e=A.b(this).attr("id");K.clickableNodesFlag&&(c&&K.showReads?(document.getElementById("hgvmNodeID").value=e,document.getElementById("hgvmPostButton").click()):(document.getElementById("nodeID").value=e,document.getElementById("postButton").click()))}function $e(e){var t=[];return e.node.forEach(function(e){t.push({name:"".concat(e.id),sequenceLength:e.sequence.length,seq:e.sequence})}),t}function et(){switch(s.forEach(function(e){e.hasOwnProperty("sequenceLength")||(e.sequenceLength=e.seq.length)}),K.nodeWidthOption){case 1:s.forEach(function(e){e.width=1+Math.log(e.sequenceLength)/Math.log(2),e.pixelWidth=Math.round(8.401*(e.width-1))});break;case 2:s.forEach(function(e){e.width=e.sequenceLength/100,e.pixelWidth=Math.round(8.401*(e.width-1))});break;default:s.forEach(function(e){e.width=e.sequenceLength,r.append("text").attr("x",0).attr("y",100).attr("id","dummytext").text(e.seq.substr(1)).attr("font-family",'Courier, "Lucida Console", monospace').attr("font-size","14px").attr("fill","black").style("pointer-events","none"),e.pixelWidth=Math.round(document.getElementById("dummytext").getComputedTextLength()),document.getElementById("dummytext").remove()})}}function tt(e){var t=[];return e.path.forEach(function(e,n){var a=[],r=!0;e.mapping.forEach(function(e){e.position.hasOwnProperty("is_reverse")&&!0===e.position.is_reverse?a.push("-".concat(e.position.node_id)):(a.push("".concat(e.position.node_id)),r=!1)}),r&&(a.reverse(),a.forEach(function(e,t){a[t]=e.substr(1)}));var o={};o.id=n,o.sequence=a,e.hasOwnProperty("freq")&&(o.freq=e.freq),e.hasOwnProperty("name")&&(o.name=e.name),e.hasOwnProperty("indexOfFirstBase")&&(o.indexOfFirstBase=Number(e.indexOfFirstBase)),t.push(o)}),t}function nt(e,t,n){R&&(console.log("Reads:"),console.log(n));var a=[],r=[];e.forEach(function(e){r.push(e.name,10)});for(var o=function(e){var o=n[e],s=[],i=[],c=-1,l=-1;if(o.path.mapping.forEach(function(t,n){if(r.indexOf(t.position.node_id)>-1){var a={},o=0;t.position.hasOwnProperty("is_reverse")&&!0===t.position.is_reverse?(s.push("-".concat(t.position.node_id)),a.nodeName="-".concat(t.position.node_id)):(s.push("".concat(t.position.node_id)),a.nodeName=t.position.node_id.toString()),c<0&&(c=n,t.position.hasOwnProperty("offset")&&(t.position.offset=parseInt(t.position.offset,10),o=t.position.offset)),l=n;var d=[],h=o;t.edit.forEach(function(a){a.hasOwnProperty("to_length")&&!a.hasOwnProperty("from_length")?d.push({type:"insertion",pos:h,seq:a.sequence}):!a.hasOwnProperty("to_length")&&a.hasOwnProperty("from_length")?d.push({type:"deletion",pos:h,length:a.from_length}):a.hasOwnProperty("sequence")&&(a.sequence.length>1&&R&&console.log("found substitution at read ".concat(e,", node ").concat(n," = ").concat(t.position.node_id,", seq = ").concat(a.sequence)),d.push({type:"substitution",pos:h,seq:a.sequence})),a.hasOwnProperty("from_length")&&(h+=a.from_length)}),a.mismatches=d,i.push(a)}}),0===s.length)R&&console.log("read ".concat(e," is empty"));else{var d={};d.id=t.length+a.length,d.sequence=s,d.sequenceNew=i,d.type="read",o.path.hasOwnProperty("freq")&&(d.freq=o.path.freq),o.path.hasOwnProperty("name")&&(d.name=o.path.name),d.firstNodeOffset=0,o.path.mapping[c].position.hasOwnProperty("offset")&&(d.firstNodeOffset=o.path.mapping[c].position.offset);var h=o.path.mapping[l].edit;d.finalNodeCoverLength=0,o.path.mapping[l].position.hasOwnProperty("offset")&&(d.finalNodeCoverLength+=o.path.mapping[l].position.offset),h.forEach(function(e){e.hasOwnProperty("from_length")&&(d.finalNodeCoverLength+=e.from_length)}),a.push(d)}},s=0;s<n.length;s+=1)o(s);return a}function at(e,t,n){if(1!==t[e].length)return!1;if("None"===t[e][0])return!1;var a=t[e][0];"-"===a.charAt(0)&&(a=a.substr(1));var r=h.get(a);return 1===n[r].length&&("None"!==n[r][0]&&a)}function rt(e,t,n){if(1!==n[e].length)return!1;if("None"===n[e][0])return!1;var a=n[e][0];"-"===a.charAt(0)&&(a=a.substr(1));var r=h.get(a);return 1===t[r].length&&"None"!==t[r][0]}function ot(){A.b(this).attr("fill","red");var e=Number(A.b(this).attr("x")),t=Number(A.b(this).attr("y")),n=Number(A.b(this).attr("nodeY"));r.append("line").attr("class","insertionHighlight").attr("x1",e+4).attr("y1",t-10).attr("x2",e+4).attr("y2",n+5).attr("stroke-width",1).attr("stroke","black")}function st(){A.b(this).attr("stroke","red");var e=Number(A.b(this).attr("x1")),t=Number(A.b(this).attr("x2")),n=Number(A.b(this).attr("y1")),a=Number(A.b(this).attr("nodeY"));r.append("line").attr("class","deletionHighlight").attr("x1",e).attr("y1",n-3).attr("x2",e).attr("y2",a+5).attr("stroke-width",1).attr("stroke","black"),r.append("line").attr("class","deletionHighlight").attr("x1",t).attr("y1",n-3).attr("x2",t).attr("y2",a+5).attr("stroke-width",1).attr("stroke","black")}function it(){A.b(this).attr("fill","red");var e=Number(A.b(this).attr("x")),t=Number(A.b(this).attr("rightX")),n=Number(A.b(this).attr("y")),a=Number(A.b(this).attr("nodeY"));r.append("line").attr("class","substitutionHighlight").attr("x1",e-1).attr("y1",n-7).attr("x2",e-1).attr("y2",a+5).attr("stroke-width",1).attr("stroke","black"),r.append("line").attr("class","substitutionHighlight").attr("x1",t+1).attr("y1",n-7).attr("x2",t+1).attr("y2",a+5).attr("stroke-width",1).attr("stroke","black")}function ct(){A.b(this).attr("fill","black"),A.c(".insertionHighlight").remove()}function lt(){A.b(this).attr("stroke","grey"),A.c(".deletionHighlight").remove()}function dt(){A.b(this).attr("fill","black"),A.c(".substitutionHighlight").remove()}var ht=2,pt=function(e){function t(){var e,n;Object(x.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(O.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).handleZoomIn=function(){ve(ht)},n.handleZoomOut=function(){ve(1/ht)},n.handleDownloadButton=function(){var e=document.getElementById("svg"),t=(new XMLSerializer).serializeToString(e),n=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),a=URL.createObjectURL(n),r=document.createElement("a");r.href=a,r.download="graph.svg",document.body.appendChild(r),r.click(),document.body.removeChild(r)},n}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return y.a.createElement(P.i,{inline:!0},y.a.createElement(P.l,{className:"tight-label mb-2 mr-sm-2 mb-sm-0 ml-2",for:"nodeID"},"Start:"),y.a.createElement(P.k,{type:"text",className:"custom-input form-control mb-2 mr-sm-4 mb-sm-0",id:"nodeID",size:"12",value:this.props.nodeID,onChange:this.props.handleInputChange}),y.a.createElement(P.l,{className:"tight-label mb-2 mr-sm-2 mb-sm-0 ml-2",for:"distance"},"Length:"),y.a.createElement(P.k,{type:"text",className:"custom-input form-control mb-2 mr-sm-2 mb-sm-0",id:"distance",size:"4",value:this.props.distance,onChange:this.props.handleInputChange}),y.a.createElement(P.l,{className:"tight-label mb-2 mr-sm-2 mb-sm-0 ml-2",for:"unitSelect"},"Unit:"),y.a.createElement(P.k,{type:"select",className:"custom-select mb-2 mr-sm-2 mb-sm-0",id:"byNode",value:this.props.byNode,onChange:this.props.handleInputChange},y.a.createElement("option",{value:"false"},"Nucleotides"),y.a.createElement("option",{value:"true"},"Nodes")),"\xa0",this.props.uploadInProgress&&y.a.createElement("div",{className:"smallLoader",id:"fileUploadSpinner"}),y.a.createElement(P.b,{color:"primary",id:"goButton",onClick:this.props.handleGoButton,disabled:this.props.uploadInProgress},"Go"),y.a.createElement(P.b,{color:"primary",id:"goLeftButton",onClick:this.props.handleGoLeft},y.a.createElement(M.a,{icon:D.c,size:"lg"})),y.a.createElement(P.b,{color:"primary",id:"zoomInButton",onClick:this.handleZoomIn},y.a.createElement(M.a,{icon:D.b,size:"lg"})),y.a.createElement(P.b,{color:"primary",id:"zoomOutButton",onClick:this.handleZoomOut},y.a.createElement(M.a,{icon:D.a,size:"lg"})),y.a.createElement(P.b,{color:"primary",id:"goRightButton",onClick:this.props.handleGoRight},y.a.createElement(M.a,{icon:D.d,size:"lg"})),y.a.createElement(P.b,{color:"secondary",id:"downloadButton",onClick:this.handleDownloadButton},"Download Image"))}}]),t}(m.Component),ut=function(e){function t(){return Object(x.a)(this,t),Object(O.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this.props.xgSelectOptions.map(function(e){return y.a.createElement("option",{value:e,key:e},e)}),t=this.props.gbwtSelectOptions.map(function(e){return y.a.createElement("option",{value:e,key:e},e)}),n=this.props.gamSelectOptions.map(function(e){return y.a.createElement("option",{value:e,key:e},e)}),a=this.props.pathSelectOptions.map(function(e){return y.a.createElement("option",{value:e,key:e},e)});return y.a.createElement(y.a.Fragment,null,y.a.createElement(P.l,{className:"customData tight-label mb-2 mr-sm-2 mb-sm-0 ml-2"},"xg file:"),y.a.createElement(P.k,{type:"select",className:"customDataMounted custom-select mb-2 mr-sm-4 mb-sm-0",id:"xgSelect",value:this.props.xgSelect,onChange:this.props.handleInputChange},e),y.a.createElement(P.l,{for:"gbwtFileSelect",className:"customData tight-label mb-2 mr-sm-2 mb-sm-0 ml-2"},"gbwt file:"),y.a.createElement(P.k,{type:"select",className:"customDataMounted custom-select mb-2 mr-sm-4 mb-sm-0",id:"gbwtSelect",value:this.props.gbwtSelect,onChange:this.props.handleInputChange},t),y.a.createElement(P.l,{for:"gamFileSelect",className:"customData tight-label mb-2 mr-sm-2 mb-sm-0 ml-2"},"gam index:"),y.a.createElement(P.k,{type:"select",className:"customDataMounted custom-select mb-2 mr-sm-4 mb-sm-0",id:"gamSelect",value:this.props.gamSelect,onChange:this.props.handleInputChange},n),y.a.createElement(P.l,{for:"pathName",className:"customData tight-label mb-2 mr-sm-2 mb-sm-0 ml-2"},"Path name:"),y.a.createElement(P.k,{type:"select",className:"customData custom-select mb-2 mr-sm-4 mb-sm-0",id:"pathSelect",value:this.props.pathSelect,onChange:this.props.handleInputChange},a))}}]),t}(m.Component),ft=L.BACKEND_URL||"http://".concat(window.location.host),gt=5242880,mt=function(e){function t(e){var n;return Object(x.a)(this,t),(n=Object(O.a)(this,Object(k.a)(t).call(this,e))).onXgFileChange=function(){var e=n.xgFileInput.current.files[0];if(void 0===e)n.props.resetPathNames(),n.props.handleFileUpload("xgFile","none");else{if(e.size>gt)return n.xgFileInput.current.value="",void n.props.showFileSizeAlert();n.props.setUploadInProgress(!0);var t=new FormData;t.append("xgFile",e);var a=new XMLHttpRequest;a.responseType="json",a.onreadystatechange=function(){4===a.readyState&&200===a.status&&(n.props.setUploadInProgress(!1),n.props.handleFileUpload("xgFile",a.response.path),n.props.getPathNames(a.response.path,"true"))},a.open("POST","".concat(ft,"/xgFileSubmission"),!0),a.send(t)}},n.onGbwtFileChange=function(){var e=n.gbwtFileInput.current.files[0];if(void 0===e)n.props.handleFileUpload("gbwtFile","none");else{if(e.size>gt)return n.gbwtFileInput.current.value="",void n.props.showFileSizeAlert();n.props.setUploadInProgress(!0);var t=new FormData;t.append("gbwtFile",e);var a=new XMLHttpRequest;a.responseType="json",a.onreadystatechange=function(){4===a.readyState&&200===a.status&&(n.props.setUploadInProgress(!1),n.props.handleFileUpload("gbwtFile",a.response.path))},a.open("POST","".concat(ft,"/gbwtFileSubmission"),!0),a.send(t)}},n.onGamFileChange=function(){var e=n.gamFileInput.current.files[0];if(void 0===e)n.props.handleFileUpload("gamFile","none");else{if(e.size>gt)return n.gamFileInput.current.value="",void n.props.showFileSizeAlert();n.props.setUploadInProgress(!0);var t=new FormData;t.append("gamFile",e);var a=new XMLHttpRequest;a.responseType="json",a.onreadystatechange=function(){4===a.readyState&&200===a.status&&(n.props.setUploadInProgress(!1),n.props.handleFileUpload("gamFile",a.response.path))},a.open("POST","".concat(ft,"/gamFileSubmission"),!0),a.send(t)}},n.xgFileInput=y.a.createRef(),n.gbwtFileInput=y.a.createRef(),n.gamFileInput=y.a.createRef(),n}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this.props.pathSelectOptions.map(function(e){return y.a.createElement("option",{value:e,key:e},e)});return y.a.createElement(y.a.Fragment,null,y.a.createElement(P.l,{className:"customData tight-label mb-2 mr-sm-2 mb-sm-0 ml-2"},"xg file:"),y.a.createElement(P.k,{type:"file",className:"customDataUpload form-control-file",id:"xgFileUpload",accept:".xg",innerRef:this.xgFileInput,onChange:this.onXgFileChange}),y.a.createElement(P.l,{for:"gbwtFileSelect",className:"customData tight-label mb-2 mr-sm-2 mb-sm-0 ml-2"},"gbwt file:"),y.a.createElement(P.k,{type:"file",className:"customDataUpload form-control-file",id:"gbwtFileUpload",accept:".gbwt",innerRef:this.gbwtFileInput,onChange:this.onGbwtFileChange}),y.a.createElement(P.l,{for:"gamFileSelect",className:"customData tight-label mb-2 mr-sm-2 mb-sm-0 ml-2"},"gam index:"),y.a.createElement(P.k,{type:"file",className:"customDataUpload form-control-file",id:"gamFileUpload",accept:".gam",innerRef:this.gamFileInput,onChange:this.onGamFileChange}),y.a.createElement(P.l,{for:"pathName",className:"customData tight-label mb-2 mr-sm-2 mb-sm-0 ml-2"},"Path name:"),y.a.createElement(P.k,{type:"select",className:"customData custom-select mb-2 mr-sm-4 mb-sm-0",id:"pathSelect",value:this.props.pathSelect,onChange:this.props.handleInputChange},e))}}]),t}(m.Component),yt=function(e){function t(){var e,n;Object(x.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(O.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(e,t,a){n.props.setDataOrigin(e),n.props.setColorSetting("haplotypeColors",t),a&&n.props.setColorSetting("forwardReadColors",a)},n}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this;return y.a.createElement(P.i,{inline:!0},y.a.createElement(P.b,{color:"primary",id:"example1",onClick:function(){return e.handleClick(q.EXAMPLE_1,"plainColors")}},"Indels and Polymorphisms only"),y.a.createElement(P.b,{color:"primary",id:"example2",onClick:function(){return e.handleClick(q.EXAMPLE_2,"plainColors")}},"Inversions"),y.a.createElement(P.b,{color:"primary",id:"example3",onClick:function(){return e.handleClick(q.EXAMPLE_3,"plainColors")}},"Nested Inversions"),y.a.createElement(P.b,{color:"primary",id:"example4",onClick:function(){return e.handleClick(q.EXAMPLE_4,"plainColors")}},"Duplications"),y.a.createElement(P.b,{color:"primary",id:"example5",onClick:function(){return e.handleClick(q.EXAMPLE_5,"plainColors")}},"Translocations"),y.a.createElement(P.b,{color:"primary",id:"example6",onClick:function(){return e.handleClick(q.EXAMPLE_6,"greys","reds")}},"Aligned Reads"))}}]),t}(m.Component),bt=L.BACKEND_URL||"http://".concat(window.location.host),wt=L.DATA_SOURCES,vt={BUILT_IN:"built-in",FILE_UPLOAD:"file-upload",MOUNTED_FILES:"mounted files",EXAMPLES:"examples"},Et=function(e){function t(){var e,n;Object(x.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(O.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).state={xgSelectOptions:["none"],xgSelect:"none",gbwtSelectOptions:["none"],gbwtSelect:"none",gamSelectOptions:["none"],gamSelect:"none",pathSelectOptions:["none"],pathSelect:"none",xgFile:"snp1kg-BRCA1.vg.xg",gbwtFile:"",gamFile:"NA12878-BRCA1.sorted.gam",anchorTrackName:"17",dataPath:"default",nodeID:"1",distance:"100",byNode:"false",dataType:vt.BUILT_IN,fileSizeAlert:!1,uploadInProgress:!1},n.getMountedFilenames=Object(I.a)(N.a.mark(function e(){var t,a;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(bt,"/getFilenames"),{method:"POST",headers:{"Content-Type":"application/json"}});case 3:return t=e.sent,e.next=6,t.json();case 6:(a=e.sent).xgFiles.unshift("none"),a.gbwtFiles.unshift("none"),a.gamIndices.unshift("none"),n.setState(function(e){var t=a.xgFiles.includes(e.xgSelect)?e.xgSelect:"none",n=a.gbwtFiles.includes(e.gbwtSelect)?e.gbwtSelect:"none",r=a.gamIndices.includes(e.gamSelect)?e.gamSelect:"none";return{xgSelectOptions:a.xgFiles,gbwtSelectOptions:a.gbwtFiles,gamSelectOptions:a.gamIndices,xgSelect:t,gbwtSelect:n,gamSelect:r}}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log("POST to /getFilenames failed");case 16:case"end":return e.stop()}},e,this,[[0,13]])})),n.getPathNames=function(){var e=Object(I.a)(N.a.mark(function e(t,a){var r,o;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(bt,"/getPathNames"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({xgFile:t,isUploadedFile:a})});case 3:return r=e.sent,e.next=6,r.json();case 6:o=e.sent,n.setState(function(e){var t=o.pathNames.includes(e.pathSelect)?e.pathSelect:o.pathNames[0];return{pathSelectOptions:o.pathNames,pathSelect:t,anchorTrackName:t}}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("POST to /getPathNames failed");case 13:case"end":return e.stop()}},e,this,[[0,10]])}));return function(t,n){return e.apply(this,arguments)}}(),n.resetPathNames=function(){n.setState({pathSelectOptions:["none"],pathSelect:"none"})},n.handleDataSourceChange=function(e){var t=e.target.value;wt.forEach(function(e){e.name!==t||n.setState({xgFile:e.xgFile,gbwtFile:e.gbwtFile,gamFile:e.gamFile,anchorTrackName:e.anchorTrackName,dataPath:e.useMountedPath?"mounted":"default",nodeID:e.defaultPosition,dataType:vt.BUILT_IN})}),"customFileUpload"===t?n.setState(function(e){return{xgFile:e.xgSelect,gbwtFile:e.gbwtSelect,gamFile:e.gamSelect,anchorTrackName:e.pathSelect,dataPath:"upload",dataType:vt.FILE_UPLOAD}}):"customMounted"===t?n.setState(function(e){return{xgFile:e.xgSelect,gbwtFile:e.gbwtSelect,gamFile:e.gamSelect,anchorTrackName:e.pathSelect,dataPath:"mounted",dataType:vt.MOUNTED_FILES}}):"syntheticExamples"===t&&n.setState({dataType:vt.EXAMPLES})},n.handleGoButton=function(){n.props.dataOrigin!==q.API&&(n.props.setColorSetting("haplotypeColors","greys"),n.props.setColorSetting("forwardReadColors","reds"));var e={nodeID:n.state.nodeID,distance:n.state.distance,byNode:n.state.byNode,xgFile:n.state.xgFile,gbwtFile:n.state.gbwtFile,gamFile:n.state.gamFile,anchorTrackName:n.state.anchorTrackName,dataPath:n.state.dataPath};n.props.setFetchParams(e)},n.handleInputChange=function(e){var t=e.target.id,a=e.target.value;n.setState(Object(v.a)({},t,a)),"xgSelect"===t?(n.getPathNames(a,!1),n.setState({xgFile:a})):"gbwtSelect"===t?n.setState({gbwtFile:a}):"gamSelect"===t?n.setState({gamFile:a}):"pathSelect"===t&&n.setState({anchorTrackName:a})},n.handleGoRight=function(){n.setState(function(e){return{nodeID:Number(n.state.nodeID)+Number(n.state.distance)}},function(){return n.handleGoButton()})},n.handleGoLeft=function(){n.setState(function(e){return{nodeID:Math.max(0,Number(n.state.nodeID)-Number(n.state.distance))}},function(){return n.handleGoButton()})},n.handleFileUpload=function(e,t){n.setState(Object(v.a)({},e,t))},n.showFileSizeAlert=function(){n.setState({fileSizeAlert:!0})},n.setUploadInProgress=function(e){n.setState({uploadInProgress:e})},n.setUpWebsocket=function(){n.ws=new WebSocket(bt.replace(/^http/,"ws")),n.ws.onmessage=function(e){n.getMountedFilenames()},n.ws.onclose=function(e){setTimeout(n.setUpWebsocket,1e3)},n.ws.onerror=function(e){n.ws.close()}},n}return Object(F.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){this.getMountedFilenames(),this.setUpWebsocket()}},{key:"render",value:function(){var e=this,t=wt.map(function(e){return y.a.createElement("option",{value:e.name,key:e.name},e.name)});t.push(y.a.createElement("option",{value:"syntheticExamples",key:"syntheticExamples"},"synthetic data examples"),y.a.createElement("option",{value:"customFileUpload",key:"customFileUpload"},"custom (file upload)"),y.a.createElement("option",{value:"customMounted",key:"customMounted"},"custom (mounted files)"));var n=this.state.dataType===vt.MOUNTED_FILES,a=this.state.dataType===vt.FILE_UPLOAD,r=this.state.dataType===vt.EXAMPLES;return y.a.createElement("div",null,y.a.createElement(P.h,{fluid:!0},y.a.createElement(P.m,null,y.a.createElement(P.f,{md:"auto"},y.a.createElement("img",{src:"./logo.png",alt:"Logo"})),y.a.createElement(P.f,null,y.a.createElement(P.i,{inline:!0},y.a.createElement(P.l,{className:"tight-label mb-2 mr-sm-2 mb-sm-0 ml-2",for:"dataSourceSelect"},"Data:"),y.a.createElement(P.k,{type:"select",id:"dataSourceSelect",className:"custom-select mb-2 mr-sm-4 mb-sm-0",onChange:this.handleDataSourceChange},t),n&&y.a.createElement(ut,{xgSelect:this.state.xgSelect,xgSelectOptions:this.state.xgSelectOptions,gbwtSelect:this.state.gbwtSelect,gbwtSelectOptions:this.state.gbwtSelectOptions,gamSelect:this.state.gamSelect,gamSelectOptions:this.state.gamSelectOptions,pathSelect:this.state.pathSelect,pathSelectOptions:this.state.pathSelectOptions,handleInputChange:this.handleInputChange}),a&&y.a.createElement(mt,{pathSelect:this.state.pathSelect,pathSelectOptions:this.state.pathSelectOptions,handleInputChange:this.handleInputChange,getPathNames:this.getPathNames,resetPathNames:this.resetPathNames,handleFileUpload:this.handleFileUpload,showFileSizeAlert:this.showFileSizeAlert,setUploadInProgress:this.setUploadInProgress})),y.a.createElement(P.a,{color:"danger",isOpen:this.state.fileSizeAlert,toggle:function(){e.setState({fileSizeAlert:!1})},className:"mt-3"},y.a.createElement("strong",null,"File size too big! "),"You may only upload files with a maximum size of"," ","5 MB","."),r?y.a.createElement(yt,{setDataOrigin:this.props.setDataOrigin,setColorSetting:this.props.setColorSetting}):y.a.createElement(pt,{nodeID:this.state.nodeID,distance:this.state.distance,byNode:this.state.byNode,handleInputChange:this.handleInputChange,handleGoLeft:this.handleGoLeft,handleGoRight:this.handleGoRight,handleGoButton:this.handleGoButton,uploadInProgress:this.state.uploadInProgress})))))}}]),t}(m.Component),xt=function(e){function t(){var e,n;Object(x.a)(this,t);for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];return(n=Object(O.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(s)))).createTubeMap=function(){var e;e={svgID:"#svg",nodes:n.props.nodes,tracks:n.props.tracks,reads:n.props.reads},a=e.svgID,r=A.b(e.svgID),G=JSON.parse(JSON.stringify(e.nodes)),Y=JSON.parse(JSON.stringify(e.tracks)),J=e.reads||null,g=e.bed||null,K.clickableNodesFlag=e.clickableNodes||!1,K.hideLegendFlag=e.hideLegend||!1,de(),K.hideLegendFlag||Ge()},n}return Object(F.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){this.createTubeMap()}},{key:"componentDidUpdate",value:function(){this.createTubeMap()}},{key:"render",value:function(){return y.a.createElement("svg",{id:"svg"})}}]),t}(m.Component),St=L.BACKEND_URL||"http://".concat(window.location.host),Ot=function(e){function t(){var e,a;Object(x.a)(this,t);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(a=Object(O.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(o)))).state={isLoading:!0,error:null},a.getRemoteTubeMapData=Object(I.a)(N.a.mark(function e(){var t,n,r,o,s,i;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({isLoading:!0,error:null}),e.prev=1,e.next=4,fetch("".concat(St,"/getChunkedData"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a.props.fetchParams)});case 4:return t=e.sent,e.next=7,t.json();case 7:void 0===(n=e.sent).graph?(r=n.error||"Fetching remote data returned error",a.setState({error:r,isLoading:!1})):(o=$e(n.graph),s=tt(n.graph),i=nt(o,s,n.gam),a.setState({isLoading:!1,nodes:o,tracks:s,reads:i})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),a.setState({error:e.t0,isLoading:!1});case 14:case"end":return e.stop()}},e,this,[[1,11]])})),a.getExampleData=Object(I.a)(N.a.mark(function e(){var t,r,o,s,i;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({isLoading:!0,error:null}),e.next=3,n.e(1).then(n.bind(null,48));case 3:s=e.sent,t=s.inputNodes,e.t0=a.props.dataOrigin,e.next=e.t0===q.EXAMPLE_1?8:e.t0===q.EXAMPLE_2?10:e.t0===q.EXAMPLE_3?12:e.t0===q.EXAMPLE_4?14:e.t0===q.EXAMPLE_5?16:e.t0===q.EXAMPLE_6?18:23;break;case 8:return r=s.inputTracks1,e.abrupt("break",24);case 10:return r=s.inputTracks2,e.abrupt("break",24);case 12:return r=s.inputTracks3,e.abrupt("break",24);case 14:return r=s.inputTracks4,e.abrupt("break",24);case 16:return r=s.inputTracks5,e.abrupt("break",24);case 18:return i=JSON.parse(s.k3138),t=$e(i),r=tt(i),o=nt(t,r,a.readsFromStringToArray(s.demoReads)),e.abrupt("break",24);case 23:console.log("invalid data origin type");case 24:a.setState({isLoading:!1,nodes:t,tracks:r,reads:o});case 25:case"end":return e.stop()}},e,this)})),a.readsFromStringToArray=function(e){var t=e.split("\n"),n=[];return t.forEach(function(e){e.length>0&&n.push(JSON.parse(e))}),n},a}return Object(F.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){this.getRemoteTubeMapData()}},{key:"componentDidUpdate",value:function(e){this.props.dataOrigin!==e.dataOrigin?this.props.dataOrigin===q.API?this.getRemoteTubeMapData():this.getExampleData():this.props.fetchParams!==e.fetchParams&&this.getRemoteTubeMapData()}},{key:"render",value:function(){var e=this.state,t=e.isLoading,n=e.error;if(n){console.log(n);var a=n.message?n.message:n;return y.a.createElement(P.h,null,y.a.createElement(P.m,null,y.a.createElement(P.a,{color:"danger"},a)))}return t?y.a.createElement(P.h,null,y.a.createElement(P.m,null,y.a.createElement("div",{id:"loaderContainer"},y.a.createElement("div",{id:"loader"})))):y.a.createElement("div",{id:"tubeMapSVG"},y.a.createElement(xt,{nodes:this.state.nodes,tracks:this.state.tracks,reads:this.state.reads}))}}]),t}(m.Component),kt=n(32),Ft=new Map([["colorful","plainColors"],["greyscale","greys"],["reds","reds"],["blues","blues"],["pale colors","lightColors"]]),Ct=function(e){function t(){var e,n;Object(x.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(O.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).onChange=function(e){n.props.setColorSetting(n.props.trackType,Ft.get(e.target.value))},n}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this,t=Array.from(Ft).map(function(t){var n=Object(kt.a)(t,2),a=n[0],r=n[1];return y.a.createElement(P.f,{xs:"auto",key:a},y.a.createElement(P.j,{check:!0},y.a.createElement(P.l,{check:!0},y.a.createElement(P.k,{type:"radio",value:a,checked:e.props.color===r,onChange:e.onChange}),a)))});return y.a.createElement(P.j,{row:!0,className:"mb-1"},y.a.createElement(P.f,{sm:"2"},this.props.rowHeading,":"),t)}}]),t}(m.Component),Nt=function(e){function t(){var e,n;Object(x.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(O.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).state={isOpenLegend:!1,isOpenVisualizationOptions:!0},n.toggleLegend=function(e){n.setState({isOpenLegend:!n.state.isOpenLegend}),e.preventDefault()},n.toggleVisOptions=function(e){n.setState({isOpenVisualizationOptions:!n.state.isOpenVisualizationOptions}),e.preventDefault()},n}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this.props,t=e.visOptions,n=e.toggleFlag;return y.a.createElement(P.h,null,y.a.createElement("div",{id:"accordion"},y.a.createElement(P.c,null,y.a.createElement(P.e,{id:"legendCard"},y.a.createElement("h5",{className:"mb-0"},y.a.createElement("a",{href:"#collapse",onClick:this.toggleLegend},"Legend"))),y.a.createElement(P.g,{isOpen:this.state.isOpenLegend},y.a.createElement(P.d,null,y.a.createElement("div",{id:"legendDiv"})))),y.a.createElement(P.c,null,y.a.createElement(P.e,{id:"visOptionsCard"},y.a.createElement("h5",{className:"mb-0"},y.a.createElement("a",{href:"#collapse",onClick:this.toggleVisOptions},"Visualization Options"))),y.a.createElement(P.g,{isOpen:this.state.isOpenVisualizationOptions},y.a.createElement(P.d,null,y.a.createElement(P.j,null,y.a.createElement("h5",null,"General"),y.a.createElement(P.j,{check:!0},y.a.createElement(P.l,{check:!0},y.a.createElement(P.k,{type:"checkbox",checked:t.removeRedundantNodes,onChange:function(){return n("removeRedundantNodes")}}),"Remove redundant nodes")),y.a.createElement(P.j,{check:!0},y.a.createElement(P.l,{check:!0},y.a.createElement(P.k,{type:"checkbox",checked:t.compressedView,onChange:function(){return n("compressedView")}}),"Compressed view"))),y.a.createElement(P.j,null,y.a.createElement("h5",null,"Sequence Reads"),y.a.createElement(P.j,{check:!0},y.a.createElement(P.l,{check:!0},y.a.createElement(P.k,{type:"checkbox",checked:t.showReads,onChange:function(){return n("showReads")}}),"Show sequence reads")),y.a.createElement(P.j,{check:!0},y.a.createElement(P.l,{check:!0},y.a.createElement(P.k,{type:"checkbox",checked:t.showSoftClips,onChange:function(){return n("showSoftClips")}}),"Show soft clips"))),y.a.createElement("h5",null,"Colors"),y.a.createElement(P.i,null,y.a.createElement(Ct,{rowHeading:"Haplotypes",color:t.haplotypeColors,trackType:"haplotypeColors",setColorSetting:this.props.setColorSetting}),y.a.createElement(Ct,{rowHeading:"Reads (forward strand)",color:t.forwardReadColors,trackType:"forwardReadColors",setColorSetting:this.props.setColorSetting}),y.a.createElement(Ct,{rowHeading:"Reads (reverse strand)",color:t.reverseReadColors,trackType:"reverseReadColors",setColorSetting:this.props.setColorSetting})))))))}}]),t}(m.Component),It=function(e){function t(e){var n;return Object(x.a)(this,t),(n=Object(O.a)(this,Object(k.a)(t).call(this,e))).setFetchParams=function(e){n.setState({fetchParams:e,dataOrigin:q.API})},n.toggleVisOptionFlag=function(e){n.setState(function(t){return{visOptions:Object(E.a)({},t.visOptions,Object(v.a)({},e,!t.visOptions[e]))}})},n.setColorSetting=function(e,t){n.setState(function(n){return{visOptions:Object(E.a)({},n.visOptions,Object(v.a)({},e,t))}})},n.setDataOrigin=function(e){n.setState({dataOrigin:e})},n.state={fetchParams:{nodeID:"1",distance:"100",byNode:"false",xgFile:"snp1kg-BRCA1.vg.xg",gbwtFile:"",gamFile:"NA12878-BRCA1.sorted.gam",anchorTrackName:"17",dataPath:"default"},dataOrigin:q.API,visOptions:{removeRedundantNodes:!0,compressedView:!1,showReads:!0,showSoftClips:!0,haplotypeColors:"greys",forwardReadColors:"reds",reverseReadColors:"blues"}},n}return Object(F.a)(t,e),Object(S.a)(t,[{key:"componentDidUpdate",value:function(){var e,t=this.state.visOptions;t.compressedView?le(1):le(0),e=t.removeRedundantNodes,K.mergeNodesFlag!==e&&(K.mergeNodesFlag=e,r=A.b(a),de()),function(e){K.showReads!==e&&(K.showReads=e,r=A.b(a),de())}(t.showReads),function(e){K.showSoftClips!==e&&(K.showSoftClips=e,r=A.b(a),de())}(t.showSoftClips),ce("haplotypeColors",t.haplotypeColors),ce("forwardReadColors",t.forwardReadColors),ce("reverseReadColors",t.reverseReadColors)}},{key:"render",value:function(){return y.a.createElement("div",null,y.a.createElement(Et,{setFetchParams:this.setFetchParams,setDataOrigin:this.setDataOrigin,setColorSetting:this.setColorSetting,dataOrigin:this.state.dataOrigin}),y.a.createElement(Ot,{fetchParams:this.state.fetchParams,dataOrigin:this.state.dataOrigin}),y.a.createElement(Nt,{visOptions:this.state.visOptions,toggleFlag:this.toggleVisOptionFlag,setColorSetting:this.setColorSetting}))}}]),t}(m.Component);w.a.render(y.a.createElement(It,null),document.getElementById("root"))}},[[33,3,2]]]);
//# sourceMappingURL=main.31657e57.chunk.js.map