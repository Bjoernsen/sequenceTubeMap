{"version":3,"sources":["util/tubemap.js","enums.js","components/DataPositionFormRow.js","components/MountedDataFormRow.js","components/FileUploadFormRow.js","components/ExampleSelectButtons.js","components/HeaderForm.js","components/TubeMap.js","components/TubeMapContainer.js","components/RadioRow.js","components/CustomizationAccordion.js","App.js","index.js"],"names":["svgID","svg","zoom","nodes","tracks","reads","numberOfNodes","numberOfTracks","nodeMap","nodesPerOrder","maxOrder","trackForRuler","bed","dataOriginTypes","API","EXAMPLE_1","EXAMPLE_2","EXAMPLE_3","EXAMPLE_4","EXAMPLE_5","EXAMPLE_6","DEBUG","greys","blues","reds","plainColors","lightColors","haplotypeColors","forwardReadColors","reverseReadColors","exonColors","inputNodes","inputTracks","inputReads","assignments","extraLeft","extraRight","config","mergeNodesFlag","clickableNodesFlag","showExonsFlag","colorScheme","nodeWidthOption","showReads","showSoftClips","hideLegendFlag","trackRectangles","trackCurves","trackCorners","trackVerticalRectangles","trackRectanglesStep3","maxYCoordinate","minYCoordinate","maxXCoordinate","moveTrackToFirstPosition","index","unshift","splice","i","j","currentSequence","nodeName","nodesToInvert","sequence","length","charAt","substr","indexOf","push","concat","forEach","node","name","seq","split","reverse","join","straightenTrack","setColorSet","trackType","colorSet","createTubeMap","drawLegend","setNodeWidthOption","value","undefined","d3","selectAll","remove","JSON","parse","stringify","getColorSet","hasOwnProperty","type","hidden","generateNodeMap","generateTrackIndexSequences","generateNodeWidth","generateNodeSuccessors","generateNodeOrder","reverseReversedReads","nodeName2","tracksAndReads","pred","succ","Set","track","get","add","Array","from","sortedNodes","slice","sort","compareNodesByOrder","mergeOffset","Map","mergeOrigin","predecessor","mergeableWithPred","set","sequenceLength","read","firstNodeOffset","finalNodeCoverLength","mergeableWithSucc","sequenceNew","mismatches","mismatch","pos","donor","width","nodeIndex","mergeNodes","indexSequence","Math","abs","id","degree","console","log","max","order","getMaxOrder","allAreFour","round","freq","calculateTrackWidth","segmentNumber","currentNodeIndex","currentNodeIsForward","currentNode","previousNode","previousNodeIsForward","prevSegmentPerOrderPerTrack","isPositive","n","trackNo","path","lane","isForward","addToAssignment","generateSingleLaneAssignment","generateLaneAssignment","nodeStart","nodeEnd","feature","line","start","end","continue","features","addTrackFeatures","currentX","nextX","currentOrder","extra","leftSideEdges","rightSideEdges","calculateExtraSpace","x","pixelWidth","generateNodeXCoords","orderY","has","y","contentHeight","generateReadOnlyNodeAttributes","generateBasicPathsForReads","incomingReads","outgoingReads","internalReads","idx","element","pathIdx","compareReadIncomingSegmentsByComingFrom","currentY","occupiedUntil","readElement","setOccupiedUntil","maxY","compareReadOutgoingSegmentsByGoingTo","occupiedFrom","incReadElementIndices","incRead","incReadPathElement","compareInternalReads","readIdx","currentRead","heightIncrease","adjustBy","assignmentNode","aNode","trackID","segmentID","adjustVertically3","bottomY","calculateBottomY","elementsWithoutNode","readIndex","pathIndex","previousY","compareNoNodeReadsByPreviousY","segment","placeReads","xStart","xEnd","yStart","yEnd","trackColor","highlight","dummy","reversalFlag","orderStartX","orderEndX","generateTrackColor","getXCoordinateOfBaseWithinNode","getReadXStart","createFeatureRectangle","min","color","laneChange","generateForwardToReverse","generateReverseToForward","getReadXEnd","generateSVGShapesFromPath","attr","document","getElementById","substring","parentNode","offsetWidth","minZoom","scaleExtent","translateExtent","on","transform","k","svg2","clientWidth","call","append","containerWidth","xOffset","translate","alignSVG","defs","pattern","attrs","height","patternUnits","patternTransform","fill","defineSVGPatterns","drawTrackRectangles","drawTrackCurves","drawReversalsByColor","dNodes","allNodes","removeUnusedNodes","d","data","enter","nodeMouseOver","nodeMouseOut","nodeDoubleClick","style","text","drawNodes","drawLabels","rulerTrackIndex","rulerTrack","markingInterval","indexOfFirstBaseInNode","indexOfFirstBase","atLeastOneMarkingDrawn","xCoordOfPreviousMarking","firstNode","drawRulerMarking","nextMarking","ceil","xCoordOfMarking","drawRuler","trackIdx","mm","nodeY","insertionMouseOver","insertionMouseOut","drawInsertion","x2","x1","deletionMouseOver","deletionMouseOut","drawDeletion","substitutionMouseOver","substitutionMouseOut","drawSubstitution","map","a","b","segmentA","segmentB","pathIndexA","pathIndexB","nodeA","nodeB","beginDiff","pathA","pathB","idxA","idxB","is_reverse","_loop","nodeWidth","getReverseComplement","temp","seqLength","s","result","tracksOrReads","zoomBy","zoomFactor","parentElement","translateK","translateX","translateY","transition","duration","scale","current","follower","successors","predecessors","generateNodeOrderTrackBeginning","increment","anchorIndex","minOrder","increaseOrderForAllNodes","modifiedSequence","rightIndex","leftIndex","forwardOrder","backwardOrder","generateNodeOrderOfSingleTrack","uninvert","increaseOrderForSuccessors","isSuccessor","first","second","visited","stack","pop","childIndex","amount","startingNode","tabuNode","newOrder","increasedOrders","queue","_loop2","shift","successor","key","compareToFromSame","assignment","currentLane","potentialAdjustmentValues","prevNameIsNull","prevTrack","idealLane","idealY","getIdealLanesAndCoords","compareByIdealLane","topLane","verticalAdjustment","minAdjustmentCost","Number","MAX_SAFE_INTEGER","moveBy","getVerticalAdjustmentCost","adjustVertically","colorSetName","base","nodeLeftX","nodeRightX","nodeXStart","nodeXEnd","rectXStart","c","co","featureXStart","featureXEnd","currentHighlight","trackWidth","yTop","yBottom","corners","rectangles","rect","filter","filterObjectByAttribute","trackMouseOver","trackMouseOut","trackDoubleClick","drawTrackCorners","sequencePosition","xCoordinate","attribute","item","compareCurvesByLineChanges","myTrackCurves","curve","xMiddle","content","listeners","innerHTML","addEventListener","changeTrackVisibility","this","each","nodeID","click","vgExtractNodes","vg","getComputedTextLength","vgExtractTracks","isCompletelyReverse","mapping","position","node_id","index2","vgExtractReads","myNodes","myTracks","myReads","extracted","nodeNames","_loop3","firstIndex","lastIndex","edit","offset","toString","parseInt","posWithinNode","from_length","finalNodeEdit","predecessorIndex","successorIndex","ZOOM_FACTOR","DataPositionFormRow","handleZoomIn","tubeMap","handleZoomOut","handleDownloadButton","svgN","svgData","XMLSerializer","serializeToString","svgBlob","Blob","svgUrl","URL","createObjectURL","downloadLink","createElement","href","download","body","appendChild","removeChild","react_default","reactstrap_es","inline","className","for","size","props","onChange","handleInputChange","distance","byNode","uploadInProgress","onClick","handleGoButton","disabled","handleGoLeft","index_es","icon","faStepBackward","faSearchPlus","faSearchMinus","handleGoRight","faStepForward","Component","MountedDataFormRow","xgFileDropdownOptions","xgSelectOptions","fileName","gbwtFileDropdownOptions","gbwtSelectOptions","gamFileDropdownOptions","gamSelectOptions","pathDropdownOptions","pathSelectOptions","pathName","Fragment","xgSelect","gbwtSelect","gamSelect","pathSelect","BACKEND_URL","window","location","host","MAX_UPLOAD_SIZE","FileUploadFormRow","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","onXgFileChange","file","xgFileInput","files","resetPathNames","handleFileUpload","showFileSizeAlert","setUploadInProgress","formData","FormData","xhr","XMLHttpRequest","responseType","onreadystatechange","readyState","status","response","getPathNames","open","send","onGbwtFileChange","gbwtFileInput","onGamFileChange","gamFileInput","React","createRef","accept","innerRef","ExampleSelectButtons","handleClick","dataOrigin","haploColor","readColor","setDataOrigin","setColorSetting","_this2","DATA_SOURCES","defaultConfig","dataTypes","BUILT_IN","FILE_UPLOAD","MOUNTED_FILES","EXAMPLES","HeaderForm","state","xgFile","gbwtFile","gamFile","anchorTrackName","dataPath","dataType","fileSizeAlert","getMountedFilenames","_callee","json","regenerator_default","wrap","_context","prev","next","fetch","method","headers","Content-Type","sent","xgFiles","gbwtFiles","gamIndices","setState","includes","t0","stop","_callee2","isUploadedFile","_context2","pathNames","handleDataSourceChange","event","target","ds","useMountedPath","defaultPosition","fetchParams","setFetchParams","defineProperty","fileType","val","setUpWebsocket","ws","WebSocket","replace","onmessage","message","onclose","setTimeout","onerror","close","dataSourceDropdownOptions","mountedFilesFlag","uploadFilesFlag","examplesFlag","fluid","md","src","alt","components_MountedDataFormRow","components_FileUploadFormRow","isOpen","toggle","components_ExampleSelectButtons","components_DataPositionFormRow","TubeMap","params","clickableNodes","hideLegend","TubeMapContainer","isLoading","error","getRemoteTubeMapData","graph","gam","getExampleData","__webpack_require__","e","then","bind","inputTracks1","abrupt","inputTracks2","inputTracks3","inputTracks4","inputTracks5","k3138","readsFromStringToArray","demoReads","readsString","lines","prevProps","_this$state","components_TubeMap","colorMap","RadioRow","colorRadios","_ref","_ref2","slicedToArray","keyColor","valueColor","xs","check","checked","row","sm","rowHeading","VisualizationOptions","isOpenLegend","isOpenVisualizationOptions","toggleLegend","preventDefault","toggleVisOptions","_this$props","visOptions","toggleFlag","removeRedundantNodes","compressedView","components_RadioRow","App","toggleVisOptionFlag","flagName","objectSpread","components_HeaderForm","components_TubeMapContainer","CustomizationAccordion","ReactDOM","render","src_App_0"],"mappings":"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","file":"static/js/main.56f1da2f.chunk.js","sourcesContent":["/* eslint no-param-reassign: \"off\" */\n/* eslint no-lonely-if: \"off\" */\n/* eslint no-prototype-builtins: \"off\" */\n/* eslint no-console: \"off\" */\n/* eslint no-continue: \"off\" */\n\n/* eslint max-len: \"off\" */\n/* eslint no-loop-func: \"off\" */\n/* eslint no-unused-vars: \"off\" */\n/* eslint no-return-assign: \"off\" */\nimport * as d3 from 'd3';\nimport 'd3-selection-multi';\n\nconst DEBUG = false;\n\nconst greys = [\n  '#d9d9d9',\n  '#bdbdbd',\n  '#969696',\n  '#737373',\n  '#525252',\n  '#252525',\n  '#000000'\n];\n\nconst blues = [\n  '#c6dbef',\n  '#9ecae1',\n  '#6baed6',\n  '#4292c6',\n  '#2171b5',\n  '#08519c',\n  '#08306b'\n];\n\nconst reds = [\n  '#fcbba1',\n  '#fc9272',\n  '#fb6a4a',\n  '#ef3b2c',\n  '#cb181d',\n  '#a50f15',\n  '#67000d'\n];\n\n// d3 category10\nconst plainColors = [\n  '#1f77b4',\n  '#ff7f0e',\n  '#2ca02c',\n  '#d62728',\n  '#9467bd',\n  '#8c564b',\n  '#e377c2',\n  '#7f7f7f',\n  '#bcbd22',\n  '#17becf'\n];\n\n// d3 category10\nconst lightColors = [\n  '#ABCCE3',\n  '#FFCFA5',\n  '#B0DBB0',\n  '#F0AEAE',\n  '#D7C6E6',\n  '#C6ABA5',\n  '#F4CCE8',\n  '#CFCFCF',\n  '#E6E6AC',\n  '#A8E7ED'\n];\n\nlet haplotypeColors = [];\nlet forwardReadColors = [];\nlet reverseReadColors = [];\nlet exonColors = [];\n\nlet svgID; // the (html-tag) ID of the svg\nlet svg; // the svg\nexport let zoom; // eslint-disable-line import/no-mutable-exports\nlet inputNodes = [];\nlet inputTracks = [];\nlet inputReads = [];\nlet nodes;\nlet tracks;\nlet reads;\nlet numberOfNodes;\nlet numberOfTracks;\nlet nodeMap; // maps node names to node indices\nlet nodesPerOrder;\nlet assignments = []; // contains info about lane assignments sorted by order\nlet extraLeft = []; // info whether nodes have to be moved further apart because of multiple 180° directional changes at the same horizontal order\nlet extraRight = []; // info whether nodes have to be moved further apart because of multiple 180° directional changes at the same horizontal order\nlet maxOrder; // horizontal order of the rightmost node\n\nconst config = {\n  mergeNodesFlag: true,\n  clickableNodesFlag: false,\n  showExonsFlag: false,\n  colorScheme: 0,\n  // Options for the width of sequence nodes:\n  // 0...scale node width linear with number of bases within node\n  // 1...scale node width with log2 of number of bases within node\n  // 2...scale node width with log10 of number of bases within node\n  nodeWidthOption: 0,\n  showReads: true,\n  showSoftClips: true,\n  haplotypeColors: 'greys',\n  forwardReadColors: 'reds',\n  reverseReadColors: 'blues',\n  exonColors: 'lightColors',\n  hideLegendFlag: false\n};\n\n// variables for storing info which can be directly translated into drawing instructions\nlet trackRectangles = [];\nlet trackCurves = [];\nlet trackCorners = [];\nlet trackVerticalRectangles = []; // stored separately from horizontal rectangles. This allows drawing them in a separate step -> avoids issues with wrong overlapping\nlet trackRectanglesStep3 = [];\n\nlet maxYCoordinate = 0;\nlet minYCoordinate = 0;\nlet maxXCoordinate = 0;\nlet trackForRuler;\n\nlet bed;\n\n// main function to call from outside\n// which starts the process of creating a tube map visualization\nexport function create(params) {\n  // mandatory parameters: svgID, nodes, tracks\n  // optional parameters: bed, clickableNodes, reads, showLegend\n  svgID = params.svgID;\n  svg = d3.select(params.svgID);\n  inputNodes = JSON.parse(JSON.stringify(params.nodes)); // deep copy\n  inputTracks = JSON.parse(JSON.stringify(params.tracks)); // deep copy\n  inputReads = params.reads || null;\n  bed = params.bed || null;\n  config.clickableNodesFlag = params.clickableNodes || false;\n  config.hideLegendFlag = params.hideLegend || false;\n  const tr = createTubeMap();\n  if (!config.hideLegendFlag) drawLegend(tr);\n}\n\n// moves a specific track to the top\nfunction moveTrackToFirstPosition(index) {\n  inputTracks.unshift(inputTracks[index]); // add element to beginning\n  inputTracks.splice(index + 1, 1); // remove 1 element from the middle\n  straightenTrack(0);\n}\n\n// straighten track given by index by inverting inverted nodes\n// only keep them inverted if this single track runs thrugh them in both directions\nfunction straightenTrack(index) {\n  let i;\n  let j;\n  const nodesToInvert = [];\n  let currentSequence;\n  let nodeName;\n\n  // find out which nodes should be inverted\n  currentSequence = inputTracks[index].sequence;\n  for (i = 0; i < currentSequence.length; i += 1) {\n    if (currentSequence[i].charAt(0) === '-') {\n      nodeName = currentSequence[i].substr(1);\n      if (\n        currentSequence.indexOf(nodeName) === -1 ||\n        currentSequence.indexOf(nodeName) > i\n      ) {\n        // only if this inverted node is no repeat\n        nodesToInvert.push(currentSequence[i].substr(1));\n      }\n    }\n  }\n\n  // invert nodes in the tracks' sequence\n  for (i = 0; i < inputTracks.length; i += 1) {\n    currentSequence = inputTracks[i].sequence;\n    for (j = 0; j < currentSequence.length; j += 1) {\n      if (currentSequence[j].charAt(0) !== '-') {\n        if (nodesToInvert.indexOf(currentSequence[j]) !== -1) {\n          currentSequence[j] = `-${currentSequence[j]}`;\n        }\n      } else if (nodesToInvert.indexOf(currentSequence[j].substr(1)) !== -1) {\n        currentSequence[j] = currentSequence[j].substr(1);\n      }\n    }\n  }\n\n  // invert the sequence within the nodes\n  inputNodes.forEach(node => {\n    if (nodesToInvert.indexOf(node.name) !== -1) {\n      node.seq = node.seq\n        .split('')\n        .reverse()\n        .join('');\n    }\n  });\n}\n\nexport function changeTrackVisibility(trackID) {\n  let i = 0;\n  while (i < inputTracks.length && inputTracks[i].id !== trackID) i += 1;\n  if (i < inputTracks.length) {\n    if (inputTracks[i].hasOwnProperty('hidden')) {\n      inputTracks[i].hidden = !inputTracks[i].hidden;\n    } else {\n      inputTracks[i].hidden = true;\n    }\n  }\n  createTubeMap();\n}\n\nexport function changeExonVisibility() {\n  config.showExonsFlag = !config.showExonsFlag;\n  createTubeMap();\n}\n\n// sets the flag for whether redundant nodes should be automatically removed or not\nexport function setMergeNodesFlag(value) {\n  if (config.mergeNodesFlag !== value) {\n    config.mergeNodesFlag = value;\n    svg = d3.select(svgID);\n    createTubeMap();\n  }\n}\n\n// sets the flag for whether read soft clips should be displayed or not\nexport function setSoftClipsFlag(value) {\n  if (config.showSoftClips !== value) {\n    config.showSoftClips = value;\n    svg = d3.select(svgID);\n    createTubeMap();\n  }\n}\n\n// sets the flag for whether reads should be displayed or not\nexport function setShowReadsFlag(value) {\n  if (config.showReads !== value) {\n    config.showReads = value;\n    svg = d3.select(svgID);\n    createTubeMap();\n  }\n}\n\nexport function setColorSet(trackType, colorSet) {\n  if (config[trackType] !== colorSet) {\n    config[trackType] = colorSet;\n    const tr = createTubeMap();\n    if (!config.hideLegendFlag) drawLegend(tr);\n  }\n}\n\n// sets which option should be used for calculating the node width from its sequence length\nexport function setNodeWidthOption(value) {\n  if (value === 0 || value === 1 || value === 2) {\n    if (config.nodeWidthOption !== value) {\n      config.nodeWidthOption = value;\n      if (svg !== undefined) {\n        svg = d3.select(svgID);\n        createTubeMap();\n      }\n    }\n  }\n}\n\n// main\nfunction createTubeMap() {\n  trackRectangles = [];\n  trackCurves = [];\n  trackCorners = [];\n  trackVerticalRectangles = [];\n  trackRectanglesStep3 = [];\n  assignments = [];\n  extraLeft = [];\n  extraRight = [];\n  maxYCoordinate = 0;\n  minYCoordinate = 0;\n  maxXCoordinate = 0;\n  trackForRuler = undefined;\n  svg = d3.select(svgID);\n  svg.selectAll('*').remove(); // clear svg for (re-)drawing\n\n  nodes = JSON.parse(JSON.stringify(inputNodes)); // deep copy (can add stuff to copy and leave original unchanged)\n  tracks = JSON.parse(JSON.stringify(inputTracks));\n  reads = JSON.parse(JSON.stringify(inputReads));\n\n  // early exit is necessary when visualization options such as colors are\n  // changed before any graph has been rendered\n  if (nodes.length === 0 || tracks.length === 0) return;\n\n  assignColorSets();\n\n  for (let i = tracks.length - 1; i >= 0; i -= 1) {\n    if (!tracks[i].hasOwnProperty('type')) {\n      // TODO: maybe remove \"haplo\"-property?\n      tracks[i].type = 'haplo';\n    }\n    if (tracks[i].hasOwnProperty('hidden')) {\n      if (tracks[i].hidden === true) {\n        tracks.splice(i, 1);\n      }\n    }\n    if (tracks[i].hasOwnProperty('indexOfFirstBase')) {\n      trackForRuler = tracks[i].name;\n    }\n  }\n\n  nodeMap = generateNodeMap(nodes);\n  generateTrackIndexSequences(tracks);\n  if (reads && config.showReads) generateTrackIndexSequences(reads);\n  generateNodeWidth();\n\n  if (reads && config.mergeNodesFlag) {\n    generateNodeSuccessors(); // requires indexSequence\n    generateNodeOrder(); // requires successors\n    if (reads && config.showReads) reverseReversedReads();\n    mergeNodes();\n    nodeMap = generateNodeMap(nodes);\n    generateNodeWidth();\n    generateTrackIndexSequences(tracks);\n    if (reads && config.showReads) generateTrackIndexSequences(reads);\n  }\n\n  numberOfNodes = nodes.length;\n  numberOfTracks = tracks.length;\n  generateNodeSuccessors();\n  generateNodeDegree();\n  if (DEBUG) console.log(`${numberOfNodes} nodes.`);\n  generateNodeOrder();\n  maxOrder = getMaxOrder();\n\n  // can cause problems when there is a reversed single track node\n  // OTOH, can solve problems with complex inversion patterns\n  // switchNodeOrientation();\n  // generateNodeOrder(nodes, tracks);\n  // maxOrder = getMaxOrder();\n\n  calculateTrackWidth(tracks);\n  generateLaneAssignment();\n\n  if (config.showExonsFlag === true && bed !== null) addTrackFeatures();\n  generateNodeXCoords();\n\n  if (reads && config.showReads) {\n    generateReadOnlyNodeAttributes();\n    reverseReversedReads();\n    generateTrackIndexSequences(reads);\n    placeReads();\n    tracks = tracks.concat(reads);\n  }\n\n  generateSVGShapesFromPath(nodes, tracks);\n  if (DEBUG) {\n    console.log('Tracks:');\n    console.log(tracks);\n    console.log('Nodes:');\n    console.log(nodes);\n    console.log('Lane assignment:');\n    console.log(assignments);\n  }\n  getImageDimensions();\n  alignSVG(nodes, tracks);\n  defineSVGPatterns();\n\n  drawTrackRectangles(trackRectangles);\n  drawTrackCurves();\n  drawReversalsByColor(trackCorners, trackVerticalRectangles);\n  drawTrackRectangles(trackRectanglesStep3);\n  drawTrackRectangles(trackRectangles, 'read');\n  drawTrackCurves('read');\n\n  // draw only those nodes which have coords assigned to them\n  const dNodes = removeUnusedNodes(nodes);\n  drawNodes(dNodes);\n  drawReversalsByColor(trackCorners, trackVerticalRectangles, 'read');\n  if (config.nodeWidthOption === 0) drawLabels(dNodes);\n  if (trackForRuler !== undefined) drawRuler();\n  if (config.nodeWidthOption === 0) drawMismatches(); // TODO: call this before drawLabels and fix d3 data/append/enter stuff\n  if (DEBUG) {\n    console.log(`number of tracks: ${numberOfTracks}`);\n    console.log(`number of nodes: ${numberOfNodes}`);\n  }\n  return tracks;\n}\n\n// generates attributes (node.y, node.contentHeight) for nodes without tracks, only reads\nfunction generateReadOnlyNodeAttributes() {\n  nodesPerOrder = [];\n  for (let i = 0; i <= maxOrder; i += 1) {\n    nodesPerOrder[i] = [];\n  }\n\n  const orderY = new Map();\n  nodes.forEach(node => {\n    if (node.hasOwnProperty('order') && node.hasOwnProperty('y')) {\n      if (orderY.has(node.order)) {\n        orderY.set(\n          node.order,\n          Math.max(node.y + node.contentHeight, orderY.get(node.order))\n        );\n      } else {\n        orderY.set(node.order, node.y + node.contentHeight);\n      }\n    }\n  });\n\n  nodes.forEach((node, i) => {\n    if (node.hasOwnProperty('order') && !node.hasOwnProperty('y')) {\n      node.y = orderY.get(node.order) + 25;\n      node.contentHeight = 0;\n      nodesPerOrder[node.order].push(i);\n    }\n  });\n}\n\n// add info about reads to nodes (incoming, outgoing and internal reads)\nfunction assignReadsToNodes() {\n  nodes.forEach(node => {\n    node.incomingReads = [];\n    node.outgoingReads = [];\n    node.internalReads = [];\n  });\n  reads.forEach((read, idx) => {\n    read.width = 7;\n    if (read.path.length === 1) {\n      nodes[read.path[0].node].internalReads.push(idx);\n    } else {\n      read.path.forEach((element, pathIdx) => {\n        if (pathIdx === 0) {\n          nodes[read.path[0].node].outgoingReads.push([idx, pathIdx]);\n        } else if (read.path[pathIdx].node !== null) {\n          nodes[read.path[pathIdx].node].incomingReads.push([idx, pathIdx]);\n        }\n      });\n    }\n  });\n}\n\nfunction removeNonPathNodesFromReads() {\n  reads.forEach(read => {\n    for (let i = read.sequence.length - 1; i >= 0; i -= 1) {\n      let nodeName = read.sequence[i];\n      if (nodeName.charAt(0) === '-') {\n        nodeName = nodeName.substr(1);\n      }\n      if (!nodeMap.has(nodeName) || nodes[nodeMap.get(nodeName)].degree === 0) {\n        read.sequence.splice(i, 1);\n      }\n    }\n  });\n}\n\n// calculate paths (incl. correct y coordinate) for all reads\nfunction placeReads() {\n  generateBasicPathsForReads();\n  assignReadsToNodes();\n\n  // sort nodes by order, then by y-coordinate\n  const sortedNodes = nodes.slice();\n  sortedNodes.sort(compareNodesByOrder);\n\n  // iterate over all nodes\n  sortedNodes.forEach(node => {\n    // sort incoming reads\n    node.incomingReads.sort(compareReadIncomingSegmentsByComingFrom);\n\n    // place incoming reads\n    let currentY = node.y + node.contentHeight;\n    const occupiedUntil = new Map();\n    node.incomingReads.forEach(readElement => {\n      reads[readElement[0]].path[readElement[1]].y = currentY;\n      setOccupiedUntil(\n        occupiedUntil,\n        reads[readElement[0]],\n        readElement[1],\n        currentY,\n        node\n      );\n      currentY += 7;\n    });\n    let maxY = currentY;\n\n    // sort outgoing reads\n    node.outgoingReads.sort(compareReadOutgoingSegmentsByGoingTo);\n\n    // place outgoing reads\n    const occupiedFrom = new Map();\n    currentY = node.y + node.contentHeight;\n    node.outgoingReads.forEach(readElement => {\n      // place in next lane\n      reads[readElement[0]].path[readElement[1]].y = currentY;\n      occupiedFrom.set(currentY, reads[readElement[0]].firstNodeOffset);\n      // if no conflicts\n      if (\n        !occupiedUntil.has(currentY) ||\n        occupiedUntil.get(currentY) + 1 < reads[readElement[0]].firstNodeOffset\n      ) {\n        currentY += 7;\n        maxY = Math.max(maxY, currentY);\n      } else {\n        // otherwise push down incoming reads to make place for outgoing Read\n        occupiedUntil.set(currentY, 0);\n        node.incomingReads.forEach(incReadElementIndices => {\n          const incRead = reads[incReadElementIndices[0]];\n          const incReadPathElement = incRead.path[incReadElementIndices[1]];\n          if (incReadPathElement.y >= currentY) {\n            incReadPathElement.y += 7;\n            setOccupiedUntil(\n              occupiedUntil,\n              incRead,\n              incReadElementIndices[1],\n              incReadPathElement.y,\n              node\n            );\n          }\n        });\n        currentY += 7;\n        maxY += 7;\n      }\n    });\n\n    // sort internal reads\n    node.internalReads.sort(compareInternalReads);\n\n    // place internal reads\n    node.internalReads.forEach(readIdx => {\n      const currentRead = reads[readIdx];\n      currentY = node.y + node.contentHeight;\n      while (\n        currentRead.firstNodeOffset < occupiedUntil.get(currentY) + 2 ||\n        currentRead.finalNodeCoverLength > occupiedFrom.get(currentY) - 3\n      ) {\n        currentY += 7;\n      }\n      currentRead.path[0].y = currentY;\n      occupiedUntil.set(currentY, currentRead.finalNodeCoverLength);\n      maxY = Math.max(maxY, currentY);\n    });\n\n    // adjust node height and move other nodes vertically down\n    const heightIncrease = maxY - node.y - node.contentHeight;\n    node.contentHeight += heightIncrease;\n    adjustVertically3(node, heightIncrease);\n  });\n\n  // place read segments which are without node\n  const bottomY = calculateBottomY();\n  const elementsWithoutNode = [];\n  reads.forEach((read, idx) => {\n    read.path.forEach((element, pathIdx) => {\n      if (!element.hasOwnProperty('y')) {\n        elementsWithoutNode.push({\n          readIndex: idx,\n          pathIndex: pathIdx,\n          previousY: reads[idx].path[pathIdx - 1].y\n        });\n      }\n    });\n  });\n  elementsWithoutNode.sort(compareNoNodeReadsByPreviousY);\n  elementsWithoutNode.forEach(element => {\n    const segment = reads[element.readIndex].path[element.pathIndex];\n    segment.y = bottomY[segment.order];\n    bottomY[segment.order] += reads[element.readIndex].width;\n  });\n\n  if (DEBUG) {\n    console.log('Reads:');\n    console.log(reads);\n  }\n}\n\n// keeps track of where reads end within nodes\nfunction setOccupiedUntil(map, read, pathIndex, y, node) {\n  if (pathIndex === read.path.length - 1) {\n    // last node of current read\n    map.set(y, read.finalNodeCoverLength);\n  } else {\n    // read covers the whole node\n    map.set(y, node.sequenceLength);\n  }\n}\n\n// compare read segments which are outside of nodes\n// by the y-coord of where they are coming from\nfunction compareNoNodeReadsByPreviousY(a, b) {\n  const segmentA = reads[a.readIndex].path[a.pathIndex];\n  const segmentB = reads[b.readIndex].path[b.pathIndex];\n  if (segmentA.order === segmentB.order) {\n    return a.previousY - b.previousY;\n  }\n  return segmentA.order - segmentB.order;\n}\n\n// compare read segments by where they are going to\nfunction compareReadOutgoingSegmentsByGoingTo(a, b) {\n  let pathIndexA = a[1];\n  let pathIndexB = b[1];\n  // let readA = reads[a[0]]\n  // let nodeIndexA = readA.path[pathIndexA].node;\n  let nodeA = nodes[reads[a[0]].path[pathIndexA].node];\n  let nodeB = nodes[reads[b[0]].path[pathIndexB].node];\n  while (nodeA !== null && nodeB !== null && nodeA === nodeB) {\n    if (pathIndexA < reads[a[0]].path.length - 1) {\n      pathIndexA += 1;\n      while (reads[a[0]].path[pathIndexA].node === null) pathIndexA += 1; // skip null nodes in path\n      nodeA = nodes[reads[a[0]].path[pathIndexA].node];\n    } else {\n      nodeA = null;\n    }\n    if (pathIndexB < reads[b[0]].path.length - 1) {\n      pathIndexB += 1;\n      while (reads[b[0]].path[pathIndexB].node === null) pathIndexB += 1; // skip null nodes in path\n      nodeB = nodes[reads[b[0]].path[pathIndexB].node];\n    } else {\n      nodeB = null;\n    }\n  }\n  if (nodeA !== null) {\n    if (nodeB !== null) return compareNodesByOrder(nodeA, nodeB);\n    return 1; // nodeB is null, nodeA not null\n  }\n  if (nodeB !== null) return -1; // nodeB not null, nodeA null\n  // both nodes are null -> both end in the same node\n  const beginDiff = reads[a[0]].firstNodeOffset - reads[b[0]].firstNodeOffset;\n  if (beginDiff !== 0) return beginDiff;\n  // break tie: both reads cover the same nodes and begin at the same position -> compare by endPosition\n  return reads[a[0]].finalNodeCoverLength - reads[b[0]].finalNodeCoverLength;\n}\n\n// compare read segments by (y-coord of) where they are coming from\nfunction compareReadIncomingSegmentsByComingFrom(a, b) {\n  // TODO: incoming from reversal (u-turn)\n  const pathA = reads[a[0]].path[a[1] - 1];\n  const pathB = reads[b[0]].path[b[1] - 1];\n  if (pathA.hasOwnProperty('y')) {\n    if (pathB.hasOwnProperty('y')) {\n      return pathA.y - pathB.y; // a and b have y-property\n    }\n    return -1; // only a has y-property\n  }\n  if (pathB.hasOwnProperty('y')) {\n    return 1; // only b has y-property\n  }\n  return compareReadIncomingSegmentsByComingFrom(\n    [a[0], a[1] - 1],\n    [b[0], b[1] - 1]\n  ); // neither has y-property\n}\n\n// compare 2 reads which are completely within a single node\nfunction compareInternalReads(idxA, idxB) {\n  const a = reads[idxA];\n  const b = reads[idxB];\n  // compare by first base within first node\n  if (a.firstNodeOffset < b.firstNodeOffset) return -1;\n  else if (a.firstNodeOffset > b.firstNodeOffset) return 1;\n\n  // compare by last base within last node\n  if (a.finalNodeCoverLength < b.finalNodeCoverLength) return -1;\n  else if (a.finalNodeCoverLength > b.finalNodeCoverLength) return 1;\n\n  return 0;\n}\n\n// determine biggest y-coordinate for each order-value\nfunction calculateBottomY() {\n  const bottomY = [];\n  for (let i = 0; i <= maxOrder; i += 1) {\n    bottomY.push(0);\n  }\n\n  nodes.forEach(node => {\n    bottomY[node.order] = Math.max(\n      bottomY[node.order],\n      node.y + node.contentHeight + 20\n    );\n  });\n\n  tracks.forEach(track => {\n    track.path.forEach(element => {\n      bottomY[element.order] = Math.max(\n        bottomY[element.order],\n        element.y + track.width\n      );\n    });\n  });\n  return bottomY;\n}\n\n// generate path-info for each read\n// containing order, node and orientation, but no concrete coordinates\nfunction generateBasicPathsForReads() {\n  let currentNodeIndex;\n  let currentNodeIsForward;\n  let currentNode;\n  let previousNode;\n  let previousNodeIsForward;\n  const isPositive = n => ((n = +n) || 1 / n) >= 0;\n\n  reads.forEach(read => {\n    // add info for start of track\n    currentNodeIndex = Math.abs(read.indexSequence[0]);\n    currentNodeIsForward = isPositive(read.indexSequence[0]);\n    currentNode = nodes[currentNodeIndex];\n\n    read.path = [];\n    read.path.push({\n      order: currentNode.order,\n      isForward: currentNodeIsForward,\n      node: currentNodeIndex\n    });\n\n    for (let i = 1; i < read.sequence.length; i += 1) {\n      previousNode = currentNode;\n      previousNodeIsForward = currentNodeIsForward;\n\n      currentNodeIndex = Math.abs(read.indexSequence[i]);\n      currentNodeIsForward = isPositive(read.indexSequence[i]);\n      currentNode = nodes[currentNodeIndex];\n\n      if (currentNode.order > previousNode.order) {\n        if (!previousNodeIsForward) {\n          // backward to forward at previous node\n          read.path.push({\n            order: previousNode.order,\n            isForward: true,\n            node: null\n          });\n        }\n        for (let j = previousNode.order + 1; j < currentNode.order; j += 1) {\n          // forward without nodes\n          read.path.push({ order: j, isForward: true, node: null });\n        }\n        if (!currentNodeIsForward) {\n          // forward to backward at current node\n          read.path.push({\n            order: currentNode.order,\n            isForward: true,\n            node: null\n          });\n          read.path.push({\n            order: currentNode.order,\n            isForward: false,\n            node: currentNodeIndex\n          });\n        } else {\n          // current Node forward\n          read.path.push({\n            order: currentNode.order,\n            isForward: true,\n            node: currentNodeIndex\n          });\n        }\n      } else if (currentNode.order < previousNode.order) {\n        if (previousNodeIsForward) {\n          // turnaround from fw to bw at previous node\n          read.path.push({\n            order: previousNode.order,\n            isForward: false,\n            node: null\n          });\n        }\n        for (let j = previousNode.order - 1; j > currentNode.order; j -= 1) {\n          // bachward without nodes\n          read.path.push({ order: j, isForward: false, node: null });\n        }\n        if (currentNodeIsForward) {\n          // backward to forward at current node\n          read.path.push({\n            order: currentNode.order,\n            isForward: false,\n            node: null\n          });\n          read.path.push({\n            order: currentNode.order,\n            isForward: true,\n            node: currentNodeIndex\n          });\n        } else {\n          // backward at current node\n          read.path.push({\n            order: currentNode.order,\n            isForward: false,\n            node: currentNodeIndex\n          });\n        }\n      } else {\n        if (currentNodeIsForward !== previousNodeIsForward) {\n          read.path.push({\n            order: currentNode.order,\n            isForward: currentNodeIsForward,\n            node: currentNodeIndex\n          });\n        } else {\n          read.path.push({\n            order: currentNode.order,\n            isForward: !currentNodeIsForward,\n            node: null\n          });\n          read.path.push({\n            order: currentNode.order,\n            isForward: currentNodeIsForward,\n            node: currentNodeIndex\n          });\n        }\n      }\n    }\n  });\n}\n\n// reverse reads which are reversed\nfunction reverseReversedReads() {\n  reads.forEach(read => {\n    let pos = 0;\n    while (pos < read.sequence.length && read.sequence[pos].charAt(0) === '-') {\n      pos += 1;\n    }\n    if (pos === read.sequence.length) {\n      // completely reversed read\n      read.is_reverse = true;\n      read.sequence = read.sequence.reverse(); // invert sequence\n      for (let i = 0; i < read.sequence.length; i += 1) {\n        read.sequence[i] = read.sequence[i].substr(1); // remove '-'\n      }\n\n      read.sequenceNew = read.sequenceNew.reverse(); // invert sequence\n      for (let i = 0; i < read.sequenceNew.length; i += 1) {\n        read.sequenceNew[i].nodeName = read.sequenceNew[i].nodeName.substr(1); // remove '-'\n        const nodeWidth =\n          nodes[nodeMap.get(read.sequenceNew[i].nodeName)].width;\n        read.sequenceNew[i].mismatches.forEach(mm => {\n          if (mm.type === 'insertion') {\n            mm.pos = nodeWidth - mm.pos;\n            mm.seq = getReverseComplement(mm.seq);\n          } else if (mm.type === 'deletion') {\n            mm.pos = nodeWidth - mm.pos - mm.length;\n          } else if (mm.type === 'substitution') {\n            mm.pos = nodeWidth - mm.pos - mm.seq.length;\n            mm.seq = getReverseComplement(mm.seq);\n          }\n          if (mm.hasOwnProperty('seq')) {\n            mm.seq = mm.seq\n              .split('')\n              .reverse()\n              .join('');\n          }\n        });\n      }\n\n      // adjust firstNodeOffset and finalNodeCoverLength\n      const temp = read.firstNodeOffset;\n      let seqLength = nodes[nodeMap.get(read.sequence[0])].sequenceLength;\n      read.firstNodeOffset = seqLength - read.finalNodeCoverLength;\n      seqLength =\n        nodes[nodeMap.get(read.sequence[read.sequence.length - 1])]\n          .sequenceLength;\n      read.finalNodeCoverLength = seqLength - temp;\n    }\n  });\n}\n\nfunction getReverseComplement(s) {\n  let result = '';\n  for (let i = s.length - 1; i >= 0; i -= 1) {\n    switch (s.charAt(i)) {\n      case 'A':\n        result += 'T';\n        break;\n      case 'T':\n        result += 'A';\n        break;\n      case 'C':\n        result += 'G';\n        break;\n      case 'G':\n        result += 'C';\n        break;\n      default:\n        result += 'N';\n    }\n  }\n  return result;\n}\n\n// for each track: generate sequence of node indices from seq. of node names\nfunction generateTrackIndexSequencesNEW(tracksOrReads) {\n  tracksOrReads.forEach(track => {\n    track.indexSequence = [];\n    track.sequence.forEach(edit => {\n      if (edit.nodeName.charAt(0) === '-') {\n        track.indexSequence.push(-nodeMap.get(edit.nodeName.substr(1)));\n      } else {\n        track.indexSequence.push(nodeMap.get(edit.nodeName));\n      }\n    });\n  });\n}\n\n// for each track: generate sequence of node indices from seq. of node names\nfunction generateTrackIndexSequences(tracksOrReads) {\n  tracksOrReads.forEach(track => {\n    track.indexSequence = [];\n    track.sequence.forEach(nodeName => {\n      if (nodeName.charAt(0) === '-') {\n        track.indexSequence.push(-nodeMap.get(nodeName.substr(1)));\n      } else {\n        track.indexSequence.push(nodeMap.get(nodeName));\n      }\n    });\n  });\n}\n\n// remove nodes with no tracks moving through them to avoid d3.js errors\nfunction removeUnusedNodes(allNodes) {\n  const dNodes = allNodes.slice(0);\n  let i;\n  for (i = dNodes.length - 1; i >= 0; i -= 1) {\n    if (!dNodes[i].hasOwnProperty('x')) {\n      dNodes.splice(i, 1);\n    }\n  }\n  return dNodes;\n}\n\n// get the minimum and maximum coordinates used in the image to calculate image dimensions\nfunction getImageDimensions() {\n  maxXCoordinate = -99;\n  minYCoordinate = 99;\n  maxYCoordinate = -99;\n\n  nodes.forEach(node => {\n    if (node.hasOwnProperty('x')) {\n      maxXCoordinate = Math.max(maxXCoordinate, node.x + 20 + node.pixelWidth);\n    }\n    if (node.hasOwnProperty('y')) {\n      minYCoordinate = Math.min(minYCoordinate, node.y - 10);\n      maxYCoordinate = Math.max(\n        maxYCoordinate,\n        node.y + node.contentHeight + 10\n      );\n    }\n  });\n\n  tracks.forEach(track => {\n    track.path.forEach(segment => {\n      maxYCoordinate = Math.max(maxYCoordinate, segment.y + track.width);\n      minYCoordinate = Math.min(minYCoordinate, segment.y);\n    });\n  });\n}\n\n// align visualization to the top and left within svg and resize svg to correct size\n// enable zooming and panning\nfunction alignSVG() {\n  svg.attr('height', maxYCoordinate - minYCoordinate + 50);\n  svg.attr(\n    'width',\n    document.getElementById(svgID.substring(1)).parentNode.offsetWidth\n  );\n\n  function zoomed() {\n    const transform = d3.event.transform;\n    // vertical adjustment so that top of graph is at top of svg\n    // otherwise would violate translateExtent, which leads to graph \"jumping\" on next pan\n    transform.y = (25 - minYCoordinate) * transform.k;\n    svg.attr('transform', transform);\n    const svg2 = d3.select(svgID);\n    // adjust height, so that vertical scroll bar is shown when necessary\n    svg2.attr(\n      'height',\n      (maxYCoordinate - minYCoordinate + 50) * d3.event.transform.k\n    );\n    // adjust width to compensate for verical scroll bar appearing\n    svg2.attr('width', document.getElementById('tubeMapSVG').clientWidth);\n  }\n\n  const minZoom = Math.min(\n    1,\n    document.getElementById(svgID.substring(1)).parentNode.offsetWidth /\n      (maxXCoordinate + 10)\n  );\n  zoom = d3\n    .zoom()\n    .scaleExtent([\n      minZoom,\n      8\n    ])\n    .translateExtent([\n      [-1, minYCoordinate - 25],\n      [maxXCoordinate + 2, maxYCoordinate + 25]\n    ])\n    .on('zoom', zoomed);\n\n  svg = svg\n    .call(zoom)\n    .on('dblclick.zoom', null)\n    .append('g');\n\n  // translate to correct position on initial draw\n  const containerWidth = document.getElementById(svgID.substring(1)).parentNode\n    .offsetWidth;\n  const xOffset =\n    maxXCoordinate + 10 < containerWidth\n      ? (containerWidth - maxXCoordinate - 10) / 2\n      : 0;\n  d3.select(svgID).call(\n    zoom.transform,\n    d3.zoomIdentity.translate(xOffset, 25 - minYCoordinate)\n  );\n}\n\nexport function zoomBy(zoomFactor) {\n  const minZoom = Math.min(\n    1,\n    document.getElementById(svgID.substring(1)).parentNode.offsetWidth /\n      (maxXCoordinate + 10)\n  );\n  const maxZoom = 8;\n  const width = document.getElementById(svgID.substring(1)).parentElement\n    .clientWidth;\n\n  const transform = d3.zoomTransform(d3.select(svgID).node());\n  const translateK = Math.min(\n    maxZoom,\n    Math.max(transform.k * zoomFactor, minZoom)\n  );\n  let translateX =\n    width / 2.0 - ((width / 2.0 - transform.x) * translateK) / transform.k;\n  translateX = Math.min(translateX, 1 * translateK);\n  translateX = Math.max(translateX, width - (maxXCoordinate + 2) * translateK);\n  const translateY = (25 - minYCoordinate) * translateK;\n  d3.select(svgID)\n    .transition()\n    .duration(750)\n    .call(\n      zoom.transform,\n      d3.zoomIdentity.translate(translateX, translateY).scale(translateK)\n    );\n}\n\n// map node names to node indices\nfunction generateNodeMap() {\n  nodeMap = new Map();\n  nodes.forEach((node, index) => {\n    nodeMap.set(node.name, index);\n  });\n  return nodeMap;\n}\n\n// adds a successor-array to each node containing the indices of the nodes coming directly after the current node\nfunction generateNodeSuccessors() {\n  let current;\n  let follower;\n\n  nodes.forEach(node => {\n    node.successors = [];\n    node.predecessors = [];\n  });\n\n  tracks.forEach(track => {\n    for (let i = 0; i < track.indexSequence.length - 1; i += 1) {\n      current = Math.abs(track.indexSequence[i]);\n      follower = Math.abs(track.indexSequence[i + 1]);\n      if (nodes[current].successors.indexOf(follower) === -1) {\n        nodes[current].successors.push(follower);\n      }\n      if (nodes[follower].predecessors.indexOf(current) === -1) {\n        nodes[follower].predecessors.push(current);\n      }\n    }\n  });\n\n  if (reads && config.showReads) {\n    reads.forEach(track => {\n      for (let i = 0; i < track.indexSequence.length - 1; i += 1) {\n        current = Math.abs(track.indexSequence[i]);\n        follower = Math.abs(track.indexSequence[i + 1]);\n        if (nodes[current].successors.indexOf(follower) === -1) {\n          nodes[current].successors.push(follower);\n        }\n        if (nodes[follower].predecessors.indexOf(current) === -1) {\n          nodes[follower].predecessors.push(current);\n        }\n      }\n    });\n  }\n}\n\nfunction generateNodeOrderOfSingleTrack(sequence) {\n  let forwardOrder = 0;\n  let backwardOrder = 0;\n  let currentNode;\n  let minOrder = 0;\n\n  sequence.forEach(nodeIndex => {\n    if (nodeIndex < 0) {\n      currentNode = nodes[Math.abs(nodeIndex)];\n      if (!currentNode.hasOwnProperty('order')) {\n        currentNode.order = backwardOrder;\n      }\n      if (currentNode.order < minOrder) minOrder = currentNode.order;\n      forwardOrder = currentNode.order;\n      backwardOrder = currentNode.order - 1;\n    } else {\n      currentNode = nodes[nodeIndex];\n      if (!currentNode.hasOwnProperty('order')) {\n        currentNode.order = forwardOrder;\n      }\n      forwardOrder = currentNode.order + 1;\n      backwardOrder = currentNode.order;\n    }\n  });\n  if (minOrder < 0) {\n    increaseOrderForAllNodes(-minOrder);\n  }\n}\n\n// calculate the order-value of nodes contained in sequence which are to the left of the first node which already has an order-value\nfunction generateNodeOrderTrackBeginning(sequence) {\n  let anchorIndex = 0;\n  let currentOrder;\n  let currentNode;\n  let minOrder = 0;\n  let increment;\n\n  while (\n    anchorIndex < sequence.length &&\n    !nodes[Math.abs(sequence[anchorIndex])].hasOwnProperty('order')\n  ) {\n    anchorIndex += 1; // anchor = first node in common with existing graph\n  }\n  if (anchorIndex >= sequence.length) {\n    return null;\n  }\n\n  if (sequence[anchorIndex] >= 0) {\n    // regular node\n    currentOrder = nodes[sequence[anchorIndex]].order - 1;\n    increment = -1;\n  } else {\n    // reverse node\n    currentOrder = nodes[-sequence[anchorIndex]].order + 1;\n    increment = 1;\n  }\n\n  for (let j = anchorIndex - 1; j >= 0; j -= 1) {\n    // assign order to nodes which are left of anchor node\n    currentNode = nodes[Math.abs(sequence[j])];\n    if (!currentNode.hasOwnProperty('order')) {\n      currentNode.order = currentOrder;\n      minOrder = Math.min(minOrder, currentOrder);\n      currentOrder += increment;\n    }\n  }\n\n  if (minOrder < 0) {\n    increaseOrderForAllNodes(-minOrder);\n  }\n  return anchorIndex;\n}\n\n// generate global sequence of nodes from left to right, starting with first track and adding other tracks sequentially\nfunction generateNodeOrder() {\n  let modifiedSequence;\n  let currentOrder;\n  let currentNode;\n  let rightIndex;\n  let leftIndex;\n  let minOrder = 0;\n  let tracksAndReads;\n  if (reads && config.showReads) tracksAndReads = tracks.concat(reads);\n  else tracksAndReads = tracks;\n\n  nodes.forEach(node => {\n    delete node.order;\n  });\n\n  generateNodeOrderOfSingleTrack(tracks[0].indexSequence); // calculate order values for all nodes of the first track\n\n  for (let i = 1; i < tracksAndReads.length; i += 1) {\n    if (DEBUG) console.log(`generating order for track ${i + 1}`);\n    rightIndex = generateNodeOrderTrackBeginning(\n      tracksAndReads[i].indexSequence\n    ); // calculate order values for all nodes until the first anchor\n    if (rightIndex === null) {\n      tracksAndReads.splice(i, 1);\n      reads.splice(i - tracks.length, 1);\n      i -= 1;\n      continue;\n    }\n    modifiedSequence = uninvert(tracksAndReads[i].indexSequence);\n\n    while (rightIndex < modifiedSequence.length) {\n      // move right until the end of the sequence\n      // find next anchor node\n      leftIndex = rightIndex;\n      rightIndex += 1;\n      while (\n        rightIndex < modifiedSequence.length &&\n        !nodes[modifiedSequence[rightIndex]].hasOwnProperty('order')\n      ) {\n        rightIndex += 1;\n      }\n\n      if (rightIndex < modifiedSequence.length) {\n        // middle segment between two anchors\n        currentOrder = nodes[modifiedSequence[leftIndex]].order + 1; // start with order value of leftAnchor + 1\n        for (let j = leftIndex + 1; j < rightIndex; j += 1) {\n          nodes[modifiedSequence[j]].order = currentOrder; // assign order values\n          currentOrder += 1;\n        }\n\n        if (\n          nodes[modifiedSequence[rightIndex]].order >\n          nodes[modifiedSequence[leftIndex]].order\n        ) {\n          // if order-value of left anchor < order-value of right anchor\n          if (nodes[modifiedSequence[rightIndex]].order < currentOrder) {\n            // and the right anchor now has a lower order-value than our newly added nodes\n            increaseOrderForSuccessors(\n              modifiedSequence[rightIndex],\n              modifiedSequence[rightIndex - 1],\n              currentOrder\n            );\n          }\n        } else {\n          // potential node reversal: check for ordering conflict, if no conflict found move node at rightIndex further to the right in order to not create a track reversal\n          if (\n            tracksAndReads[i].indexSequence[rightIndex] >= 0 &&\n            !isSuccessor(\n              modifiedSequence[rightIndex],\n              modifiedSequence[leftIndex]\n            )\n          ) {\n            // no real reversal\n            increaseOrderForSuccessors(\n              modifiedSequence[rightIndex],\n              modifiedSequence[rightIndex - 1],\n              currentOrder\n            );\n          } else {\n            // real reversal\n            if (\n              tracksAndReads[i].sequence[leftIndex] < 0 ||\n              (nodes[modifiedSequence[leftIndex + 1]].degree < 2 &&\n                nodes[modifiedSequence[rightIndex]].order <\n                  nodes[modifiedSequence[leftIndex]].order)\n            ) {\n              currentOrder = nodes[modifiedSequence[leftIndex]].order - 1; // start with order value of leftAnchor - 1\n              for (let j = leftIndex + 1; j < rightIndex; j += 1) {\n                nodes[modifiedSequence[j]].order = currentOrder; // assign order values\n                currentOrder -= 1;\n              }\n            }\n          }\n        }\n      } else {\n        // right segment to the right of last anchor\n        if (tracksAndReads[i].sequence[leftIndex] >= 0) {\n          // elongate towards the right\n          currentOrder = nodes[modifiedSequence[leftIndex]].order + 1;\n          for (let j = leftIndex + 1; j < modifiedSequence.length; j += 1) {\n            currentNode = nodes[modifiedSequence[j]];\n            if (!currentNode.hasOwnProperty('order')) {\n              currentNode.order = currentOrder;\n              currentOrder += 1;\n            }\n          }\n        } else {\n          // elongate towards the left\n          currentOrder = nodes[modifiedSequence[leftIndex]].order - 1;\n          for (let j = leftIndex + 1; j < modifiedSequence.length; j += 1) {\n            currentNode = nodes[modifiedSequence[j]];\n            if (!currentNode.hasOwnProperty('order')) {\n              currentNode.order = currentOrder;\n              minOrder = Math.min(minOrder, currentOrder);\n              currentOrder -= 1;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  // adjust all nodes if necessary, so that no order<0\n  if (minOrder < 0) increaseOrderForAllNodes(-minOrder);\n}\n\nfunction isSuccessor(first, second) {\n  const visited = new Array(numberOfNodes).fill(false);\n  const stack = [];\n  stack.push(first);\n  visited[first] = true;\n  while (stack.length > 0) {\n    const current = stack.pop();\n    if (current === second) return true;\n    for (let i = 0; i < nodes[current].successors.length; i += 1) {\n      const childIndex = nodes[current].successors[i];\n      if (!visited[childIndex]) {\n        visited[childIndex] = true;\n        stack.push(childIndex);\n      }\n    }\n  }\n  return false;\n}\n\n// get order number of the rightmost node\nfunction getMaxOrder() {\n  let max = -1;\n  nodes.forEach(node => {\n    if (node.hasOwnProperty('order') && node.order > max) max = node.order;\n  });\n  return max;\n}\n\n// generates sequence keeping the order but switching all reversed (negative) nodes to forward nodes\nfunction uninvert(sequence) {\n  const result = [];\n  for (let i = 0; i < sequence.length; i += 1) {\n    if (sequence[i] >= 0) {\n      result.push(sequence[i]);\n    } else {\n      result.push(-sequence[i]);\n    }\n  }\n  return result;\n}\n\n// increases the order-value of all nodes by amount\nfunction increaseOrderForAllNodes(amount) {\n  nodes.forEach(node => {\n    if (node.hasOwnProperty('order')) node.order += amount;\n  });\n}\n\n// increases the order-value for currentNode and (if necessary) successor nodes recursively\nfunction increaseOrderForSuccessors(startingNode, tabuNode, newOrder) {\n  const increasedOrders = new Map();\n  const queue = [];\n  queue.push([startingNode, newOrder]);\n\n  while (queue.length > 0) {\n    const current = queue.shift();\n    const currentNode = current[0];\n    const currentOrder = current[1];\n\n    if (\n      nodes[currentNode].hasOwnProperty('order') &&\n      nodes[currentNode].order < currentOrder\n    ) {\n      if (\n        !increasedOrders.has(currentNode) ||\n        increasedOrders.get(currentNode) < currentOrder\n      ) {\n        increasedOrders.set(currentNode, currentOrder);\n        nodes[currentNode].successors.forEach(successor => {\n          if (\n            nodes[successor].order > nodes[currentNode].order &&\n            successor !== tabuNode\n          ) {\n            // only increase order of successors if they lie to the right of the currentNode (not for repeats/translocations)\n            queue.push([successor, currentOrder + 1]);\n          }\n        });\n        if (currentNode !== startingNode) {\n          nodes[currentNode].predecessors.forEach(predecessor => {\n            if (\n              nodes[predecessor].order > currentNode.order &&\n              predecessor !== tabuNode\n            ) {\n              // only increase order of predecessors if they lie to the right of the currentNode (not for repeats/translocations)\n              queue.push([predecessor, currentOrder + 1]);\n            }\n          });\n        }\n      }\n    }\n  }\n\n  increasedOrders.forEach((value, key) => {\n    nodes[key].order = value;\n  });\n}\n\n// calculates the node degree: the number of tracks passing through the node / the node height\nfunction generateNodeDegree() {\n  nodes.forEach(node => {\n    node.tracks = [];\n  });\n\n  tracks.forEach(track => {\n    track.indexSequence.forEach(nodeIndex => {\n      nodes[Math.abs(nodeIndex)].tracks.push(track.id);\n    });\n  });\n\n  nodes.forEach(node => {\n    if (node.hasOwnProperty('tracks')) node.degree = node.tracks.length;\n  });\n}\n\n// if more tracks pass through a specific node in reverse direction than in\n// regular direction, switch its orientation\n// (does not apply to the first track's nodes, these are always oriented as\n// dictated by the first track)\nfunction switchNodeOrientation() {\n  const toSwitch = new Map();\n  let nodeName;\n  let prevNode;\n  let nextNode;\n  let currentNode;\n\n  for (let i = 1; i < tracks.length; i += 1) {\n    for (let j = 0; j < tracks[i].sequence.length; j += 1) {\n      nodeName = tracks[i].sequence[j];\n      if (nodeName.charAt(0) === '-') nodeName = nodeName.substr(1);\n      currentNode = nodes[nodeMap.get(nodeName)];\n      if (tracks[0].sequence.indexOf(nodeName) === -1) {\n        // do not change orientation for nodes which are part of the pivot track\n        if (j > 0) {\n          if (tracks[i].sequence[j - 1].charAt(0) !== '-') {\n            prevNode = nodes[nodeMap.get(tracks[i].sequence[j - 1])];\n          } else {\n            prevNode = nodes[nodeMap.get(tracks[i].sequence[j - 1].substr(1))];\n          }\n        }\n        if (j < tracks[i].sequence.length - 1) {\n          if (tracks[i].sequence[j + 1].charAt(0) !== '-') {\n            nextNode = nodes[nodeMap.get(tracks[i].sequence[j + 1])];\n          } else {\n            nextNode = nodes[nodeMap.get(tracks[i].sequence[j + 1].substr(1))];\n          }\n        }\n        if (\n          (j === 0 || prevNode.order < currentNode.order) &&\n          (j === tracks[i].sequence.length - 1 ||\n            currentNode.order < nextNode.order)\n        ) {\n          if (!toSwitch.has(nodeName)) toSwitch.set(nodeName, 0);\n          if (tracks[i].sequence[j].charAt(0) === '-') {\n            toSwitch.set(nodeName, toSwitch.get(nodeName) + 1);\n          } else {\n            toSwitch.set(nodeName, toSwitch.get(nodeName) - 1);\n          }\n        }\n        if (\n          (j === 0 || prevNode.order > currentNode.order) &&\n          (j === tracks[i].sequence.length - 1 ||\n            currentNode.order > nextNode.order)\n        ) {\n          if (!toSwitch.has(nodeName)) toSwitch.set(nodeName, 0);\n          if (tracks[i].sequence[j].charAt(0) === '-') {\n            toSwitch.set(nodeName, toSwitch.get(nodeName) - 1);\n          } else {\n            toSwitch.set(nodeName, toSwitch.get(nodeName) + 1);\n          }\n        }\n      }\n    }\n  }\n\n  tracks.forEach((track, trackIndex) => {\n    track.sequence.forEach((node, nodeIndex) => {\n      nodeName = node;\n      if (nodeName.charAt(0) === '-') nodeName = nodeName.substr(1);\n      if (toSwitch.has(nodeName) && toSwitch.get(nodeName) > 0) {\n        if (node.charAt(0) === '-') {\n          tracks[trackIndex].sequence[nodeIndex] = node.substr(1);\n        } else {\n          tracks[trackIndex].sequence[nodeIndex] = `-${node}`;\n        }\n      }\n    });\n  });\n\n  // invert the sequence within the nodes\n  toSwitch.forEach((value, key) => {\n    if (value > 0) {\n      currentNode = nodeMap.get(key);\n      nodes[currentNode].seq = nodes[currentNode].seq\n        .split('')\n        .reverse()\n        .join('');\n    }\n  });\n}\n\n// calculates the concrete values for the nodes' x-coordinates\nfunction generateNodeXCoords() {\n  let currentX = 0;\n  let nextX = 20;\n  let currentOrder = -1;\n  const sortedNodes = nodes.slice();\n  sortedNodes.sort(compareNodesByOrder);\n  const extra = calculateExtraSpace();\n\n  sortedNodes.forEach(node => {\n    if (node.hasOwnProperty('order')) {\n      if (node.order > currentOrder) {\n        currentOrder = node.order;\n        currentX = nextX + 10 * extra[node.order];\n      }\n      node.x = currentX;\n      nextX = Math.max(nextX, currentX + 40 + node.pixelWidth);\n    }\n  });\n}\n\n// calculates additional horizontal space needed between two nodes\n// two neighboring nodes have to be moved further apart if there is a lot going on in between them\n// -> edges turning to vertical orientation should not overlap\nfunction calculateExtraSpace() {\n  const leftSideEdges = [];\n  const rightSideEdges = [];\n  const extra = [];\n\n  for (let i = 0; i <= maxOrder; i += 1) {\n    leftSideEdges.push(0);\n    rightSideEdges.push(0);\n  }\n\n  tracks.forEach(track => {\n    for (let i = 1; i < track.path.length; i += 1) {\n      if (track.path[i].order === track.path[i - 1].order) {\n        // repeat or translocation\n        if (track.path[i].isForward === true) {\n          leftSideEdges[track.path[i].order] += 1;\n        } else {\n          rightSideEdges[track.path[i].order] += 1;\n        }\n      }\n    }\n  });\n\n  extra.push(Math.max(0, leftSideEdges[0] - 1));\n  for (let i = 1; i <= maxOrder; i += 1) {\n    extra.push(\n      Math.max(0, leftSideEdges[i] - 1) + Math.max(0, rightSideEdges[i - 1] - 1)\n    );\n  }\n  return extra;\n}\n\n// create and fill assignment-variable, which contains info about tracks and lanes for each order-value\nfunction generateLaneAssignment() {\n  let segmentNumber;\n  let currentNodeIndex;\n  let currentNodeIsForward;\n  let currentNode;\n  let previousNode;\n  let previousNodeIsForward;\n  const prevSegmentPerOrderPerTrack = [];\n  const isPositive = n => ((n = +n) || 1 / n) >= 0;\n\n  // create empty variables\n  for (let i = 0; i <= maxOrder; i += 1) {\n    assignments[i] = [];\n    prevSegmentPerOrderPerTrack[i] = [];\n    for (let j = 0; j < numberOfTracks; j += 1) {\n      prevSegmentPerOrderPerTrack[i][j] = null;\n    }\n  }\n\n  tracks.forEach((track, trackNo) => {\n    // add info for start of track\n    currentNodeIndex = Math.abs(track.indexSequence[0]);\n    currentNodeIsForward = isPositive(track.indexSequence[0]);\n    currentNode = nodes[currentNodeIndex];\n\n    track.path = [];\n    track.path.push({\n      order: currentNode.order,\n      lane: null,\n      isForward: currentNodeIsForward,\n      node: currentNodeIndex\n    });\n    addToAssignment(\n      currentNode.order,\n      currentNodeIndex,\n      trackNo,\n      0,\n      prevSegmentPerOrderPerTrack\n    );\n\n    segmentNumber = 1;\n    for (let i = 1; i < track.sequence.length; i += 1) {\n      previousNode = currentNode;\n      previousNodeIsForward = currentNodeIsForward;\n\n      currentNodeIndex = Math.abs(track.indexSequence[i]);\n      currentNodeIsForward = isPositive(track.indexSequence[i]);\n      currentNode = nodes[currentNodeIndex];\n\n      if (currentNode.order > previousNode.order) {\n        if (!previousNodeIsForward) {\n          // backward to forward at previous node\n          track.path.push({\n            order: previousNode.order,\n            lane: null,\n            isForward: true,\n            node: null\n          });\n          addToAssignment(\n            previousNode.order,\n            null,\n            trackNo,\n            segmentNumber,\n            prevSegmentPerOrderPerTrack\n          );\n          segmentNumber += 1;\n        }\n        for (let j = previousNode.order + 1; j < currentNode.order; j += 1) {\n          // forward without nodes\n          track.path.push({\n            order: j,\n            lane: null,\n            isForward: true,\n            node: null\n          });\n          addToAssignment(\n            j,\n            null,\n            trackNo,\n            segmentNumber,\n            prevSegmentPerOrderPerTrack\n          );\n          segmentNumber += 1;\n        }\n        if (!currentNodeIsForward) {\n          // forward to backward at current node\n          track.path.push({\n            order: currentNode.order,\n            lane: null,\n            isForward: true,\n            node: null\n          });\n          addToAssignment(\n            currentNode.order,\n            null,\n            trackNo,\n            segmentNumber,\n            prevSegmentPerOrderPerTrack\n          );\n          segmentNumber += 1;\n          track.path.push({\n            order: currentNode.order,\n            lane: null,\n            isForward: false,\n            node: currentNodeIndex\n          });\n          addToAssignment(\n            currentNode.order,\n            currentNodeIndex,\n            trackNo,\n            segmentNumber,\n            prevSegmentPerOrderPerTrack\n          );\n          segmentNumber += 1;\n        } else {\n          // current Node forward\n          track.path.push({\n            order: currentNode.order,\n            lane: null,\n            isForward: true,\n            node: currentNodeIndex\n          });\n          addToAssignment(\n            currentNode.order,\n            currentNodeIndex,\n            trackNo,\n            segmentNumber,\n            prevSegmentPerOrderPerTrack\n          );\n          segmentNumber += 1;\n        }\n      } else if (currentNode.order < previousNode.order) {\n        if (previousNodeIsForward) {\n          // turnaround from fw to bw at previous node\n          track.path.push({\n            order: previousNode.order,\n            lane: null,\n            isForward: false,\n            node: null\n          });\n          addToAssignment(\n            previousNode.order,\n            null,\n            trackNo,\n            segmentNumber,\n            prevSegmentPerOrderPerTrack\n          );\n          segmentNumber += 1;\n        }\n        for (let j = previousNode.order - 1; j > currentNode.order; j -= 1) {\n          // bachward without nodes\n          track.path.push({\n            order: j,\n            lane: null,\n            isForward: false,\n            node: null\n          });\n          addToAssignment(\n            j,\n            null,\n            trackNo,\n            segmentNumber,\n            prevSegmentPerOrderPerTrack\n          );\n          segmentNumber += 1;\n        }\n        if (currentNodeIsForward) {\n          // backward to forward at current node\n          track.path.push({\n            order: currentNode.order,\n            lane: null,\n            isForward: false,\n            node: null\n          });\n          addToAssignment(\n            currentNode.order,\n            null,\n            trackNo,\n            segmentNumber,\n            prevSegmentPerOrderPerTrack\n          );\n          segmentNumber += 1;\n          track.path.push({\n            order: currentNode.order,\n            lane: null,\n            isForward: true,\n            node: currentNodeIndex\n          });\n          addToAssignment(\n            currentNode.order,\n            currentNodeIndex,\n            trackNo,\n            segmentNumber,\n            prevSegmentPerOrderPerTrack\n          );\n          segmentNumber += 1;\n        } else {\n          // backward at current node\n          track.path.push({\n            order: currentNode.order,\n            lane: null,\n            isForward: false,\n            node: currentNodeIndex\n          });\n          addToAssignment(\n            currentNode.order,\n            currentNodeIndex,\n            trackNo,\n            segmentNumber,\n            prevSegmentPerOrderPerTrack\n          );\n          segmentNumber += 1;\n        }\n      } else {\n        if (currentNodeIsForward !== previousNodeIsForward) {\n          track.path.push({\n            order: currentNode.order,\n            lane: null,\n            isForward: currentNodeIsForward,\n            node: currentNodeIndex\n          });\n          addToAssignment(\n            currentNode.order,\n            currentNodeIndex,\n            trackNo,\n            segmentNumber,\n            prevSegmentPerOrderPerTrack\n          );\n          segmentNumber += 1;\n        } else {\n          track.path.push({\n            order: currentNode.order,\n            lane: null,\n            isForward: !currentNodeIsForward,\n            node: null\n          });\n          addToAssignment(\n            currentNode.order,\n            null,\n            trackNo,\n            segmentNumber,\n            prevSegmentPerOrderPerTrack\n          );\n          segmentNumber += 1;\n          track.path.push({\n            order: currentNode.order,\n            lane: null,\n            isForward: currentNodeIsForward,\n            node: currentNodeIndex\n          });\n          addToAssignment(\n            currentNode.order,\n            currentNodeIndex,\n            trackNo,\n            segmentNumber,\n            prevSegmentPerOrderPerTrack\n          );\n          segmentNumber += 1;\n        }\n      }\n    }\n  });\n\n  for (let i = 0; i <= maxOrder; i += 1) {\n    generateSingleLaneAssignment(assignments[i], i); // this is where the lanes get assigned\n  }\n}\n\nfunction addToAssignment(\n  order,\n  nodeIndex,\n  trackNo,\n  segmentID,\n  prevSegmentPerOrderPerTrack\n) {\n  const compareToFromSame = prevSegmentPerOrderPerTrack[order][trackNo];\n\n  if (nodeIndex === null) {\n    assignments[order].push({\n      type: 'single',\n      node: null,\n      tracks: [{ trackID: trackNo, segmentID, compareToFromSame }]\n    });\n    prevSegmentPerOrderPerTrack[order][trackNo] =\n      assignments[order][assignments[order].length - 1].tracks[0];\n  } else {\n    for (let i = 0; i < assignments[order].length; i += 1) {\n      if (assignments[order][i].node === nodeIndex) {\n        // add to existing node in assignment\n        assignments[order][i].type = 'multiple';\n        assignments[order][i].tracks.push({\n          trackID: trackNo,\n          segmentID,\n          compareToFromSame\n        });\n        prevSegmentPerOrderPerTrack[order][trackNo] =\n          assignments[order][i].tracks[assignments[order][i].tracks.length - 1];\n        return;\n      }\n    }\n    // create new node in assignment\n    assignments[order].push({\n      type: 'single',\n      node: nodeIndex,\n      tracks: [{ trackID: trackNo, segmentID, compareToFromSame }]\n    });\n    prevSegmentPerOrderPerTrack[order][trackNo] =\n      assignments[order][assignments[order].length - 1].tracks[0];\n  }\n}\n\n// looks at assignment and sets idealY and idealLane by looking at where the tracks come from\nfunction getIdealLanesAndCoords(assignment, order) {\n  let index;\n\n  assignment.forEach(node => {\n    node.idealLane = 0;\n    node.tracks.forEach(track => {\n      if (track.segmentID === 0) {\n        track.idealLane = track.trackID;\n        track.idealY = null;\n      } else {\n        if (\n          tracks[track.trackID].path[track.segmentID - 1].order ===\n          order - 1\n        ) {\n          track.idealLane =\n            tracks[track.trackID].path[track.segmentID - 1].lane;\n          track.idealY = tracks[track.trackID].path[track.segmentID - 1].y;\n        } else if (\n          track.segmentID < tracks[track.trackID].path.length - 1 &&\n          tracks[track.trackID].path[track.segmentID + 1].order === order - 1\n        ) {\n          track.idealLane =\n            tracks[track.trackID].path[track.segmentID + 1].lane;\n          track.idealY = tracks[track.trackID].path[track.segmentID + 1].y;\n        } else {\n          index = track.segmentID - 1;\n          while (\n            index >= 0 &&\n            tracks[track.trackID].path[index].order !== order - 1\n          ) {\n            index -= 1;\n          }\n          if (index < 0) {\n            track.idealLane = track.trackID;\n            track.idealY = null;\n          } else {\n            track.idealLane = tracks[track.trackID].path[index].lane;\n            track.idealY = tracks[track.trackID].path[index].y;\n          }\n        }\n      }\n      node.idealLane += track.idealLane;\n    });\n    node.idealLane /= node.tracks.length;\n  });\n}\n\n// assigns the optimal lanes for a single horizontal position (=order)\n// first an ideal lane is calculated for each track (which is ~ the lane of its predecessor)\n// then the nodes are sorted by their average ideal lane\n// and the whole construct is then moved up or down if necessary\nfunction generateSingleLaneAssignment(assignment, order) {\n  let currentLane = 0;\n  const potentialAdjustmentValues = new Set();\n  let currentY = 20;\n  let prevNameIsNull = false;\n  let prevTrack = -1;\n\n  getIdealLanesAndCoords(assignment, order);\n  assignment.sort(compareByIdealLane);\n\n  assignment.forEach(node => {\n    if (node.node !== null) {\n      nodes[node.node].topLane = currentLane;\n      if (prevNameIsNull) currentY -= 10;\n      nodes[node.node].y = currentY;\n      nodes[node.node].contentHeight = 0;\n      prevNameIsNull = false;\n    } else {\n      if (prevNameIsNull) currentY -= 25;\n      else if (currentY > 20) currentY -= 10;\n      prevNameIsNull = true;\n    }\n\n    node.tracks.sort(compareByIdealLane);\n    node.tracks.forEach(track => {\n      track.lane = currentLane;\n      if (track.trackID === prevTrack && node.node === null && prevNameIsNull) {\n        currentY += 10;\n      }\n      tracks[track.trackID].path[track.segmentID].lane = currentLane;\n      tracks[track.trackID].path[track.segmentID].y = currentY;\n      if (track.idealY !== null) {\n        potentialAdjustmentValues.add(track.idealY - currentY);\n      }\n      currentLane += 1;\n      currentY += tracks[track.trackID].width;\n      if (node.node !== null) {\n        nodes[node.node].contentHeight += tracks[track.trackID].width;\n      }\n      prevTrack = track.trackID;\n    });\n    currentY += 25;\n  });\n\n  adjustVertically(assignment, potentialAdjustmentValues);\n}\n\n// moves all tracks at a single horizontal location (=order) up/down to minimize lane changes\nfunction adjustVertically(assignment, potentialAdjustmentValues) {\n  let verticalAdjustment = 0;\n  let minAdjustmentCost = Number.MAX_SAFE_INTEGER;\n\n  potentialAdjustmentValues.forEach(moveBy => {\n    if (getVerticalAdjustmentCost(assignment, moveBy) < minAdjustmentCost) {\n      minAdjustmentCost = getVerticalAdjustmentCost(assignment, moveBy);\n      verticalAdjustment = moveBy;\n    }\n  });\n\n  assignment.forEach(node => {\n    if (node.node !== null) {\n      nodes[node.node].y += verticalAdjustment;\n    }\n    node.tracks.forEach(track => {\n      tracks[track.trackID].path[track.segmentID].y += verticalAdjustment;\n    });\n  });\n}\n\nfunction adjustVertically3(node, adjustBy) {\n  if (node.hasOwnProperty('order')) {\n    assignments[node.order].forEach(assignmentNode => {\n      if (assignmentNode.node !== null) {\n        const aNode = nodes[assignmentNode.node];\n        if (aNode !== node && aNode.y > node.y) {\n          aNode.y += adjustBy;\n          assignmentNode.tracks.forEach(track => {\n            tracks[track.trackID].path[track.segmentID].y += adjustBy;\n          });\n        }\n      } else {\n        // track-segment not within a node\n        assignmentNode.tracks.forEach(track => {\n          if (tracks[track.trackID].path[track.segmentID].y >= node.y) {\n            tracks[track.trackID].path[track.segmentID].y += adjustBy;\n          }\n        });\n      }\n    });\n    if (nodesPerOrder[node.order].length > 0) {\n      nodesPerOrder[node.order].forEach(nodeIndex => {\n        if (nodes[nodeIndex] !== node && nodes[nodeIndex].y > node.y) {\n          nodes[nodeIndex].y += adjustBy;\n        }\n      });\n    }\n  }\n}\n\n// calculates cost of vertical adjustment as vertical distance * width of track\nfunction getVerticalAdjustmentCost(assignment, moveBy) {\n  let result = 0;\n  assignment.forEach(node => {\n    node.tracks.forEach(track => {\n      if (track.idealY !== null && tracks[track.trackID].type !== 'read') {\n        result +=\n          Math.abs(\n            track.idealY -\n              moveBy -\n              tracks[track.trackID].path[track.segmentID].y\n          ) * tracks[track.trackID].width;\n      }\n    });\n  });\n  return result;\n}\n\nfunction compareByIdealLane(a, b) {\n  if (a.hasOwnProperty('idealLane')) {\n    if (b.hasOwnProperty('idealLane')) {\n      if (a.idealLane < b.idealLane) return -1;\n      else if (a.idealLane > b.idealLane) return 1;\n      return 0;\n    }\n    return -1;\n  }\n  if (b.hasOwnProperty('idealLane')) {\n    return 1;\n  }\n  return 0;\n}\n\nfunction compareNodesByOrder(a, b) {\n  if (a === null) {\n    if (b === null) return 0;\n    return -1;\n  }\n  if (b === null) return 1;\n\n  if (a.hasOwnProperty('order')) {\n    if (b.hasOwnProperty('order')) {\n      if (a.order < b.order) return -1;\n      else if (a.order > b.order) return 1;\n      if (a.hasOwnProperty('y') && b.hasOwnProperty('y')) {\n        if (a.y < b.y) return -1;\n        else if (a.y > b.y) return 1;\n      }\n      return 0;\n    }\n    return -1;\n  }\n  if (b.hasOwnProperty('order')) return 1;\n  return 0;\n}\n\nfunction addTrackFeatures() {\n  let nodeStart;\n  let nodeEnd;\n  let feature = {};\n\n  bed.forEach(line => {\n    let i = 0;\n    while (i < numberOfTracks && tracks[i].name !== line.track) i += 1;\n    if (i < numberOfTracks) {\n      nodeStart = 0;\n      tracks[i].path.forEach(node => {\n        if (node.node !== null) {\n          feature = {};\n          if (nodes[node.node].hasOwnProperty('sequenceLength')) {\n            nodeEnd = nodeStart + nodes[node.node].sequenceLength - 1;\n          } else {\n            nodeEnd = nodeStart + nodes[node.node].width - 1;\n          }\n\n          if (nodeStart >= line.start && nodeStart <= line.end) {\n            feature.start = 0;\n          }\n          if (nodeStart < line.start && nodeEnd >= line.start) {\n            feature.start = line.start - nodeStart;\n          }\n          if (nodeEnd <= line.end && nodeEnd >= line.start) {\n            feature.end = nodeEnd - nodeStart;\n            if (nodeEnd < line.end) feature.continue = true;\n          }\n          if (nodeEnd > line.end && nodeStart <= line.end) {\n            feature.end = line.end - nodeStart;\n          }\n          if (feature.hasOwnProperty('start')) {\n            feature.type = line.type;\n            feature.name = line.name;\n            if (!node.hasOwnProperty('features')) node.features = [];\n            node.features.push(feature);\n          }\n          nodeStart = nodeEnd + 1;\n        }\n      });\n    }\n  });\n}\n\nfunction calculateTrackWidth() {\n  // flag: if vg returns freq of 0 for all tracks, we will increase width manually\n  let allAreFour = true;\n\n  tracks.forEach(track => {\n    if (track.hasOwnProperty('freq')) {\n      // custom track width\n      track.width = Math.round((Math.log(track.freq) + 1) * 4);\n    } else {\n      // default track width\n      track.width = 15;\n      if (track.hasOwnProperty('type') && track.type === 'read') {\n        track.width = 4;\n      }\n    }\n    if (track.width !== 4) {\n      allAreFour = false;\n    }\n  });\n\n  if (allAreFour) {\n    tracks.forEach(track => {\n      if (track.hasOwnProperty('freq')) {\n        track.width = 15;\n      }\n    });\n  }\n}\n\nexport function useColorScheme(x) {\n  config.colorScheme = x;\n  svg = d3.select(svgID);\n  const tr = createTubeMap();\n  if (!config.hideLegendFlag) drawLegend(tr);\n}\n\nfunction assignColorSets() {\n  haplotypeColors = getColorSet(config.haplotypeColors);\n  forwardReadColors = getColorSet(config.forwardReadColors);\n  reverseReadColors = getColorSet(config.reverseReadColors);\n  exonColors = getColorSet(config.exonColors);\n}\n\nfunction getColorSet(colorSetName) {\n  switch (colorSetName) {\n    case 'plainColors':\n      return plainColors;\n    case 'reds':\n      return reds;\n    case 'blues':\n      return blues;\n    case 'greys':\n      return greys;\n    case 'lightColors':\n      return lightColors;\n    default:\n      return greys;\n  }\n}\n\nfunction generateTrackColor(track, highlight) {\n  if (typeof highlight === 'undefined') highlight = 'plain';\n  let trackColor;\n  if (track.hasOwnProperty('type') && track.type === 'read') {\n    if (track.hasOwnProperty('is_reverse') && track.is_reverse === true) {\n      trackColor = reverseReadColors[track.id % reverseReadColors.length];\n    } else {\n      trackColor = forwardReadColors[track.id % forwardReadColors.length];\n    }\n  } else {\n    if (config.showExonsFlag === false || highlight !== 'plain') {\n      trackColor = haplotypeColors[track.id % haplotypeColors.length];\n    } else {\n      trackColor = exonColors[track.id % exonColors.length];\n    }\n  }\n  return trackColor;\n}\n\nfunction generateTrackColorOLD(track, highlight) {\n  if (typeof highlight === 'undefined') highlight = 'plain';\n  let trackColor;\n  // Color reads in red and reverse reads in blue\n  if (track.hasOwnProperty('type') && track.type === 'read') {\n    if (track.hasOwnProperty('is_reverse') && track.is_reverse === true) {\n      trackColor = blues[track.id % blues.length];\n    } else {\n      trackColor = reds[track.id % reds.length];\n    }\n  } else {\n    if (config.colorScheme === 0) {\n      // colorful color scheme\n      if (config.showExonsFlag === false || highlight !== 'plain') {\n        trackColor = plainColors[track.id % plainColors.length];\n      } else {\n        trackColor = lightColors[track.id % lightColors.length];\n      }\n    } else if (config.colorScheme === 1) {\n      // blue-ish color scheme\n      if (config.showExonsFlag === false || highlight === 'plain') {\n        trackColor = greys[track.id % greys.length];\n      } else {\n        trackColor = reds[track.id % reds.length];\n      }\n    }\n  }\n  return trackColor;\n}\n\nfunction getReadXStart(read) {\n  const node = nodes[read.path[0].node];\n  if (read.path[0].isForward) {\n    // read starts in forward direction\n    return getXCoordinateOfBaseWithinNode(node, read.firstNodeOffset);\n  }\n  // read starts in backward direction\n  return getXCoordinateOfBaseWithinNode(\n    node,\n    node.sequenceLength - read.firstNodeOffset\n  );\n}\n\nfunction getReadXEnd(read) {\n  const node = nodes[read.path[read.path.length - 1].node];\n  if (read.path[read.path.length - 1].isForward) {\n    // read ends in forward direction\n    return getXCoordinateOfBaseWithinNode(node, read.finalNodeCoverLength);\n  }\n  // read ends in backward direction\n  return getXCoordinateOfBaseWithinNode(\n    node,\n    node.sequenceLength - read.finalNodeCoverLength\n  );\n}\n\n// returns the x coordinate (in pixels) of (the left side) of the given base\n// position within the given node\nfunction getXCoordinateOfBaseWithinNode(node, base) {\n  if (base > node.sequenceLength) return null; // equality is allowed\n  const nodeLeftX = node.x - 4;\n  const nodeRightX = node.x + node.pixelWidth + 4;\n  return nodeLeftX + (base / node.sequenceLength) * (nodeRightX - nodeLeftX);\n}\n\n// transforms the info in the tracks' path attribute into actual coordinates\n// and saves them in trackRectangles and trackCurves\nfunction generateSVGShapesFromPath() {\n  let xStart;\n  let xEnd;\n  let yStart;\n  let yEnd;\n  let trackColor;\n  let highlight;\n  let dummy;\n  let reversalFlag;\n\n  for (let i = 0; i <= maxOrder; i += 1) {\n    extraLeft.push(0);\n    extraRight.push(0);\n  }\n\n  // generate x coords where each order starts and ends\n  const orderStartX = [];\n  const orderEndX = [];\n  nodes.forEach(node => {\n    if (node.hasOwnProperty('order')) {\n      orderStartX[node.order] = node.x;\n      if (orderEndX[node.order] === undefined) {\n        orderEndX[node.order] = node.x + node.pixelWidth;\n      } else {\n        orderEndX[node.order] = Math.max(\n          orderEndX[node.order],\n          node.x + node.pixelWidth\n        );\n      }\n    }\n  });\n\n  tracks.forEach(track => {\n    highlight = 'plain';\n    trackColor = generateTrackColor(track, highlight);\n\n    // start of path\n    yStart = track.path[0].y;\n    if (track.type !== 'read') {\n      if (track.sequence[0].charAt(0) === '-') {\n        // The track starts with an inversed node\n        xStart = orderEndX[track.path[0].order] + 20;\n      } else {\n        // The track starts with a forward node\n        xStart = orderStartX[track.path[0].order] - 20;\n      }\n    } else {\n      xStart = getReadXStart(track);\n    }\n\n    // middle of path\n    for (let i = 0; i < track.path.length; i += 1) {\n      if (track.path[i].y === yStart) {\n        if (track.path[i].hasOwnProperty('features')) {\n          reversalFlag =\n            i > 0 && track.path[i - 1].order === track.path[i].order;\n          dummy = createFeatureRectangle(\n            track.path[i],\n            orderStartX[track.path[i].order],\n            orderEndX[track.path[i].order],\n            highlight,\n            track,\n            xStart,\n            yStart,\n            trackColor,\n            reversalFlag\n          );\n          highlight = dummy.highlight;\n          xStart = dummy.xStart;\n        }\n      } else {\n        if (track.path[i - 1].isForward) {\n          xEnd = orderEndX[track.path[i - 1].order];\n        } else {\n          xEnd = orderStartX[track.path[i - 1].order];\n        }\n        if (xEnd !== xStart) {\n          trackColor = generateTrackColor(track, highlight);\n          trackRectangles.push({\n            xStart: Math.min(xStart, xEnd),\n            yStart,\n            xEnd: Math.max(xStart, xEnd),\n            yEnd: yStart + track.width - 1,\n            color: trackColor,\n            id: track.id,\n            type: track.type\n          });\n        }\n\n        if (track.path[i].order - 1 === track.path[i - 1].order) {\n          // regular forward connection\n          xStart = xEnd;\n          xEnd = orderStartX[track.path[i].order];\n          yEnd = track.path[i].y;\n          trackColor = generateTrackColor(track, highlight);\n          trackCurves.push({\n            xStart,\n            yStart,\n            xEnd: xEnd + 1,\n            yEnd,\n            width: track.width,\n            color: trackColor,\n            laneChange: Math.abs(track.path[i].lane - track.path[i - 1].lane),\n            id: track.id,\n            type: track.type\n          });\n          xStart = xEnd;\n          yStart = yEnd;\n        } else if (track.path[i].order + 1 === track.path[i - 1].order) {\n          // regular backward connection\n          xStart = xEnd;\n          xEnd = orderEndX[track.path[i].order];\n          yEnd = track.path[i].y;\n          trackColor = generateTrackColor(track, highlight);\n          trackCurves.push({\n            xStart: xStart + 1,\n            yStart,\n            xEnd,\n            yEnd,\n            width: track.width,\n            color: trackColor,\n            laneChange: Math.abs(track.path[i].lane - track.path[i - 1].lane),\n            id: track.id,\n            type: track.type\n          });\n          xStart = xEnd;\n          yStart = yEnd;\n        } else {\n          // change of direction\n          if (track.path[i - 1].isForward) {\n            yEnd = track.path[i].y;\n            generateForwardToReverse(\n              xEnd,\n              yStart,\n              yEnd,\n              track.width,\n              trackColor,\n              track.id,\n              track.path[i].order,\n              track.type\n            );\n            xStart = orderEndX[track.path[i].order];\n            yStart = track.path[i].y;\n          } else {\n            yEnd = track.path[i].y;\n            generateReverseToForward(\n              xEnd,\n              yStart,\n              yEnd,\n              track.width,\n              trackColor,\n              track.id,\n              track.path[i].order,\n              track.type\n            );\n            xStart = orderStartX[track.path[i].order];\n            yStart = track.path[i].y;\n          }\n        }\n\n        if (track.path[i].hasOwnProperty('features')) {\n          reversalFlag = track.path[i - 1].order === track.path[i].order;\n          dummy = createFeatureRectangle(\n            track.path[i],\n            orderStartX[track.path[i].order],\n            orderEndX[track.path[i].order],\n            highlight,\n            track,\n            xStart,\n            yStart,\n            trackColor,\n            reversalFlag\n          );\n          highlight = dummy.highlight;\n          xStart = dummy.xStart;\n        }\n      }\n    }\n\n    // ending edges\n    if (track.type !== 'read') {\n      if (!track.path[track.path.length - 1].isForward) {\n        // The track ends with an inversed node\n        xEnd = orderStartX[track.path[track.path.length - 1].order] - 20;\n      } else {\n        // The track ends with a forward node\n        xEnd = orderEndX[track.path[track.path.length - 1].order] + 20;\n      }\n    } else {\n      xEnd = getReadXEnd(track);\n    }\n    trackRectangles.push({\n      xStart: Math.min(xStart, xEnd),\n      yStart,\n      xEnd: Math.max(xStart, xEnd),\n      yEnd: yStart + track.width - 1,\n      color: trackColor,\n      id: track.id,\n      type: track.type\n    });\n  });\n}\n\nfunction createFeatureRectangle(\n  node,\n  nodeXStart,\n  nodeXEnd,\n  highlight,\n  track,\n  rectXStart,\n  yStart,\n  trackColor,\n  reversalFlag\n) {\n  let nodeWidth;\n  let currentHighlight = highlight;\n  let c;\n  let co;\n  let featureXStart;\n  let featureXEnd;\n\n  nodeXStart -= 8;\n  nodeXEnd += 8;\n  if (nodes[node.node].hasOwnProperty('sequenceLength')) {\n    nodeWidth = nodes[node.node].sequenceLength;\n  } else {\n    nodeWidth = nodes[node.node].width;\n  }\n\n  node.features.sort((a, b) => a.start - b.start);\n  node.features.forEach(feature => {\n    if (currentHighlight !== feature.type) {\n      // finish incoming rectangle\n      c = generateTrackColor(track, currentHighlight);\n      if (node.isForward === true) {\n        featureXStart =\n          nodeXStart +\n          Math.round((feature.start * (nodeXEnd - nodeXStart + 1)) / nodeWidth);\n\n        // overwrite narrow post-inversion rectangle if highlight starts near beginning of node\n        if (reversalFlag && featureXStart < nodeXStart + 8) {\n          featureXEnd =\n            nodeXStart +\n            Math.round(\n              ((feature.end + 1) * (nodeXEnd - nodeXStart + 1)) / nodeWidth\n            ) -\n            1;\n          co = generateTrackColor(track, feature.type);\n          trackRectanglesStep3.push({\n            xStart: featureXStart,\n            yStart,\n            xEnd: featureXEnd,\n            yEnd: yStart + track.width - 1,\n            color: co,\n            id: track.id,\n            type: track.type\n          });\n        }\n\n        if (featureXStart > rectXStart + 1) {\n          trackRectanglesStep3.push({\n            xStart: rectXStart,\n            yStart,\n            xEnd: featureXStart - 1,\n            yEnd: yStart + track.width - 1,\n            color: c,\n            id: track.id,\n            type: track.type\n          });\n        }\n      } else {\n        featureXStart =\n          nodeXEnd -\n          Math.round((feature.start * (nodeXEnd - nodeXStart + 1)) / nodeWidth);\n\n        // overwrite narrow post-inversion rectangle if highlight starts near beginning of node\n        if (reversalFlag && featureXStart > nodeXEnd - 8) {\n          featureXEnd =\n            nodeXEnd -\n            Math.round(\n              ((feature.end + 1) * (nodeXEnd - nodeXStart + 1)) / nodeWidth\n            ) -\n            1;\n          co = generateTrackColor(track, feature.type);\n          trackRectanglesStep3.push({\n            xStart: featureXEnd,\n            yStart,\n            xEnd: featureXStart,\n            yEnd: yStart + track.width - 1,\n            color: co,\n            id: track.id,\n            type: track.type\n          });\n        }\n\n        if (rectXStart > featureXStart + 1) {\n          trackRectanglesStep3.push({\n            xStart: featureXStart + 1,\n            yStart,\n            xEnd: rectXStart,\n            yEnd: yStart + track.width - 1,\n            color: c,\n            id: track.id,\n            type: track.type\n          });\n        }\n      }\n      rectXStart = featureXStart;\n      currentHighlight = feature.type;\n    }\n    if (feature.end < nodeWidth - 1 || !feature.hasOwnProperty('continue')) {\n      // finish internal rectangle\n      c = generateTrackColor(track, currentHighlight);\n      if (node.isForward === true) {\n        featureXEnd =\n          nodeXStart +\n          Math.round(\n            ((feature.end + 1) * (nodeXEnd - nodeXStart + 1)) / nodeWidth\n          ) -\n          1;\n        trackRectanglesStep3.push({\n          xStart: rectXStart,\n          yStart,\n          xEnd: featureXEnd,\n          yEnd: yStart + track.width - 1,\n          color: c,\n          id: track.id,\n          type: track.type\n        });\n      } else {\n        featureXEnd =\n          nodeXEnd -\n          Math.round(\n            ((feature.end + 1) * (nodeXEnd - nodeXStart + 1)) / nodeWidth\n          ) -\n          1;\n        trackRectanglesStep3.push({\n          xStart: featureXEnd,\n          yStart,\n          xEnd: rectXStart,\n          yEnd: yStart + track.width - 1,\n          color: c,\n          id: track.id,\n          type: track.type\n        });\n      }\n      rectXStart = featureXEnd + 1;\n      currentHighlight = 'plain';\n    }\n  });\n  return { xStart: rectXStart, highlight: currentHighlight };\n}\n\nfunction generateForwardToReverse(\n  x,\n  yStart,\n  yEnd,\n  trackWidth,\n  trackColor,\n  trackID,\n  order,\n  type\n) {\n  x += 10 * extraRight[order];\n  const yTop = Math.min(yStart, yEnd);\n  const yBottom = Math.max(yStart, yEnd);\n  const radius = 7;\n\n  trackVerticalRectangles.push({\n    // elongate incoming rectangle a bit to the right\n    xStart: x - 10 * extraRight[order],\n    yStart,\n    xEnd: x + 5,\n    yEnd: yStart + trackWidth - 1,\n    color: trackColor,\n    id: trackID,\n    type\n  });\n  trackVerticalRectangles.push({\n    // vertical rectangle\n    xStart: x + 5 + radius,\n    yStart: yTop + trackWidth + radius - 1,\n    xEnd: x + 5 + radius + Math.min(7, trackWidth) - 1,\n    yEnd: yBottom - radius + 1,\n    color: trackColor,\n    id: trackID,\n    type\n  });\n  trackVerticalRectangles.push({\n    xStart: x - 10 * extraRight[order],\n    yStart: yEnd,\n    xEnd: x + 5,\n    yEnd: yEnd + trackWidth - 1,\n    color: trackColor,\n    id: trackID,\n    type\n  }); // elongate outgoing rectangle a bit to the right\n\n  let d = `M ${x + 5} ${yBottom}`;\n  d += ` Q ${x + 5 + radius} ${yBottom} ${x + 5 + radius} ${yBottom - radius}`;\n  d += ` H ${x + 5 + radius + Math.min(7, trackWidth)}`;\n  d += ` Q ${x + 5 + radius + Math.min(7, trackWidth)} ${yBottom +\n    trackWidth} ${x + 5} ${yBottom + trackWidth}`;\n  d += ' Z ';\n  trackCorners.push({ path: d, color: trackColor, id: trackID, type });\n\n  d = `M ${x + 5} ${yTop}`;\n  d += ` Q ${x + 5 + radius + Math.min(7, trackWidth)} ${yTop} ${x +\n    5 +\n    radius +\n    Math.min(7, trackWidth)} ${yTop + trackWidth + radius}`;\n  d += ` H ${x + 5 + radius}`;\n  d += ` Q ${x + 5 + radius} ${yTop + trackWidth} ${x + 5} ${yTop +\n    trackWidth}`;\n  d += ' Z ';\n  trackCorners.push({ path: d, color: trackColor, id: trackID, type });\n  extraRight[order] += 1;\n}\n\nfunction generateReverseToForward(\n  x,\n  yStart,\n  yEnd,\n  trackWidth,\n  trackColor,\n  trackID,\n  order,\n  type\n) {\n  const yTop = Math.min(yStart, yEnd);\n  const yBottom = Math.max(yStart, yEnd);\n  const radius = 7;\n  x -= 10 * extraLeft[order];\n\n  trackVerticalRectangles.push({\n    xStart: x - 6,\n    yStart,\n    xEnd: x + 10 * extraLeft[order],\n    yEnd: yStart + trackWidth - 1,\n    color: trackColor,\n    id: trackID,\n    type\n  }); // elongate incoming rectangle a bit to the left\n  trackVerticalRectangles.push({\n    xStart: x - 5 - radius - Math.min(7, trackWidth),\n    yStart: yTop + trackWidth + radius - 1,\n    xEnd: x - 5 - radius - 1,\n    yEnd: yBottom - radius + 1,\n    color: trackColor,\n    id: trackID,\n    type\n  }); // vertical rectangle\n  trackVerticalRectangles.push({\n    xStart: x - 6,\n    yStart: yEnd,\n    xEnd: x + 10 * extraLeft[order],\n    yEnd: yEnd + trackWidth - 1,\n    color: trackColor,\n    id: trackID,\n    type\n  }); // elongate outgoing rectangle a bit to the left\n\n  // Path for bottom 90 degree bend\n  let d = `M ${x - 5} ${yBottom}`;\n  d += ` Q ${x - 5 - radius} ${yBottom} ${x - 5 - radius} ${yBottom - radius}`;\n  d += ` H ${x - 5 - radius - Math.min(7, trackWidth)}`;\n  d += ` Q ${x - 5 - radius - Math.min(7, trackWidth)} ${yBottom +\n    trackWidth} ${x - 5} ${yBottom + trackWidth}`;\n  d += ' Z ';\n  trackCorners.push({ path: d, color: trackColor, id: trackID, type });\n\n  // Path for top 90 degree bend\n  d = `M ${x - 5} ${yTop}`;\n  d += ` Q ${x - 5 - radius - Math.min(7, trackWidth)} ${yTop} ${x -\n    5 -\n    radius -\n    Math.min(7, trackWidth)} ${yTop + trackWidth + radius}`;\n  d += ` H ${x - 5 - radius}`;\n  d += ` Q ${x - 5 - radius} ${yTop + trackWidth} ${x - 5} ${yTop +\n    trackWidth}`;\n  d += ' Z ';\n  trackCorners.push({ path: d, color: trackColor, id: trackID, type });\n  extraLeft[order] += 1;\n}\n\n// to avoid problems with wrong overlapping of tracks, draw them in order of their color\nfunction drawReversalsByColor(corners, rectangles, type) {\n  if (typeof type === 'undefined') type = 'haplo';\n  const co = new Set();\n  rectangles.forEach(rect => {\n    co.add(rect.color);\n  });\n  co.forEach(c => {\n    drawTrackRectangles(\n      rectangles.filter(filterObjectByAttribute('color', c)),\n      type\n    );\n    drawTrackCorners(corners.filter(filterObjectByAttribute('color', c)), type);\n  });\n}\n\n// draws nodes by building svg-path for border and filling it with transparent white\nfunction drawNodes(dNodes) {\n  let x;\n  let y;\n\n  dNodes.forEach(node => {\n    // top left arc\n    node.d = `M ${node.x - 9} ${node.y} Q ${node.x - 9} ${node.y - 9} ${\n      node.x\n    } ${node.y - 9}`;\n    x = node.x;\n    y = node.y - 9;\n\n    // top straight\n    if (node.width > 1) {\n      x += node.pixelWidth;\n      node.d += ` L ${x} ${y}`;\n    }\n\n    // top right arc\n    node.d += ` Q ${x + 9} ${y} ${x + 9} ${y + 9}`;\n    x += 9;\n    y += 9;\n\n    // right straight\n    if (node.contentHeight > 0) {\n      y += node.contentHeight - 0;\n      node.d += ` L ${x} ${y}`;\n    }\n\n    // bottom right arc\n    node.d += ` Q ${x} ${y + 9} ${x - 9} ${y + 9}`;\n    x -= 9;\n    y += 9;\n\n    // bottom straight\n    if (node.width > 1) {\n      x -= node.pixelWidth;\n      node.d += ` L ${x} ${y}`;\n    }\n\n    // bottom left arc\n    node.d += ` Q ${x - 9} ${y} ${x - 9} ${y - 9}`;\n    x -= 9;\n    y -= 9;\n\n    // left straight\n    if (node.contentHeight > 0) {\n      y -= node.contentHeight - 0;\n      node.d += ` L ${x} ${y}`;\n    }\n  });\n\n  svg\n    .selectAll('.node')\n    .data(dNodes)\n    .enter()\n    .append('path')\n    .attr('id', d => d.name)\n    .attr('d', d => d.d)\n    .on('mouseover', nodeMouseOver)\n    .on('mouseout', nodeMouseOut)\n    .on('dblclick', nodeDoubleClick)\n    .style('fill', '#fff')\n    .style('fill-opacity', config.showExonsFlag ? '0.4' : '0.6')\n    .style('stroke', 'black')\n    .style('stroke-width', '2px')\n    .append('svg:title')\n    .text(d => d.name);\n}\n\n// draw seqence labels for nodes\nfunction drawLabels(dNodes) {\n  if (config.nodeWidthOption === 0) {\n    svg\n      .selectAll('text')\n      .data(dNodes)\n      .enter()\n      .append('text')\n      .attr('x', d => d.x - 4)\n      .attr('y', d => d.y + 4)\n      .text(d => d.seq)\n      .attr('font-family', 'Courier, \"Lucida Console\", monospace')\n      .attr('font-size', '14px')\n      .attr('fill', 'black')\n      .style('pointer-events', 'none');\n  }\n}\n\nfunction drawRuler() {\n  let rulerTrackIndex = 0;\n  while (tracks[rulerTrackIndex].name !== trackForRuler) rulerTrackIndex += 1;\n  const rulerTrack = tracks[rulerTrackIndex];\n\n  // draw horizontal line\n  svg\n    .append('line')\n    .attr('x1', 0)\n    .attr('y1', minYCoordinate - 10)\n    .attr('x2', maxXCoordinate)\n    .attr('y2', minYCoordinate - 10)\n    .attr('stroke-width', 1)\n    .attr('stroke', 'black');\n\n  let markingInterval = 100;\n  if (config.nodeWidthOption === 0) markingInterval = 20;\n\n  let indexOfFirstBaseInNode = rulerTrack.indexOfFirstBase;\n  let atLeastOneMarkingDrawn = false;\n  let xCoordOfPreviousMarking = -100;\n\n  // draw ruler marking at the left end of chart for compressed charts\n  // (this marking is on purpose not at a 0 % 100 position)\n  if (config.nodeWidthOption !== 0) {\n    const firstNode = nodes[rulerTrack.indexSequence[0]];\n    xCoordOfPreviousMarking = getXCoordinateOfBaseWithinNode(firstNode, 0);\n    drawRulerMarking(indexOfFirstBaseInNode, xCoordOfPreviousMarking);\n    atLeastOneMarkingDrawn = true;\n  }\n\n  rulerTrack.indexSequence.forEach(nodeIndex => {\n    const currentNode = nodes[nodeIndex];\n    let nextMarking =\n      Math.ceil(indexOfFirstBaseInNode / markingInterval) * markingInterval;\n    while (nextMarking < indexOfFirstBaseInNode + currentNode.sequenceLength) {\n      const xCoordOfMarking = getXCoordinateOfBaseWithinNode(\n        currentNode,\n        nextMarking - indexOfFirstBaseInNode\n      );\n      if (xCoordOfPreviousMarking + 80 <= xCoordOfMarking) {\n        drawRulerMarking(nextMarking, xCoordOfMarking);\n        atLeastOneMarkingDrawn = true;\n        xCoordOfPreviousMarking = xCoordOfMarking;\n      }\n      nextMarking += markingInterval;\n    }\n    indexOfFirstBaseInNode += nodes[nodeIndex].sequenceLength;\n  });\n\n  // if no markings drawn, draw one at the very beginning\n  if (!atLeastOneMarkingDrawn) {\n    drawRulerMarking(\n      rulerTrack.indexOfFirstBase,\n      nodes[rulerTrack.indexSequence[0]].x - 4\n    );\n  }\n}\n\nfunction drawRulerMarking(sequencePosition, xCoordinate) {\n  svg\n    .append('text')\n    .attr('x', xCoordinate)\n    .attr('y', minYCoordinate - 13)\n    .text(`|${sequencePosition}`)\n    .attr('font-family', 'Courier, \"Lucida Console\", monospace')\n    .attr('font-size', '12px')\n    .attr('fill', 'black')\n    .style('pointer-events', 'none');\n}\n\nfunction filterObjectByAttribute(attribute, value) {\n  return item => item[attribute] === value;\n}\n\nfunction drawTrackRectangles(rectangles, type) {\n  if (typeof type === 'undefined') type = 'haplo';\n  rectangles = rectangles.filter(filterObjectByAttribute('type', type));\n\n  svg\n    .selectAll('trackRectangles')\n    .data(rectangles)\n    .enter()\n    .append('rect')\n    .attr('x', d => d.xStart)\n    .attr('y', d => d.yStart)\n    .attr('width', d => d.xEnd - d.xStart + 1)\n    .attr('height', d => d.yEnd - d.yStart + 1)\n    .style('fill', d => d.color)\n    .attr('trackID', d => d.id)\n    .attr('class', d => `track${d.id}`)\n    .attr('color', d => d.color)\n    .on('mouseover', trackMouseOver)\n    .on('mouseout', trackMouseOut)\n    .on('dblclick', trackDoubleClick);\n}\n\nfunction compareCurvesByLineChanges(a, b) {\n  if (a[6] < b[6]) return -1;\n  else if (a[6] > b[6]) return 1;\n  return 0;\n}\n\nfunction defineSVGPatterns() {\n  const defs = svg.append('defs');\n  let pattern = defs.append('pattern').attrs({\n    id: 'patternA',\n    width: '7',\n    height: '7',\n    patternUnits: 'userSpaceOnUse',\n    patternTransform: 'rotate(45)'\n  });\n\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '0', width: '7', height: '7', fill: '#FFFFFF' });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '0', width: '3', height: '3', fill: '#505050' });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '4', width: '3', height: '3', fill: '#505050' });\n  pattern\n    .append('rect')\n    .attrs({ x: '4', y: '0', width: '3', height: '3', fill: '#505050' });\n  pattern\n    .append('rect')\n    .attrs({ x: '4', y: '4', width: '3', height: '3', fill: '#505050' });\n\n  pattern = defs.append('pattern').attrs({\n    id: 'patternB',\n    width: '8',\n    height: '8',\n    patternUnits: 'userSpaceOnUse',\n    patternTransform: 'rotate(45)'\n  });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '0', width: '8', height: '8', fill: '#FFFFFF' });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '0', width: '3', height: '3', fill: '#1f77b4' });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '5', width: '3', height: '3', fill: '#1f77b4' });\n  pattern\n    .append('rect')\n    .attrs({ x: '5', y: '0', width: '3', height: '3', fill: '#1f77b4' });\n  pattern\n    .append('rect')\n    .attrs({ x: '5', y: '5', width: '3', height: '3', fill: '#1f77b4' });\n\n  pattern = defs.append('pattern').attrs({\n    id: 'plaid0',\n    width: '6',\n    height: '6',\n    patternUnits: 'userSpaceOnUse',\n    patternTransform: 'rotate(45)'\n  });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '0', width: '6', height: '6', fill: '#FFFFFF' });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '0', width: '2', height: '2', fill: '#1f77b4' });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '4', width: '2', height: '2', fill: '#1f77b4' });\n  pattern\n    .append('rect')\n    .attrs({ x: '4', y: '0', width: '2', height: '2', fill: '#1f77b4' });\n  pattern\n    .append('rect')\n    .attrs({ x: '4', y: '4', width: '2', height: '2', fill: '#1f77b4' });\n\n  pattern = defs.append('pattern').attrs({\n    id: 'plaid1',\n    width: '6',\n    height: '6',\n    patternUnits: 'userSpaceOnUse',\n    patternTransform: 'rotate(45)'\n  });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '0', width: '6', height: '6', fill: '#FFFFFF' });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '0', width: '2', height: '2', fill: '#ff7f0e' });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '4', width: '2', height: '2', fill: '#ff7f0e' });\n  pattern\n    .append('rect')\n    .attrs({ x: '4', y: '0', width: '2', height: '2', fill: '#ff7f0e' });\n  pattern\n    .append('rect')\n    .attrs({ x: '4', y: '4', width: '2', height: '2', fill: '#ff7f0e' });\n\n  pattern = defs.append('pattern').attrs({\n    id: 'plaid2',\n    width: '6',\n    height: '6',\n    patternUnits: 'userSpaceOnUse',\n    patternTransform: 'rotate(45)'\n  });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '0', width: '6', height: '6', fill: '#FFFFFF' });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '0', width: '2', height: '2', fill: '#2ca02c' });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '4', width: '2', height: '2', fill: '#2ca02c' });\n  pattern\n    .append('rect')\n    .attrs({ x: '4', y: '0', width: '2', height: '2', fill: '#2ca02c' });\n  pattern\n    .append('rect')\n    .attrs({ x: '4', y: '4', width: '2', height: '2', fill: '#2ca02c' });\n\n  pattern = defs.append('pattern').attrs({\n    id: 'plaid3',\n    width: '6',\n    height: '6',\n    patternUnits: 'userSpaceOnUse',\n    patternTransform: 'rotate(45)'\n  });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '0', width: '6', height: '6', fill: '#FFFFFF' });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '0', width: '2', height: '2', fill: '#d62728' });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '4', width: '2', height: '2', fill: '#d62728' });\n  pattern\n    .append('rect')\n    .attrs({ x: '4', y: '0', width: '2', height: '2', fill: '#d62728' });\n  pattern\n    .append('rect')\n    .attrs({ x: '4', y: '4', width: '2', height: '2', fill: '#d62728' });\n\n  pattern = defs.append('pattern').attrs({\n    id: 'plaid4',\n    width: '6',\n    height: '6',\n    patternUnits: 'userSpaceOnUse',\n    patternTransform: 'rotate(45)'\n  });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '0', width: '6', height: '6', fill: '#FFFFFF' });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '0', width: '2', height: '2', fill: '#9467bd' });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '4', width: '2', height: '2', fill: '#9467bd' });\n  pattern\n    .append('rect')\n    .attrs({ x: '4', y: '0', width: '2', height: '2', fill: '#9467bd' });\n  pattern\n    .append('rect')\n    .attrs({ x: '4', y: '4', width: '2', height: '2', fill: '#9467bd' });\n\n  pattern = defs.append('pattern').attrs({\n    id: 'plaid5',\n    width: '6',\n    height: '6',\n    patternUnits: 'userSpaceOnUse',\n    patternTransform: 'rotate(45)'\n  });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '0', width: '6', height: '6', fill: '#FFFFFF' });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '0', width: '2', height: '2', fill: '#8c564b' });\n  pattern\n    .append('rect')\n    .attrs({ x: '0', y: '4', width: '2', height: '2', fill: '#8c564b' });\n  pattern\n    .append('rect')\n    .attrs({ x: '4', y: '0', width: '2', height: '2', fill: '#8c564b' });\n  pattern\n    .append('rect')\n    .attrs({ x: '4', y: '4', width: '2', height: '2', fill: '#8c564b' });\n}\n\nfunction drawTrackCurves(type) {\n  if (typeof type === 'undefined') type = 'haplo';\n  const myTrackCurves = trackCurves.filter(\n    filterObjectByAttribute('type', type)\n  );\n\n  myTrackCurves.sort(compareCurvesByLineChanges);\n\n  myTrackCurves.forEach(curve => {\n    const xMiddle = (curve.xStart + curve.xEnd) / 2;\n    let d = `M ${curve.xStart} ${curve.yStart}`;\n    d += ` C ${xMiddle} ${curve.yStart} ${xMiddle} ${curve.yEnd} ${\n      curve.xEnd\n    } ${curve.yEnd}`;\n    d += ` V ${curve.yEnd + curve.width}`;\n    d += ` C ${xMiddle} ${curve.yEnd + curve.width} ${xMiddle} ${curve.yStart +\n      curve.width} ${curve.xStart} ${curve.yStart + curve.width}`;\n    d += ' Z';\n    curve.path = d;\n  });\n\n  svg\n    .selectAll('trackCurves')\n    .data(trackCurves)\n    .enter()\n    .append('path')\n    .attr('d', d => d.path)\n    .style('fill', d => d.color)\n    .attr('trackID', d => d.id)\n    .attr('class', d => `track${d.id}`)\n    .attr('color', d => d.color)\n    .on('mouseover', trackMouseOver)\n    .on('mouseout', trackMouseOut)\n    .on('dblclick', trackDoubleClick);\n}\n\nfunction drawTrackCorners(corners, type) {\n  if (typeof type === 'undefined') type = 'haplo';\n  corners = corners.filter(filterObjectByAttribute('type', type));\n\n  svg\n    .selectAll('trackCorners')\n    .data(corners)\n    .enter()\n    .append('path')\n    .attr('d', d => d.path)\n    .style('fill', d => d.color)\n    .attr('trackID', d => d.id)\n    .attr('class', d => `track${d.id}`)\n    .attr('color', d => d.color)\n    .on('mouseover', trackMouseOver)\n    .on('mouseout', trackMouseOut)\n    .on('dblclick', trackDoubleClick);\n}\n\nfunction drawLegend() {\n  let content =\n    '<table class=\"table-sm table-condensed table-nonfluid\"><thead><tr><th>Color</th><th>Trackname</th><th>Show Track</th></tr></thead>';\n  const listeners = [];\n  for (let i = 0; i < tracks.length; i += 1) {\n    if (tracks[i].type === 'haplo') {\n      content += `<tr><td style=\"text-align:right\"><div class=\"color-box\" style=\"background-color: ${generateTrackColor(\n        tracks[i],\n        'exon'\n      )};\"></div></td>`;\n      if (tracks[i].hasOwnProperty('name')) {\n        content += `<td>${tracks[i].name}</td>`;\n      } else {\n        content += `<td>${tracks[i].id}</td>`;\n      }\n      content += `<td><input type=\"checkbox\" checked=true id=\"showTrack${i}\"></td>`;\n      listeners.push(i);\n    }\n  }\n  content += '</table';\n  // $('#legendDiv').html(content);\n  document.getElementById('legendDiv').innerHTML = content;\n  listeners.forEach(i => {\n    document\n      .getElementById(`showTrack${i}`)\n      .addEventListener('click', () => changeTrackVisibility(i), false);\n  });\n}\n\n// Highlight track on mouseover\nfunction trackMouseOver() {\n  /* jshint validthis: true */\n  const trackID = d3.select(this).attr('trackID');\n  d3.selectAll(`.track${trackID}`).style('fill', 'url(#patternA)');\n}\n\n// Highlight node on mouseover\nfunction nodeMouseOver() {\n  /* jshint validthis: true */\n  d3.select(this).style('stroke-width', '4px');\n}\n\n// Restore original track appearance on mouseout\nfunction trackMouseOut() {\n  /* jshint validthis: true */\n  const trackID = d3.select(this).attr('trackID');\n  d3.selectAll(`.track${trackID}`).each(function clearTrackHighlight() {\n    const c = d3.select(this).attr('color');\n    d3.select(this).style('fill', c);\n  });\n}\n\n// Restore original node appearance on mouseout\nfunction nodeMouseOut() {\n  /* jshint validthis: true */\n  d3.select(this).style('stroke-width', '2px');\n}\n\n// Move clicked track to first position\nfunction trackDoubleClick() {\n  /* jshint validthis: true */\n  const trackID = d3.select(this).attr('trackID');\n  let index = 0;\n  while (\n    index < inputTracks.length &&\n    inputTracks[index].id !== Number(trackID)\n  ) {\n    index += 1;\n  }\n  if (index >= inputTracks.length) return;\n  if (DEBUG) console.log(`moving index: ${index}`);\n  moveTrackToFirstPosition(index);\n  createTubeMap();\n}\n\n// Redraw with current node moved to beginning\nfunction nodeDoubleClick() {\n  /* jshint validthis: true */\n  const nodeID = d3.select(this).attr('id');\n  if (config.clickableNodesFlag) {\n    if (reads && config.showReads) {\n      document.getElementById('hgvmNodeID').value = nodeID;\n      document.getElementById('hgvmPostButton').click();\n    } else {\n      document.getElementById('nodeID').value = nodeID;\n      document.getElementById('postButton').click();\n    }\n  }\n}\n\n// extract info about nodes from vg-json\nexport function vgExtractNodes(vg) {\n  const result = [];\n  vg.node.forEach(node => {\n    result.push({\n      name: `${node.id}`,\n      sequenceLength: node.sequence.length,\n      seq: node.sequence\n    });\n  });\n  return result;\n}\n\n// calculate node widths depending on sequence lengths and chosen calculation method\nfunction generateNodeWidth() {\n  nodes.forEach(node => {\n    if (!node.hasOwnProperty('sequenceLength')) {\n      node.sequenceLength = node.seq.length;\n    }\n  });\n\n  switch (config.nodeWidthOption) {\n    case 1:\n      nodes.forEach(node => {\n        node.width = 1 + Math.log(node.sequenceLength) / Math.log(2);\n        node.pixelWidth = Math.round((node.width - 1) * 8.401);\n      });\n      break;\n    case 2:\n      nodes.forEach(node => {\n        node.width = node.sequenceLength / 100;\n        node.pixelWidth = Math.round((node.width - 1) * 8.401);\n      });\n      break;\n    default:\n      nodes.forEach(node => {\n        node.width = node.sequenceLength;\n\n        // get width of node's text label by writing label, measuring it and removing label\n        svg\n          .append('text')\n          .attr('x', 0)\n          .attr('y', 100)\n          .attr('id', 'dummytext')\n          .text(node.seq.substr(1))\n          .attr('font-family', 'Courier, \"Lucida Console\", monospace')\n          .attr('font-size', '14px')\n          .attr('fill', 'black')\n          .style('pointer-events', 'none');\n        node.pixelWidth = Math.round(\n          document.getElementById('dummytext').getComputedTextLength()\n        );\n        document.getElementById('dummytext').remove();\n        // $('#dummytext').remove();\n      });\n  }\n}\n\n// extract track info from vg-json\nexport function vgExtractTracks(vg) {\n  const result = [];\n  vg.path.forEach((path, index) => {\n    const sequence = [];\n    let isCompletelyReverse = true;\n    path.mapping.forEach(pos => {\n      if (\n        pos.position.hasOwnProperty('is_reverse') &&\n        pos.position.is_reverse === true\n      ) {\n        sequence.push(`-${pos.position.node_id}`);\n      } else {\n        sequence.push(`${pos.position.node_id}`);\n        isCompletelyReverse = false;\n      }\n    });\n    if (isCompletelyReverse) {\n      sequence.reverse();\n      sequence.forEach((node, index2) => {\n        sequence[index2] = node.substr(1);\n      });\n    }\n    const track = {};\n    track.id = index;\n    track.sequence = sequence;\n    if (path.hasOwnProperty('freq')) track.freq = path.freq;\n    if (path.hasOwnProperty('name')) track.name = path.name;\n    if (path.hasOwnProperty('indexOfFirstBase')) {\n      track.indexOfFirstBase = Number(path.indexOfFirstBase);\n    }\n    result.push(track);\n  });\n  return result;\n}\n\nfunction compareReadsByLeftEnd(a, b) {\n  let leftNodeA;\n  let leftNodeB;\n  let leftIndexA;\n  let leftIndexB;\n\n  if (a.sequence[0].charAt(0) === '-') {\n    if (a.sequence[a.sequence.length - 1].charAt(0) === '-') {\n      leftNodeA = a.sequence[a.sequence.length - 1].substr(1);\n      leftIndexA =\n        nodes[nodeMap.get(leftNodeA)].sequenceLength - a.finalNodeCoverLength;\n    } else {\n      leftNodeA = a.sequence[a.sequence.length - 1];\n      leftIndexA = 0;\n    }\n  } else {\n    leftNodeA = a.sequence[0];\n    leftIndexA = a.firstNodeOffset;\n  }\n\n  if (b.sequence[0].charAt(0) === '-') {\n    if (b.sequence[b.sequence.length - 1].charAt(0) === '-') {\n      leftNodeB = b.sequence[b.sequence.length - 1].substr(1);\n      leftIndexB =\n        nodes[nodeMap.get(leftNodeB)].sequenceLength - b.finalNodeCoverLength;\n    } else {\n      leftNodeB = b.sequence[b.sequence.length - 1];\n      leftIndexB = 0;\n    }\n  } else {\n    leftNodeB = b.sequence[0];\n    leftIndexB = b.firstNodeOffset;\n  }\n\n  if (leftNodeA < leftNodeB) return -1;\n  else if (leftNodeA > leftNodeB) return 1;\n  if (leftIndexA < leftIndexB) return -1;\n  else if (leftIndexA > leftIndexB) return 1;\n  return 0;\n}\n\nfunction compareReadsByLeftEnd2(a, b) {\n  // compare by order of first node\n  if (nodes[a.indexSequence[0]].order < nodes[b.indexSequence[0]].order) {\n    return -1;\n  } else if (\n    nodes[a.indexSequence[0]].order > nodes[b.indexSequence[0]].order\n  ) {\n    return 1;\n  }\n\n  // compare by first base within first node\n  if (a.firstNodeOffset < b.firstNodeOffset) return -1;\n  else if (a.firstNodeOffset > b.firstNodeOffset) return 1;\n\n  // compare by order of last node\n  if (\n    nodes[a.indexSequence[a.indexSequence.length - 1]].order <\n    nodes[b.indexSequence[b.indexSequence.length - 1]].order\n  ) {\n    return -1;\n  } else if (\n    nodes[a.indexSequence[a.indexSequence.length - 1]].order >\n    nodes[b.indexSequence[b.indexSequence.length - 1]].order\n  ) {\n    return 1;\n  }\n\n  // compare by last base withing last node\n  if (a.finalNodeCoverLength < b.finalNodeCoverLength) return -1;\n  else if (a.finalNodeCoverLength > b.finalNodeCoverLength) return 1;\n\n  return 0;\n}\n\nexport function vgExtractReads(myNodes, myTracks, myReads) {\n  if (DEBUG) {\n    console.log('Reads:');\n    console.log(myReads);\n  }\n  const extracted = [];\n\n  const nodeNames = [];\n  myNodes.forEach(node => {\n    nodeNames.push(node.name, 10);\n  });\n\n  for (let i = 0; i < myReads.length; i += 1) {\n    const read = myReads[i];\n    const sequence = [];\n    const sequenceNew = [];\n    let firstIndex = -1; // index within mapping of the first node id contained in nodeNames\n    let lastIndex = -1; // index within mapping of the last node id contained in nodeNames\n    read.path.mapping.forEach((pos, j) => {\n      if (nodeNames.indexOf(pos.position.node_id) > -1) {\n        const edit = {};\n        let offset = 0;\n        if (\n          pos.position.hasOwnProperty('is_reverse') &&\n          pos.position.is_reverse === true\n        ) {\n          sequence.push(`-${pos.position.node_id}`);\n          edit.nodeName = `-${pos.position.node_id}`;\n        } else {\n          sequence.push(`${pos.position.node_id}`);\n          edit.nodeName = pos.position.node_id.toString();\n        }\n        if (firstIndex < 0) {\n          firstIndex = j;\n          if (pos.position.hasOwnProperty('offset')) {\n            pos.position.offset = parseInt(pos.position.offset, 10);\n            offset = pos.position.offset;\n          }\n        }\n        lastIndex = j;\n\n        const mismatches = [];\n        let posWithinNode = offset;\n        pos.edit.forEach(element => {\n          if (\n            element.hasOwnProperty('to_length') &&\n            !element.hasOwnProperty('from_length')\n          ) {\n            // insertion\n            mismatches.push({\n              type: 'insertion',\n              pos: posWithinNode,\n              seq: element.sequence\n            });\n          } else if (\n            !element.hasOwnProperty('to_length') &&\n            element.hasOwnProperty('from_length')\n          ) {\n            // deletion\n            mismatches.push({\n              type: 'deletion',\n              pos: posWithinNode,\n              length: element.from_length\n            });\n          } else if (element.hasOwnProperty('sequence')) {\n            // substitution\n            if (element.sequence.length > 1) {\n              if (DEBUG) {\n                console.log(\n                  `found substitution at read ${i}, node ${j} = ${\n                    pos.position.node_id\n                  }, seq = ${element.sequence}`\n                );\n              }\n            }\n            mismatches.push({\n              type: 'substitution',\n              pos: posWithinNode,\n              seq: element.sequence\n            });\n          }\n          if (element.hasOwnProperty('from_length')) {\n            posWithinNode += element.from_length;\n          }\n        });\n        edit.mismatches = mismatches;\n        sequenceNew.push(edit);\n      }\n    });\n    if (sequence.length === 0) {\n      if (DEBUG) {\n        console.log(`read ${i} is empty`);\n      }\n    } else {\n      const track = {};\n      track.id = myTracks.length + extracted.length;\n      track.sequence = sequence;\n      track.sequenceNew = sequenceNew;\n      track.type = 'read';\n      if (read.path.hasOwnProperty('freq')) track.freq = read.path.freq;\n      if (read.path.hasOwnProperty('name')) track.name = read.path.name;\n\n      // where within node does read start\n      track.firstNodeOffset = 0;\n      if (read.path.mapping[firstIndex].position.hasOwnProperty('offset')) {\n        track.firstNodeOffset = read.path.mapping[firstIndex].position.offset;\n      }\n\n      // where within node does read end\n      const finalNodeEdit = read.path.mapping[lastIndex].edit;\n      track.finalNodeCoverLength = 0;\n      if (read.path.mapping[lastIndex].position.hasOwnProperty('offset')) {\n        track.finalNodeCoverLength +=\n          read.path.mapping[lastIndex].position.offset;\n      }\n      finalNodeEdit.forEach(edit => {\n        if (edit.hasOwnProperty('from_length')) {\n          track.finalNodeCoverLength += edit.from_length;\n        }\n      });\n\n      extracted.push(track);\n    }\n  }\n  return extracted;\n}\n\n// remove redundant nodes\n// two nodes A and B can be merged if all tracks leaving A go directly into B\n// and all tracks entering B come directly from A\n// (plus no inversions involved)\nfunction mergeNodes() {\n  let nodeName;\n  let nodeName2;\n  const pred = []; // array of set of predecessors of each node\n  const succ = []; // array of set of successors of each node\n  for (let i = 0; i < nodes.length; i += 1) {\n    pred.push(new Set());\n    succ.push(new Set());\n  }\n\n  let tracksAndReads;\n  if (reads && config.showReads) tracksAndReads = tracks.concat(reads);\n  else tracksAndReads = tracks;\n\n  tracksAndReads.forEach(track => {\n    for (let i = 0; i < track.sequence.length; i += 1) {\n      if (track.sequence[i].charAt(0) !== '-') {\n        // forward Node\n        if (i > 0) {\n          nodeName = track.sequence[i - 1];\n          pred[nodeMap.get(track.sequence[i])].add(nodeName);\n          if (nodeName.charAt(0) === '-') {\n            // add 2 predecessors, to make sure there is no node merging in this case\n            pred[nodeMap.get(track.sequence[i])].add(nodeName.substr(1));\n          }\n        } else if (track.type === 'haplo') {\n          pred[nodeMap.get(track.sequence[i])].add('None');\n        }\n        if (i < track.sequence.length - 1) {\n          nodeName = track.sequence[i + 1];\n          succ[nodeMap.get(track.sequence[i])].add(nodeName);\n          if (nodeName.charAt(0) === '-') {\n            // add 2 successors, to make sure there is no node merging in this case\n            succ[nodeMap.get(track.sequence[i])].add(nodeName.substr(1));\n          }\n        } else if (track.type === 'haplo') {\n          succ[nodeMap.get(track.sequence[i])].add('None');\n        }\n      } else {\n        // reverse Node\n        nodeName = track.sequence[i].substr(1);\n        if (i > 0) {\n          nodeName2 = track.sequence[i - 1];\n          if (nodeName2.charAt(0) === '-') {\n            succ[nodeMap.get(nodeName)].add(nodeName2.substr(1));\n          } else {\n            // add 2 successors, to make sure there is no node merging in this case\n            succ[nodeMap.get(nodeName)].add(nodeName2);\n            succ[nodeMap.get(nodeName)].add(`-${nodeName2}`);\n          }\n        } else if (track.type === 'haplo') {\n          succ[nodeMap.get(nodeName)].add('None');\n        }\n        if (i < track.sequence.length - 1) {\n          nodeName2 = track.sequence[i + 1];\n          if (nodeName2.charAt(0) === '-') {\n            pred[nodeMap.get(nodeName)].add(nodeName2.substr(1));\n          } else {\n            pred[nodeMap.get(nodeName)].add(nodeName2);\n            pred[nodeMap.get(nodeName)].add(`-${nodeName2}`);\n          }\n        } else if (track.type === 'haplo') {\n          pred[nodeMap.get(nodeName)].add('None');\n        }\n      }\n    }\n  });\n\n  // convert sets to arrays\n  for (let i = 0; i < nodes.length; i += 1) {\n    succ[i] = Array.from(succ[i]);\n    pred[i] = Array.from(pred[i]);\n  }\n\n  // update reads which pass through merging nodes\n  if (reads && config.showReads) {\n    // sort nodes by order, then by y-coordinate\n    const sortedNodes = nodes.slice();\n    sortedNodes.sort(compareNodesByOrder);\n\n    // iterate over all nodes and calculate their position within the new merged node\n    const mergeOffset = new Map();\n    const mergeOrigin = new Map(); // maps to leftmost node of a node's \"merging cascade\"\n    sortedNodes.forEach(node => {\n      const predecessor = mergeableWithPred(nodeMap.get(node.name), pred, succ);\n      if (predecessor) {\n        mergeOffset.set(\n          node.name,\n          mergeOffset.get(predecessor) +\n            nodes[nodeMap.get(predecessor)].sequenceLength\n        );\n        mergeOrigin.set(node.name, mergeOrigin.get(predecessor));\n      } else {\n        mergeOffset.set(node.name, 0);\n        mergeOrigin.set(node.name, node.name);\n      }\n    });\n\n    reads.forEach(read => {\n      read.firstNodeOffset += mergeOffset.get(read.sequence[0]);\n      read.finalNodeCoverLength += mergeOffset.get(\n        read.sequence[read.sequence.length - 1]\n      );\n      for (let i = read.sequence.length - 1; i >= 0; i -= 1) {\n        if (mergeableWithPred(nodeMap.get(read.sequence[i]), pred, succ)) {\n          const predecessor = mergeableWithPred(\n            nodeMap.get(read.sequence[i]),\n            pred,\n            succ\n          );\n          if (mergeableWithSucc(nodeMap.get(predecessor), pred, succ)) {\n            if (i > 0) {\n              read.sequence.splice(i, 1);\n              // adjust position of mismatches\n              read.sequenceNew[i].mismatches.forEach(mismatch => {\n                mismatch.pos += nodes[nodeMap.get(predecessor)].sequenceLength;\n              });\n              // append mismatches to previous entry's mismatches\n              read.sequenceNew[i - 1].mismatches = read.sequenceNew[\n                i - 1\n              ].mismatches.concat(read.sequenceNew[i].mismatches);\n              read.sequenceNew.splice(i, 1);\n            } else {\n              read.sequence[0] = mergeOrigin.get(read.sequence[0]);\n              read.sequenceNew[i].mismatches.forEach(mismatch => {\n                mismatch.pos += mergeOffset.get(read.sequenceNew[0].nodeName);\n              });\n              read.sequenceNew[0].nodeName = mergeOrigin.get(\n                read.sequenceNew[0].nodeName\n              );\n            }\n          }\n        }\n      }\n    });\n  }\n\n  // update node sequences + sequence lengths\n  for (let i = 0; i < nodes.length; i += 1) {\n    if (mergeableWithSucc(i, pred, succ) && !mergeableWithPred(i, pred, succ)) {\n      let donor = i;\n      while (mergeableWithSucc(donor, pred, succ)) {\n        donor = succ[donor][0];\n        if (donor.charAt(0) === '-') donor = donor.substr(1);\n        donor = nodeMap.get(donor);\n        if (nodes[i].hasOwnProperty('sequenceLength')) {\n          nodes[i].sequenceLength += nodes[donor].sequenceLength;\n        } else {\n          nodes[i].width += nodes[donor].width;\n        }\n        nodes[i].seq += nodes[donor].seq;\n      }\n    }\n  }\n\n  // actually merge the nodes by removing the corresponding nodes from track data\n  tracks.forEach(track => {\n    for (let i = track.sequence.length - 1; i >= 0; i -= 1) {\n      nodeName = track.sequence[i];\n      if (nodeName.charAt(0) === '-') nodeName = nodeName.substr(1);\n      const nodeIndex = nodeMap.get(nodeName);\n      if (mergeableWithPred(nodeIndex, pred, succ)) {\n        track.sequence.splice(i, 1);\n      }\n    }\n  });\n\n  // remove the nodes from node-array\n  for (let i = nodes.length - 1; i >= 0; i -= 1) {\n    if (mergeableWithPred(i, pred, succ)) {\n      nodes.splice(i, 1);\n    }\n  }\n}\n\nfunction mergeableWithPred(index, pred, succ) {\n  if (pred[index].length !== 1) return false;\n  if (pred[index][0] === 'None') return false;\n  let predecessor = pred[index][0];\n  if (predecessor.charAt(0) === '-') predecessor = predecessor.substr(1);\n  const predecessorIndex = nodeMap.get(predecessor);\n  if (succ[predecessorIndex].length !== 1) return false;\n  if (succ[predecessorIndex][0] === 'None') return false;\n  return predecessor;\n}\n\nfunction mergeableWithSucc(index, pred, succ) {\n  if (succ[index].length !== 1) return false;\n  if (succ[index][0] === 'None') return false;\n  let successor = succ[index][0];\n  if (successor.charAt(0) === '-') successor = successor.substr(1);\n  const successorIndex = nodeMap.get(successor);\n  if (pred[successorIndex].length !== 1) return false;\n  if (pred[successorIndex][0] === 'None') return false;\n  return true;\n}\n\nfunction drawMismatches() {\n  tracks.forEach((read, trackIdx) => {\n    if (read.type === 'read') {\n      read.sequenceNew.forEach((element, i) => {\n        element.mismatches.forEach(mm => {\n          const nodeIndex = nodeMap.get(element.nodeName);\n          const node = nodes[nodeIndex];\n          const x = getXCoordinateOfBaseWithinNode(node, mm.pos);\n          let pathIndex = i;\n          while (read.path[pathIndex].node !== nodeIndex) pathIndex += 1;\n          const y = read.path[pathIndex].y;\n          if (mm.type === 'insertion') {\n            if (\n              config.showSoftClips ||\n              ((mm.pos !== read.firstNodeOffset || i !== 0) &&\n                (mm.pos !== read.finalNodeCoverLength ||\n                  i !== read.sequenceNew.length - 1))\n            ) {\n              drawInsertion(x - 3, y + 7, mm.seq, node.y);\n            }\n          } else if (mm.type === 'deletion') {\n            const x2 = getXCoordinateOfBaseWithinNode(node, mm.pos + mm.length);\n            drawDeletion(x, x2, y + 4, node.y);\n          } else if (mm.type === 'substitution') {\n            const x2 = getXCoordinateOfBaseWithinNode(\n              node,\n              mm.pos + mm.seq.length\n            );\n            drawSubstitution(x + 1, x2, y + 7, node.y, mm.seq);\n          }\n        });\n      });\n    }\n  });\n}\n\nfunction drawInsertion(x, y, seq, nodeY) {\n  svg\n    .append('text')\n    .attr('x', x)\n    .attr('y', y)\n    .text('*')\n    .attr('font-family', 'Courier, \"Lucida Console\", monospace')\n    .attr('font-size', '12px')\n    .attr('fill', 'black')\n    .attr('nodeY', nodeY)\n    .on('mouseover', insertionMouseOver)\n    .on('mouseout', insertionMouseOut)\n    .append('svg:title')\n    .text(seq);\n}\n\nfunction drawSubstitution(x1, x2, y, nodeY, seq) {\n  svg\n    .append('text')\n    .attr('x', x1)\n    .attr('y', y)\n    .text(seq)\n    .attr('font-family', 'Courier, \"Lucida Console\", monospace')\n    .attr('font-size', '12px')\n    .attr('fill', 'black')\n    .attr('nodeY', nodeY)\n    .attr('rightX', x2)\n    .on('mouseover', substitutionMouseOver)\n    .on('mouseout', substitutionMouseOut);\n}\n\nfunction drawDeletion(x1, x2, y, nodeY) {\n  // draw horizontal block\n  svg\n    .append('line')\n    .attr('x1', x1)\n    .attr('y1', y - 1)\n    .attr('x2', x2)\n    .attr('y2', y - 1)\n    .attr('stroke-width', 7)\n    .attr('stroke', 'grey')\n    .attr('nodeY', nodeY)\n    .on('mouseover', deletionMouseOver)\n    .on('mouseout', deletionMouseOut);\n}\n\nfunction insertionMouseOver() {\n  /* jshint validthis: true */\n  d3.select(this).attr('fill', 'red');\n  const x = Number(d3.select(this).attr('x'));\n  const y = Number(d3.select(this).attr('y'));\n  const yTop = Number(d3.select(this).attr('nodeY'));\n  svg\n    .append('line')\n    .attr('class', 'insertionHighlight')\n    .attr('x1', x + 4)\n    .attr('y1', y - 10)\n    .attr('x2', x + 4)\n    .attr('y2', yTop + 5)\n    .attr('stroke-width', 1)\n    .attr('stroke', 'black');\n}\n\nfunction deletionMouseOver() {\n  /* jshint validthis: true */\n  d3.select(this).attr('stroke', 'red');\n  const x1 = Number(d3.select(this).attr('x1'));\n  const x2 = Number(d3.select(this).attr('x2'));\n  const y = Number(d3.select(this).attr('y1'));\n  const yTop = Number(d3.select(this).attr('nodeY'));\n  svg\n    .append('line')\n    .attr('class', 'deletionHighlight')\n    .attr('x1', x1)\n    .attr('y1', y - 3)\n    .attr('x2', x1)\n    .attr('y2', yTop + 5)\n    .attr('stroke-width', 1)\n    .attr('stroke', 'black');\n  svg\n    .append('line')\n    .attr('class', 'deletionHighlight')\n    .attr('x1', x2)\n    .attr('y1', y - 3)\n    .attr('x2', x2)\n    .attr('y2', yTop + 5)\n    .attr('stroke-width', 1)\n    .attr('stroke', 'black');\n}\n\nfunction substitutionMouseOver() {\n  /* jshint validthis: true */\n  d3.select(this).attr('fill', 'red');\n  const x1 = Number(d3.select(this).attr('x'));\n  const x2 = Number(d3.select(this).attr('rightX'));\n  const y = Number(d3.select(this).attr('y'));\n  const yTop = Number(d3.select(this).attr('nodeY'));\n  svg\n    .append('line')\n    .attr('class', 'substitutionHighlight')\n    .attr('x1', x1 - 1)\n    .attr('y1', y - 7)\n    .attr('x2', x1 - 1)\n    .attr('y2', yTop + 5)\n    .attr('stroke-width', 1)\n    .attr('stroke', 'black');\n  svg\n    .append('line')\n    .attr('class', 'substitutionHighlight')\n    .attr('x1', x2 + 1)\n    .attr('y1', y - 7)\n    .attr('x2', x2 + 1)\n    .attr('y2', yTop + 5)\n    .attr('stroke-width', 1)\n    .attr('stroke', 'black');\n}\n\nfunction insertionMouseOut() {\n  /* jshint validthis: true */\n  d3.select(this).attr('fill', 'black');\n  d3.selectAll('.insertionHighlight').remove();\n}\n\nfunction deletionMouseOut() {\n  /* jshint validthis: true */\n  d3.select(this).attr('stroke', 'grey');\n  d3.selectAll('.deletionHighlight').remove();\n}\n\nfunction substitutionMouseOut() {\n  /* jshint validthis: true */\n  d3.select(this).attr('fill', 'black');\n  d3.selectAll('.substitutionHighlight').remove();\n}\n","export const dataOriginTypes = {\n  API: 'API',\n  EXAMPLE_1: 'example 1',\n  EXAMPLE_2: 'example 2',\n  EXAMPLE_3: 'example 3',\n  EXAMPLE_4: 'example 4',\n  EXAMPLE_5: 'example 5',\n  EXAMPLE_6: 'example 6'\n};\n","import React, { Component } from 'react';\nimport { Form, Label, Input, Button } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faStepBackward,\n  faStepForward,\n  faSearchPlus,\n  faSearchMinus\n} from '@fortawesome/free-solid-svg-icons';\nimport * as tubeMap from '../util/tubemap';\n\nconst ZOOM_FACTOR = 2.0;\n\nclass DataPositionFormRow extends Component {\n  handleZoomIn = () => {\n    tubeMap.zoomBy(ZOOM_FACTOR);\n  };\n\n  handleZoomOut = () => {\n    tubeMap.zoomBy(1.0 / ZOOM_FACTOR);\n  };\n\n  handleDownloadButton = () => {\n    const svgN = document.getElementById('svg');\n    const svgData = new XMLSerializer().serializeToString(svgN);\n    const svgBlob = new Blob([svgData], {\n      type: 'image/svg+xml;charset=utf-8'\n    });\n    const svgUrl = URL.createObjectURL(svgBlob);\n\n    const downloadLink = document.createElement('a');\n    downloadLink.href = svgUrl;\n    downloadLink.download = 'graph.svg';\n    document.body.appendChild(downloadLink);\n    downloadLink.click();\n    document.body.removeChild(downloadLink);\n  };\n\n  render() {\n    return (\n      <Form inline>\n        <Label className=\"tight-label mb-2 mr-sm-2 mb-sm-0 ml-2\" for=\"nodeID\">\n          Start:\n        </Label>\n        <Input\n          type=\"text\"\n          className=\"custom-input form-control mb-2 mr-sm-4 mb-sm-0\"\n          id=\"nodeID\"\n          size=\"12\"\n          value={this.props.nodeID}\n          onChange={this.props.handleInputChange}\n        />\n        <Label className=\"tight-label mb-2 mr-sm-2 mb-sm-0 ml-2\" for=\"distance\">\n          Length:\n        </Label>\n        <Input\n          type=\"text\"\n          className=\"custom-input form-control mb-2 mr-sm-2 mb-sm-0\"\n          id=\"distance\"\n          size=\"4\"\n          value={this.props.distance}\n          onChange={this.props.handleInputChange}\n        />\n        <Label\n          className=\"tight-label mb-2 mr-sm-2 mb-sm-0 ml-2\"\n          for=\"unitSelect\"\n        >\n          Unit:\n        </Label>\n        <Input\n          type=\"select\"\n          className=\"custom-select mb-2 mr-sm-2 mb-sm-0\"\n          id=\"byNode\"\n          value={this.props.byNode}\n          onChange={this.props.handleInputChange}\n        >\n          <option value=\"false\">Nucleotides</option>\n          <option value=\"true\">Nodes</option>\n        </Input>\n        &nbsp;\n        {this.props.uploadInProgress && (\n          <div className=\"smallLoader\" id=\"fileUploadSpinner\" />\n        )}\n        <Button\n          color=\"primary\"\n          id=\"goButton\"\n          onClick={this.props.handleGoButton}\n          disabled={this.props.uploadInProgress}\n        >\n          Go\n        </Button>\n        <Button\n          color=\"primary\"\n          id=\"goLeftButton\"\n          onClick={this.props.handleGoLeft}\n        >\n          <FontAwesomeIcon icon={faStepBackward} size=\"lg\" />\n        </Button>\n        <Button color=\"primary\" id=\"zoomInButton\" onClick={this.handleZoomIn}>\n          <FontAwesomeIcon icon={faSearchPlus} size=\"lg\" />\n        </Button>\n        <Button color=\"primary\" id=\"zoomOutButton\" onClick={this.handleZoomOut}>\n          <FontAwesomeIcon icon={faSearchMinus} size=\"lg\" />\n        </Button>\n        <Button\n          color=\"primary\"\n          id=\"goRightButton\"\n          onClick={this.props.handleGoRight}\n        >\n          <FontAwesomeIcon icon={faStepForward} size=\"lg\" />\n        </Button>\n        <Button\n          color=\"secondary\"\n          id=\"downloadButton\"\n          onClick={this.handleDownloadButton}\n        >\n          Download Image\n        </Button>\n      </Form>\n    );\n  }\n}\n\nexport default DataPositionFormRow;\n","import React, { Component } from 'react';\nimport { Label, Input } from 'reactstrap';\n\nclass MountedDataFormRow extends Component {\n  render() {\n    const xgFileDropdownOptions = this.props.xgSelectOptions.map(fileName => {\n      return (\n        <option value={fileName} key={fileName}>\n          {fileName}\n        </option>\n      );\n    });\n\n    const gbwtFileDropdownOptions = this.props.gbwtSelectOptions.map(\n      fileName => {\n        return (\n          <option value={fileName} key={fileName}>\n            {fileName}\n          </option>\n        );\n      }\n    );\n\n    const gamFileDropdownOptions = this.props.gamSelectOptions.map(fileName => {\n      return (\n        <option value={fileName} key={fileName}>\n          {fileName}\n        </option>\n      );\n    });\n\n    const pathDropdownOptions = this.props.pathSelectOptions.map(pathName => {\n      return (\n        <option value={pathName} key={pathName}>\n          {pathName}\n        </option>\n      );\n    });\n\n    return (\n      <React.Fragment>\n        <Label className=\"customData tight-label mb-2 mr-sm-2 mb-sm-0 ml-2\">\n          xg file:\n        </Label>\n        <Input\n          type=\"select\"\n          className=\"customDataMounted custom-select mb-2 mr-sm-4 mb-sm-0\"\n          id=\"xgSelect\"\n          value={this.props.xgSelect}\n          onChange={this.props.handleInputChange}\n        >\n          {xgFileDropdownOptions}\n        </Input>\n\n        <Label\n          for=\"gbwtFileSelect\"\n          className=\"customData tight-label mb-2 mr-sm-2 mb-sm-0 ml-2\"\n        >\n          gbwt file:\n        </Label>\n        <Input\n          type=\"select\"\n          className=\"customDataMounted custom-select mb-2 mr-sm-4 mb-sm-0\"\n          id=\"gbwtSelect\"\n          value={this.props.gbwtSelect}\n          onChange={this.props.handleInputChange}\n        >\n          {gbwtFileDropdownOptions}\n        </Input>\n\n        <Label\n          for=\"gamFileSelect\"\n          className=\"customData tight-label mb-2 mr-sm-2 mb-sm-0 ml-2\"\n        >\n          gam index:\n        </Label>\n        <Input\n          type=\"select\"\n          className=\"customDataMounted custom-select mb-2 mr-sm-4 mb-sm-0\"\n          id=\"gamSelect\"\n          value={this.props.gamSelect}\n          onChange={this.props.handleInputChange}\n        >\n          {gamFileDropdownOptions}\n        </Input>\n\n        <Label\n          for=\"pathName\"\n          className=\"customData tight-label mb-2 mr-sm-2 mb-sm-0 ml-2\"\n        >\n          Path name:\n        </Label>\n        <Input\n          type=\"select\"\n          className=\"customData custom-select mb-2 mr-sm-4 mb-sm-0\"\n          id=\"pathSelect\"\n          value={this.props.pathSelect}\n          onChange={this.props.handleInputChange}\n        >\n          {pathDropdownOptions}\n        </Input>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default MountedDataFormRow;\n","import React, { Component } from 'react';\nimport { Label, Input } from 'reactstrap';\nimport config from '../config.json';\n\nconst BACKEND_URL = config.BACKEND_URL || `http://${window.location.host}`;\nconst MAX_UPLOAD_SIZE = 5242880;\n\nclass FileUploadFormRow extends Component {\n  constructor(props) {\n    super(props);\n    this.xgFileInput = React.createRef();\n    this.gbwtFileInput = React.createRef();\n    this.gamFileInput = React.createRef();\n  }\n\n  onXgFileChange = () => {\n    const file = this.xgFileInput.current.files[0];\n    if (file === undefined) {\n      this.props.resetPathNames();\n      this.props.handleFileUpload('xgFile', 'none');\n    } else {\n      if (file.size > MAX_UPLOAD_SIZE) {\n        this.xgFileInput.current.value = '';\n        this.props.showFileSizeAlert();\n        return;\n      }\n      this.props.setUploadInProgress(true);\n      const formData = new FormData();\n      formData.append('xgFile', file);\n      const xhr = new XMLHttpRequest();\n      xhr.responseType = 'json';\n      xhr.onreadystatechange = () => {\n        if (xhr.readyState === 4 && xhr.status === 200) {\n          // Every thing ok, file uploaded\n          this.props.setUploadInProgress(false);\n          this.props.handleFileUpload('xgFile', xhr.response.path);\n          this.props.getPathNames(xhr.response.path, 'true');\n        }\n      };\n      xhr.open('POST', `${BACKEND_URL}/xgFileSubmission`, true);\n      xhr.send(formData);\n    }\n  };\n\n  onGbwtFileChange = () => {\n    const file = this.gbwtFileInput.current.files[0];\n    if (file === undefined) {\n      this.props.handleFileUpload('gbwtFile', 'none');\n    } else {\n      if (file.size > MAX_UPLOAD_SIZE) {\n        this.gbwtFileInput.current.value = '';\n        this.props.showFileSizeAlert();\n        return;\n      }\n      this.props.setUploadInProgress(true);\n      const formData = new FormData();\n      formData.append('gbwtFile', file);\n      const xhr = new XMLHttpRequest();\n      xhr.responseType = 'json';\n      xhr.onreadystatechange = () => {\n        if (xhr.readyState === 4 && xhr.status === 200) {\n          // Every thing ok, file uploaded\n          this.props.setUploadInProgress(false);\n          this.props.handleFileUpload('gbwtFile', xhr.response.path);\n        }\n      };\n      xhr.open('POST', `${BACKEND_URL}/gbwtFileSubmission`, true);\n      xhr.send(formData);\n    }\n  };\n\n  onGamFileChange = () => {\n    const file = this.gamFileInput.current.files[0];\n    if (file === undefined) {\n      this.props.handleFileUpload('gamFile', 'none');\n    } else {\n      if (file.size > MAX_UPLOAD_SIZE) {\n        this.gamFileInput.current.value = '';\n        this.props.showFileSizeAlert();\n        return;\n      }\n      this.props.setUploadInProgress(true);\n      const formData = new FormData();\n      formData.append('gamFile', file);\n      const xhr = new XMLHttpRequest();\n      xhr.responseType = 'json';\n      xhr.onreadystatechange = () => {\n        if (xhr.readyState === 4 && xhr.status === 200) {\n          // Every thing ok, file uploaded\n          this.props.setUploadInProgress(false);\n          this.props.handleFileUpload('gamFile', xhr.response.path);\n        }\n      };\n      xhr.open('POST', `${BACKEND_URL}/gamFileSubmission`, true);\n      xhr.send(formData);\n    }\n  };\n\n  render() {\n    const pathDropdownOptions = this.props.pathSelectOptions.map(pathName => {\n      return (\n        <option value={pathName} key={pathName}>\n          {pathName}\n        </option>\n      );\n    });\n\n    return (\n      <React.Fragment>\n        <Label className=\"customData tight-label mb-2 mr-sm-2 mb-sm-0 ml-2\">\n          xg file:\n        </Label>\n        <Input\n          type=\"file\"\n          className=\"customDataUpload form-control-file\"\n          id=\"xgFileUpload\"\n          accept=\".xg\"\n          innerRef={this.xgFileInput}\n          onChange={this.onXgFileChange}\n        />\n        <Label\n          for=\"gbwtFileSelect\"\n          className=\"customData tight-label mb-2 mr-sm-2 mb-sm-0 ml-2\"\n        >\n          gbwt file:\n        </Label>\n        <Input\n          type=\"file\"\n          className=\"customDataUpload form-control-file\"\n          id=\"gbwtFileUpload\"\n          accept=\".gbwt\"\n          innerRef={this.gbwtFileInput}\n          onChange={this.onGbwtFileChange}\n        />\n        <Label\n          for=\"gamFileSelect\"\n          className=\"customData tight-label mb-2 mr-sm-2 mb-sm-0 ml-2\"\n        >\n          gam index:\n        </Label>\n        <Input\n          type=\"file\"\n          className=\"customDataUpload form-control-file\"\n          id=\"gamFileUpload\"\n          accept=\".gam\"\n          innerRef={this.gamFileInput}\n          onChange={this.onGamFileChange}\n        />\n        <Label\n          for=\"pathName\"\n          className=\"customData tight-label mb-2 mr-sm-2 mb-sm-0 ml-2\"\n        >\n          Path name:\n        </Label>\n        <Input\n          type=\"select\"\n          className=\"customData custom-select mb-2 mr-sm-4 mb-sm-0\"\n          id=\"pathSelect\"\n          value={this.props.pathSelect}\n          onChange={this.props.handleInputChange}\n        >\n          {pathDropdownOptions}\n        </Input>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default FileUploadFormRow;\n","import React, { Component } from 'react';\nimport { Form, Button } from 'reactstrap';\nimport { dataOriginTypes } from '../enums';\n\nclass ExampleSelectButtons extends Component {\n  handleClick = (dataOrigin, haploColor, readColor) => {\n    this.props.setDataOrigin(dataOrigin);\n    this.props.setColorSetting('haplotypeColors', haploColor);\n    if (readColor) {\n      this.props.setColorSetting('forwardReadColors', readColor);\n    }\n  };\n\n  render() {\n    return (\n      <Form inline>\n        <Button\n          color=\"primary\"\n          id=\"example1\"\n          onClick={() =>\n            this.handleClick(dataOriginTypes.EXAMPLE_1, 'plainColors')\n          }\n        >\n          Indels and Polymorphisms only\n        </Button>\n        <Button\n          color=\"primary\"\n          id=\"example2\"\n          onClick={() =>\n            this.handleClick(dataOriginTypes.EXAMPLE_2, 'plainColors')\n          }\n        >\n          Inversions\n        </Button>\n        <Button\n          color=\"primary\"\n          id=\"example3\"\n          onClick={() =>\n            this.handleClick(dataOriginTypes.EXAMPLE_3, 'plainColors')\n          }\n        >\n          Nested Inversions\n        </Button>\n        <Button\n          color=\"primary\"\n          id=\"example4\"\n          onClick={() =>\n            this.handleClick(dataOriginTypes.EXAMPLE_4, 'plainColors')\n          }\n        >\n          Duplications\n        </Button>\n        <Button\n          color=\"primary\"\n          id=\"example5\"\n          onClick={() =>\n            this.handleClick(dataOriginTypes.EXAMPLE_5, 'plainColors')\n          }\n        >\n          Translocations\n        </Button>\n        <Button\n          color=\"primary\"\n          id=\"example6\"\n          onClick={() =>\n            this.handleClick(dataOriginTypes.EXAMPLE_6, 'greys', 'reds')\n          }\n        >\n          Aligned Reads\n        </Button>\n      </Form>\n    );\n  }\n}\n\nexport default ExampleSelectButtons;\n","import React, { Component } from 'react';\nimport { Container, Row, Col, Form, Label, Input, Alert } from 'reactstrap';\nimport { dataOriginTypes } from '../enums';\nimport defaultConfig from '../config.default.json';\nimport config from '../config.json';\nimport DataPositionFormRow from './DataPositionFormRow';\nimport MountedDataFormRow from './MountedDataFormRow';\nimport FileUploadFormRow from './FileUploadFormRow';\nimport ExampleSelectButtons from './ExampleSelectButtons';\n\nconst BACKEND_URL = config.BACKEND_URL || `http://${window.location.host}`;\nconst DATA_SOURCES = defaultConfig.DATA_SOURCES.concat(config.DATA_SOURCES);\nconst MAX_UPLOAD_SIZE_DESCRIPTION = '5 MB';\nconst dataTypes = {\n  BUILT_IN: 'built-in',\n  FILE_UPLOAD: 'file-upload',\n  MOUNTED_FILES: 'mounted files',\n  EXAMPLES: 'examples'\n};\n\nclass HeaderForm extends Component {\n  state = {\n    xgSelectOptions: ['none'],\n    xgSelect: 'none',\n\n    gbwtSelectOptions: ['none'],\n    gbwtSelect: 'none',\n\n    gamSelectOptions: ['none'],\n    gamSelect: 'none',\n\n    pathSelectOptions: ['none'],\n    pathSelect: 'none',\n\n    xgFile: 'snp1kg-BRCA1.vg.xg',\n    gbwtFile: '',\n    gamFile: 'NA12878-BRCA1.sorted.gam',\n    anchorTrackName: '17',\n    dataPath: 'default',\n\n    nodeID: '1',\n    distance: '100',\n    byNode: 'false',\n\n    dataType: dataTypes.BUILT_IN,\n    fileSizeAlert: false,\n    uploadInProgress: false\n  };\n\n  componentDidMount() {\n    this.getMountedFilenames();\n    this.setUpWebsocket();\n  }\n\n  getMountedFilenames = async () => {\n    try {\n      const response = await fetch(`${BACKEND_URL}/getFilenames`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      const json = await response.json();\n      json.xgFiles.unshift('none');\n      json.gbwtFiles.unshift('none');\n      json.gamIndices.unshift('none');\n\n      this.setState(state => {\n        const xgSelect = json.xgFiles.includes(state.xgSelect)\n          ? state.xgSelect\n          : 'none';\n        const gbwtSelect = json.gbwtFiles.includes(state.gbwtSelect)\n          ? state.gbwtSelect\n          : 'none';\n        const gamSelect = json.gamIndices.includes(state.gamSelect)\n          ? state.gamSelect\n          : 'none';\n        return {\n          xgSelectOptions: json.xgFiles,\n          gbwtSelectOptions: json.gbwtFiles,\n          gamSelectOptions: json.gamIndices,\n          xgSelect,\n          gbwtSelect,\n          gamSelect\n        };\n      });\n    } catch (error) {\n      console.log('POST to /getFilenames failed');\n    }\n  };\n\n  getPathNames = async (xgFile, isUploadedFile) => {\n    try {\n      const response = await fetch(`${BACKEND_URL}/getPathNames`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ xgFile, isUploadedFile })\n      });\n      const json = await response.json();\n      this.setState(state => {\n        const pathSelect = json.pathNames.includes(state.pathSelect)\n          ? state.pathSelect\n          : json.pathNames[0];\n        return {\n          pathSelectOptions: json.pathNames,\n          pathSelect,\n          anchorTrackName: pathSelect\n        };\n      });\n    } catch (error) {\n      console.log('POST to /getPathNames failed');\n    }\n  };\n\n  resetPathNames = () => {\n    this.setState({\n      pathSelectOptions: ['none'],\n      pathSelect: 'none'\n    });\n  };\n\n  handleDataSourceChange = event => {\n    const value = event.target.value;\n    DATA_SOURCES.forEach(ds => {\n      if (ds.name === value) {\n        this.setState({\n          xgFile: ds.xgFile,\n          gbwtFile: ds.gbwtFile,\n          gamFile: ds.gamFile,\n          anchorTrackName: ds.anchorTrackName,\n          dataPath: ds.useMountedPath ? 'mounted' : 'default',\n          nodeID: ds.defaultPosition,\n          dataType: dataTypes.BUILT_IN\n        });\n        return;\n      }\n    });\n    if (value === 'customFileUpload') {\n      this.setState(state => {\n        return {\n          xgFile: state.xgSelect,\n          gbwtFile: state.gbwtSelect,\n          gamFile: state.gamSelect,\n          anchorTrackName: state.pathSelect,\n          dataPath: 'upload',\n          dataType: dataTypes.FILE_UPLOAD\n        };\n      });\n    } else if (value === 'customMounted') {\n      this.setState(state => {\n        return {\n          xgFile: state.xgSelect,\n          gbwtFile: state.gbwtSelect,\n          gamFile: state.gamSelect,\n          anchorTrackName: state.pathSelect,\n          dataPath: 'mounted',\n          dataType: dataTypes.MOUNTED_FILES\n        };\n      });\n    } else if (value === 'syntheticExamples') {\n      this.setState({ dataType: dataTypes.EXAMPLES });\n    }\n  };\n\n  handleGoButton = () => {\n    if (this.props.dataOrigin !== dataOriginTypes.API) {\n      this.props.setColorSetting('haplotypeColors', 'greys');\n      this.props.setColorSetting('forwardReadColors', 'reds');\n    }\n    const fetchParams = {\n      nodeID: this.state.nodeID,\n      distance: this.state.distance,\n      byNode: this.state.byNode,\n      xgFile: this.state.xgFile,\n      gbwtFile: this.state.gbwtFile,\n      gamFile: this.state.gamFile,\n      anchorTrackName: this.state.anchorTrackName,\n      dataPath: this.state.dataPath\n    };\n    this.props.setFetchParams(fetchParams);\n  };\n\n  handleInputChange = event => {\n    const id = event.target.id;\n    const value = event.target.value;\n    this.setState({ [id]: value });\n    if (id === 'xgSelect') {\n      this.getPathNames(value, false);\n      this.setState({ xgFile: value });\n    } else if (id === 'gbwtSelect') {\n      this.setState({ gbwtFile: value });\n    } else if (id === 'gamSelect') {\n      this.setState({ gamFile: value });\n    } else if (id === 'pathSelect') {\n      this.setState({ anchorTrackName: value });\n    }\n  };\n\n  handleGoRight = () => {\n    this.setState(\n      state => ({\n        nodeID: Number(this.state.nodeID) + Number(this.state.distance)\n      }),\n      () => this.handleGoButton()\n    );\n  };\n\n  handleGoLeft = () => {\n    this.setState(\n      state => ({\n        nodeID: Math.max(\n          0,\n          Number(this.state.nodeID) - Number(this.state.distance)\n        )\n      }),\n      () => this.handleGoButton()\n    );\n  };\n\n  handleFileUpload = (fileType, fileName) => {\n    this.setState({ [fileType]: fileName });\n  };\n\n  showFileSizeAlert = () => {\n    this.setState({ fileSizeAlert: true });\n  };\n\n  setUploadInProgress = val => {\n    this.setState({ uploadInProgress: val });\n  };\n\n  setUpWebsocket = () => {\n    this.ws = new WebSocket(BACKEND_URL.replace(/^http/, 'ws'));\n    this.ws.onmessage = message => {\n      this.getMountedFilenames();\n    };\n    this.ws.onclose = event => {\n      setTimeout(this.setUpWebsocket, 1000);\n    };\n    this.ws.onerror = event => {\n      this.ws.close();\n    };\n  };\n\n  render() {\n    let dataSourceDropdownOptions = DATA_SOURCES.map(ds => {\n      return (\n        <option value={ds.name} key={ds.name}>\n          {ds.name}\n        </option>\n      );\n    });\n    dataSourceDropdownOptions.push(\n      <option value=\"syntheticExamples\" key=\"syntheticExamples\">\n        synthetic data examples\n      </option>,\n      <option value=\"customFileUpload\" key=\"customFileUpload\">\n        custom (file upload)\n      </option>,\n      <option value=\"customMounted\" key=\"customMounted\">\n        custom (mounted files)\n      </option>\n    );\n\n    const mountedFilesFlag = this.state.dataType === dataTypes.MOUNTED_FILES;\n    const uploadFilesFlag = this.state.dataType === dataTypes.FILE_UPLOAD;\n    const examplesFlag = this.state.dataType === dataTypes.EXAMPLES;\n\n    return (\n      <div>\n        <Container fluid={true}>\n          <Row>\n            <Col md=\"auto\">\n              <img src=\"./logo.png\" alt=\"Logo\" />\n            </Col>\n            <Col>\n              <Form inline>\n                <Label\n                  className=\"tight-label mb-2 mr-sm-2 mb-sm-0 ml-2\"\n                  for=\"dataSourceSelect\"\n                >\n                  Data:\n                </Label>\n                <Input\n                  type=\"select\"\n                  id=\"dataSourceSelect\"\n                  className=\"custom-select mb-2 mr-sm-4 mb-sm-0\"\n                  onChange={this.handleDataSourceChange}\n                >\n                  {dataSourceDropdownOptions}\n                </Input>\n                {mountedFilesFlag && (\n                  <MountedDataFormRow\n                    xgSelect={this.state.xgSelect}\n                    xgSelectOptions={this.state.xgSelectOptions}\n                    gbwtSelect={this.state.gbwtSelect}\n                    gbwtSelectOptions={this.state.gbwtSelectOptions}\n                    gamSelect={this.state.gamSelect}\n                    gamSelectOptions={this.state.gamSelectOptions}\n                    pathSelect={this.state.pathSelect}\n                    pathSelectOptions={this.state.pathSelectOptions}\n                    handleInputChange={this.handleInputChange}\n                  />\n                )}\n                {uploadFilesFlag && (\n                  <FileUploadFormRow\n                    pathSelect={this.state.pathSelect}\n                    pathSelectOptions={this.state.pathSelectOptions}\n                    handleInputChange={this.handleInputChange}\n                    getPathNames={this.getPathNames}\n                    resetPathNames={this.resetPathNames}\n                    handleFileUpload={this.handleFileUpload}\n                    showFileSizeAlert={this.showFileSizeAlert}\n                    setUploadInProgress={this.setUploadInProgress}\n                  />\n                )}\n              </Form>\n              <Alert\n                color=\"danger\"\n                isOpen={this.state.fileSizeAlert}\n                toggle={() => {\n                  this.setState({ fileSizeAlert: false });\n                }}\n                className=\"mt-3\"\n              >\n                <strong>File size too big! </strong>\n                You may only upload files with a maximum size of{' '}\n                {MAX_UPLOAD_SIZE_DESCRIPTION}.\n              </Alert>\n              {examplesFlag ? (\n                <ExampleSelectButtons\n                  setDataOrigin={this.props.setDataOrigin}\n                  setColorSetting={this.props.setColorSetting}\n                />\n              ) : (\n                <DataPositionFormRow\n                  nodeID={this.state.nodeID}\n                  distance={this.state.distance}\n                  byNode={this.state.byNode}\n                  handleInputChange={this.handleInputChange}\n                  handleGoLeft={this.handleGoLeft}\n                  handleGoRight={this.handleGoRight}\n                  handleGoButton={this.handleGoButton}\n                  uploadInProgress={this.state.uploadInProgress}\n                />\n              )}\n            </Col>\n          </Row>\n        </Container>\n      </div>\n    );\n  }\n}\n\nexport default HeaderForm;\n","import React, { Component } from 'react';\nimport * as tubeMap from '../util/tubemap';\n\nclass TubeMap extends Component {\n  componentDidMount() {\n    this.createTubeMap();\n  }\n\n  componentDidUpdate() {\n    this.createTubeMap();\n  }\n\n  createTubeMap = () => {\n    tubeMap.create({\n      svgID: '#svg',\n      nodes: this.props.nodes,\n      tracks: this.props.tracks,\n      reads: this.props.reads\n    });\n  };\n\n  render() {\n    return <svg id=\"svg\" />;\n  }\n}\n\nexport default TubeMap;\n","import React, { Component } from 'react';\nimport TubeMap from './TubeMap';\nimport config from '../config.json';\nimport { Container, Row, Alert } from 'reactstrap';\nimport * as tubeMap from '../util/tubemap';\nimport { dataOriginTypes } from '../enums';\n\nconst BACKEND_URL = config.BACKEND_URL || `http://${window.location.host}`;\n\nclass TubeMapContainer extends Component {\n  state = {\n    isLoading: true,\n    error: null\n  };\n\n  componentDidMount() {\n    this.getRemoteTubeMapData();\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.dataOrigin !== prevProps.dataOrigin) {\n      this.props.dataOrigin === dataOriginTypes.API\n        ? this.getRemoteTubeMapData()\n        : this.getExampleData();\n    } else if (this.props.fetchParams !== prevProps.fetchParams) {\n      this.getRemoteTubeMapData();\n    }\n  }\n\n  render() {\n    const { isLoading, error } = this.state;\n\n    if (error) {\n      console.log(error);\n      const message = error.message ? error.message : error;\n      return (\n        <Container>\n          <Row>\n            <Alert color=\"danger\">{message}</Alert>\n          </Row>\n        </Container>\n      );\n    }\n\n    if (isLoading) {\n      return (\n        <Container>\n          <Row>\n            <div id=\"loaderContainer\">\n              <div id=\"loader\" />\n            </div>\n          </Row>\n        </Container>\n      );\n    }\n\n    return (\n      <div id=\"tubeMapSVG\">\n        <TubeMap\n          nodes={this.state.nodes}\n          tracks={this.state.tracks}\n          reads={this.state.reads}\n        />\n      </div>\n    );\n  }\n\n  getRemoteTubeMapData = async () => {\n    this.setState({ isLoading: true, error: null });\n    try {\n      const response = await fetch(`${BACKEND_URL}/getChunkedData`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(this.props.fetchParams)\n      });\n      const json = await response.json();\n      if (json.graph === undefined) {\n        // We did not get back a graph, only (possibly) an error.\n        this.setState({ error: json.error, isLoading: false });\n      } else {\n        const nodes = tubeMap.vgExtractNodes(json.graph);\n        const tracks = tubeMap.vgExtractTracks(json.graph);\n        const reads = tubeMap.vgExtractReads(nodes, tracks, json.gam);\n        this.setState({\n          isLoading: false,\n          nodes,\n          tracks,\n          reads\n        });\n      }\n    } catch (error) {\n      this.setState({ error: error, isLoading: false });\n    }\n  };\n\n  getExampleData = async () => {\n    this.setState({ isLoading: true, error: null });\n    let nodes, tracks, reads;\n    const data = await import('../util/demo-data');\n    nodes = data.inputNodes;\n    switch (this.props.dataOrigin) {\n      case dataOriginTypes.EXAMPLE_1:\n        tracks = data.inputTracks1;\n        break;\n      case dataOriginTypes.EXAMPLE_2:\n        tracks = data.inputTracks2;\n        break;\n      case dataOriginTypes.EXAMPLE_3:\n        tracks = data.inputTracks3;\n        break;\n      case dataOriginTypes.EXAMPLE_4:\n        tracks = data.inputTracks4;\n        break;\n      case dataOriginTypes.EXAMPLE_5:\n        tracks = data.inputTracks5;\n        break;\n      case dataOriginTypes.EXAMPLE_6:\n        const vg = JSON.parse(data.k3138);\n        nodes = tubeMap.vgExtractNodes(vg);\n        tracks = tubeMap.vgExtractTracks(vg);\n        reads = tubeMap.vgExtractReads(\n          nodes,\n          tracks,\n          this.readsFromStringToArray(data.demoReads)\n        );\n        break;\n      default:\n        console.log('invalid data origin type');\n    }\n\n    this.setState({ isLoading: false, nodes, tracks, reads });\n  };\n\n  readsFromStringToArray = readsString => {\n    const lines = readsString.split('\\n');\n    const result = [];\n    lines.forEach(line => {\n      if (line.length > 0) {\n        result.push(JSON.parse(line));\n      }\n    });\n    return result;\n  };\n}\n\nexport default TubeMapContainer;\n","import React, { Component } from 'react';\nimport { Col, Label, Input, FormGroup } from 'reactstrap';\n\nconst colorMap = new Map([\n  ['colorful', 'plainColors'],\n  ['greyscale', 'greys'],\n  ['reds', 'reds'],\n  ['blues', 'blues'],\n  ['pale colors', 'lightColors']\n]);\n\nclass RadioRow extends Component {\n  onChange = event => {\n    this.props.setColorSetting(\n      this.props.trackType,\n      colorMap.get(event.target.value)\n    );\n  };\n\n  render() {\n    const colorRadios = Array.from(colorMap).map(([keyColor, valueColor]) => {\n      return (\n        <Col xs=\"auto\" key={keyColor}>\n          <FormGroup check>\n            <Label check>\n              <Input\n                type=\"radio\"\n                value={keyColor}\n                checked={this.props.color === valueColor}\n                onChange={this.onChange}\n              />\n              {keyColor}\n            </Label>\n          </FormGroup>\n        </Col>\n      );\n    });\n    return (\n      <FormGroup row className=\"mb-1\">\n        <Col sm=\"2\">{this.props.rowHeading}:</Col>\n        {colorRadios}\n      </FormGroup>\n    );\n  }\n}\n\nexport default RadioRow;\n","import React, { Component } from 'react';\nimport {\n  Container,\n  Collapse,\n  CardBody,\n  Card,\n  CardHeader,\n  Form,\n  Label,\n  Input,\n  FormGroup\n} from 'reactstrap';\nimport RadioRow from './RadioRow';\n\nclass VisualizationOptions extends Component {\n  state = {\n    isOpenLegend: false,\n    isOpenVisualizationOptions: true\n  };\n\n  toggleLegend = e => {\n    this.setState({ isOpenLegend: !this.state.isOpenLegend });\n    e.preventDefault();\n  };\n\n  toggleVisOptions = e => {\n    this.setState({\n      isOpenVisualizationOptions: !this.state.isOpenVisualizationOptions\n    });\n    e.preventDefault();\n  };\n\n  render() {\n    const { visOptions, toggleFlag } = this.props;\n    return (\n      <Container>\n        <div id=\"accordion\">\n          <Card>\n            <CardHeader id=\"legendCard\">\n              <h5 className=\"mb-0\">\n                <a href=\"#collapse\" onClick={this.toggleLegend}>\n                  Legend\n                </a>\n              </h5>\n            </CardHeader>\n            <Collapse isOpen={this.state.isOpenLegend}>\n              <CardBody>\n                <div id=\"legendDiv\" />\n              </CardBody>\n            </Collapse>\n          </Card>\n\n          <Card>\n            <CardHeader id=\"visOptionsCard\">\n              <h5 className=\"mb-0\">\n                <a href=\"#collapse\" onClick={this.toggleVisOptions}>\n                  Visualization Options\n                </a>\n              </h5>\n            </CardHeader>\n            <Collapse isOpen={this.state.isOpenVisualizationOptions}>\n              <CardBody>\n                <FormGroup>\n                  <h5>General</h5>\n                  <FormGroup check>\n                    <Label check>\n                      <Input\n                        type=\"checkbox\"\n                        checked={visOptions.removeRedundantNodes}\n                        onChange={() => toggleFlag('removeRedundantNodes')}\n                      />\n                      Remove redundant nodes\n                    </Label>\n                  </FormGroup>\n                  <FormGroup check>\n                    <Label check>\n                      <Input\n                        type=\"checkbox\"\n                        checked={visOptions.compressedView}\n                        onChange={() => toggleFlag('compressedView')}\n                      />\n                      Compressed view\n                    </Label>\n                  </FormGroup>\n                </FormGroup>\n\n                <FormGroup>\n                  <h5>Sequence Reads</h5>\n                  <FormGroup check>\n                    <Label check>\n                      <Input\n                        type=\"checkbox\"\n                        checked={visOptions.showReads}\n                        onChange={() => toggleFlag('showReads')}\n                      />\n                      Show sequence reads\n                    </Label>\n                  </FormGroup>\n                  <FormGroup check>\n                    <Label check>\n                      <Input\n                        type=\"checkbox\"\n                        checked={visOptions.showSoftClips}\n                        onChange={() => toggleFlag('showSoftClips')}\n                      />\n                      Show soft clips\n                    </Label>\n                  </FormGroup>\n                </FormGroup>\n\n                <h5>Colors</h5>\n                <Form>\n                  <RadioRow\n                    rowHeading=\"Haplotypes\"\n                    color={visOptions.haplotypeColors}\n                    trackType=\"haplotypeColors\"\n                    setColorSetting={this.props.setColorSetting}\n                  />\n                  <RadioRow\n                    rowHeading=\"Reads (forward strand)\"\n                    color={visOptions.forwardReadColors}\n                    trackType=\"forwardReadColors\"\n                    setColorSetting={this.props.setColorSetting}\n                  />\n                  <RadioRow\n                    rowHeading=\"Reads (reverse strand)\"\n                    color={visOptions.reverseReadColors}\n                    trackType=\"reverseReadColors\"\n                    setColorSetting={this.props.setColorSetting}\n                  />\n                </Form>\n              </CardBody>\n            </Collapse>\n          </Card>\n        </div>\n      </Container>\n    );\n  }\n}\n\nexport default VisualizationOptions;\n","import React, { Component } from 'react';\nimport './App.css';\nimport HeaderForm from './components/HeaderForm';\nimport TubeMapContainer from './components/TubeMapContainer';\nimport CustomizationAccordion from './components/CustomizationAccordion';\nimport { dataOriginTypes } from './enums';\nimport * as tubeMap from './util/tubemap';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      fetchParams: {\n        nodeID: '1',\n        distance: '100',\n        byNode: 'false',\n        xgFile: 'snp1kg-BRCA1.vg.xg',\n        gbwtFile: '',\n        gamFile: 'NA12878-BRCA1.sorted.gam',\n        anchorTrackName: '17',\n        dataPath: 'default'\n      },\n      dataOrigin: dataOriginTypes.API,\n      visOptions: {\n        removeRedundantNodes: true,\n        compressedView: false,\n        showReads: true,\n        showSoftClips: true,\n        haplotypeColors: 'greys',\n        forwardReadColors: 'reds',\n        reverseReadColors: 'blues'\n      }\n    };\n  }\n\n  componentDidUpdate() {\n    const { visOptions } = this.state;\n    visOptions.compressedView\n      ? tubeMap.setNodeWidthOption(1)\n      : tubeMap.setNodeWidthOption(0);\n    tubeMap.setMergeNodesFlag(visOptions.removeRedundantNodes);\n    tubeMap.setShowReadsFlag(visOptions.showReads);\n    tubeMap.setSoftClipsFlag(visOptions.showSoftClips);\n    tubeMap.setColorSet('haplotypeColors', visOptions.haplotypeColors);\n    tubeMap.setColorSet('forwardReadColors', visOptions.forwardReadColors);\n    tubeMap.setColorSet('reverseReadColors', visOptions.reverseReadColors);\n  }\n\n  setFetchParams = fetchParams => {\n    this.setState({\n      fetchParams: fetchParams,\n      dataOrigin: dataOriginTypes.API\n    });\n  };\n\n  toggleVisOptionFlag = flagName => {\n    this.setState(state => ({\n      visOptions: {\n        ...state.visOptions,\n        [flagName]: !state.visOptions[flagName]\n      }\n    }));\n  };\n\n  setColorSetting = (key, value) => {\n    this.setState(state => ({\n      visOptions: {\n        ...state.visOptions,\n        [key]: value\n      }\n    }));\n  };\n\n  setDataOrigin = dataOrigin => {\n    this.setState({ dataOrigin });\n  };\n\n  render() {\n    return (\n      <div>\n        <HeaderForm\n          setFetchParams={this.setFetchParams}\n          setDataOrigin={this.setDataOrigin}\n          setColorSetting={this.setColorSetting}\n          dataOrigin={this.state.dataOrigin}\n        />\n        <TubeMapContainer\n          fetchParams={this.state.fetchParams}\n          dataOrigin={this.state.dataOrigin}\n        />\n        <CustomizationAccordion\n          visOptions={this.state.visOptions}\n          toggleFlag={this.toggleVisOptionFlag}\n          setColorSetting={this.setColorSetting}\n        />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}